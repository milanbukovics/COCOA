[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "COCOA: Collaborative Compendium on Analog Integrated Circuits",
    "section": "",
    "text": "Preface\nThis open-source book is meant to be a collaborative effort, bringing together insights from students, professionals, and the broader community of analog integrated circuit designers. It will leverage the new possibilities associated with open-source process design kits (PDKs) and open-source chip design software to build up a knowledge base with reproducible examples in a “live and dynamic” online format.\nAs of its initial creation in August 2024, it is merely a skeleton with the following structure.\n\nPart I: Learn to crawl — Square-law transistors, biasing and small-signal analysis\nPart II: Learn to walk — Real transistors, noise, mismatch, and distortion\nPart III: Dare to run — Knowledge base for state-of-the-art circuits\n\nPart I is dedicated to learning about powerful abstractions that are necessary to analyze and design analog integrated circuits. This initial exposure is driven with the simplest possible transistor models so that we can focus on fully understanding these abstractions and don’t get distracted by second-order effects that will only become meaningful later on. An added and important side benefit is that we can perfectly match hand calculations and simulations, which not only validates our methods, but also abandons the widespread misconception that circuit simulators rely on some form of “magic” to produce their outputs.\nPart II turns expands our horizon to analog circuits with modern transistors, which usually do not obey square-law equations. The good news is that all major abstractions, analysis and design approaches still apply. We just need to abandon the idea of predicting the transistor characteristics with simple equations, and instead rely on lookup tables or advanced model expressions (e.g., EKV-based). Additionally, this is a good time in the overall learning process for dealing with the major pain points of analog design: noise, mismatch and distortion. We review these impairments for the most important circuit primitives, forming a scalable basis for understanding larger circuits.\nPart III is meant to capture “deep dives” on commonly used circuits. It will be a forum where you can learn, for example, about the “best” way of going about the design of a bandgap reference, an LC voltage-controlled oscillator, or a successive approximation ADC. This part will undoubtedly be in constant flux and ideally thrive on pointers to reproducible open-source design repositories, simulation data, layouts, etc.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "contents/acknowledgements.html",
    "href": "contents/acknowledgements.html",
    "title": "Acknowledgements",
    "section": "",
    "text": "This project was inspired by Vijay Janapa Reddi’s CS249R Book and borrows from its implementation. Special thanks to James T. Meech for getting this work off the ground (by porting Chapter 1 of Part I to Quarto).",
    "crumbs": [
      "Acknowledgements"
    ]
  },
  {
    "objectID": "contents/contributors.html",
    "href": "contents/contributors.html",
    "title": "Contributors",
    "section": "",
    "text": "We extend our sincere thanks to the diverse group of individuals who have generously contributed their expertise, insights, and time to improve both the content and codebase of this project.\n\n\n\n\n\n\n\n\nBoris Murmann\n\n\nJames T. Meech\n\n\nClaudio Talarico",
    "crumbs": [
      "Contributors"
    ]
  },
  {
    "objectID": "contents/copyright.html",
    "href": "contents/copyright.html",
    "title": "Copyright",
    "section": "",
    "text": "Unless otherwise stated, this work is licensed under Creative Commons Attribution 4.0 International (CC BY 4.0). You can find the full text of the license here\nContributors to this project have dedicated their contributions to the public domain or under the same open license as the original project. While the contributions are collaborative, each contributor retains the copyright for their respective contributions. All trademarks and registered trademarks mentioned in this book are the property of their respective owners.\nThe information provided in this book is believed to be accurate and reliable. However, the authors, editors, and publishers cannot be held liable for any damages caused or alleged to be caused either directly or indirectly by the information contained in this book.",
    "crumbs": [
      "Copyright"
    ]
  },
  {
    "objectID": "contents/conventions.html",
    "href": "contents/conventions.html",
    "title": "Conventions",
    "section": "",
    "text": "Please follow these conventions as you contribute to this online book:\n\nClear Structure and Organization:\n\nChapter Outlines: Begin each chapter with an outline that provides an overview of the topics covered.\nSequential Numbering: Utilize sequential numbering for chapters, sections, and subsections to facilitate easy reference.\n\nAccessible Language:\n\nGlossary: Include a glossary that defines technical terms and jargon.\nConsistent Terminology: Maintain consistent use of terminology throughout the book to avoid confusion.\n\nLearning Aids:\n\nDiagrams and Figures: Employ diagrams, figures, and tables to visually convey complex concepts.\nSidebars: Use sidebars for additional information, anecdotes, or to provide real-world context to the theoretical content.\n\nInteractive Elements:\n\nColabs and Projects: Integrate exercises and projects at the end of each chapter to encourage active learning and practical application of concepts.\nCase Studies: Incorporate case studies to provide a deeper understanding of how principles are applied in real-world situations.\n\nReferences and Further Reading:\n\nBibliography: Include a bibliography at the end of each chapter for readers who wish to delve deeper into specific topics.\nCitations: Maintain a consistent style for citations, adhering to recognized academic standards like APA, MLA, or Chicago.\n\nSupporting Materials:\n\nSupplementary Online Resources: Provide links to supplementary online resources, such as video lectures, webinars, or interactive modules.\nDatasets and Code Repositories: Share datasets and code repositories for hands-on practice, particularly for sections dealing with algorithms and applications.\n\nFeedback and Community Engagement:\n\nForums and Discussion Groups: Establish forums or discussion groups where readers can interact, ask questions, and share knowledge.\nOpen Review Process: Implement an open review process, inviting feedback from the community to continuously improve the content.\n\nInclusivity and Accessibility:\n\nInclusive Language: Utilize inclusive language that respects diversity and promotes equality.\nAccessible Formats: Ensure the textbook is available in accessible formats, including audio and Braille, to cater to readers with disabilities.\n\nIndex:\n\nComprehensive Index: Include a comprehensive index at the end of the book to help readers quickly locate specific information.\n\n\nImplementing these conventions can contribute to creating a textbook that is comprehensive, accessible, and conducive to effective learning.",
    "crumbs": [
      "Conventions"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#mixed-signal-integrated-circuits",
    "href": "contents/partI/partI.1.html#mixed-signal-integrated-circuits",
    "title": "1  Introduction",
    "section": "1.1 Mixed-Signal Integrated Circuits",
    "text": "1.1 Mixed-Signal Integrated Circuits\nFigure 1.1 shows a generic diagram of a mixed-signal system, incorporating a mixed-signal integrated circuit. To the left of this diagram are the transducers and media that represent the sources and sinks of the information processed by the system. Examples of input transducers include microphones or photodiodes used to receive communication signals from an optical fiber. Likewise, the output of the system may drive an antenna for radio-frequency communication or a mechanical actuator that controls the zoom of a digital camera. At the boundary between the media and transducers are typically signal conditioning circuits that translate the incoming and outgoing signals to the proper signal strength and physical format. For instance, an amplifier is usually needed to increase the strength of the receive signal from a radio antenna, so that it can be more easily processed by the subsequent system components. In most systems, the signal conditioning circuitry interfaces to analog-to-digital and digital-to-analog converters, which provide the link between analog quantities and their digital representation in the computing back-end of the system.\n\n1.1.1 Example: Single-Chip Radio\nThe block diagram of a modern mixed-signal integrated circuit is shown in Figure 1.2. This design incorporates most of the circuitry needed to realize a modern cellular phone. For instance, it contains a front-end low-noise amplifier (LNA) to condition the incoming antenna signal. The amplified signal is subsequently frequency shifted, converted into digital format and fed into a digital processor. Even though the block diagram in Figure 1.2 looks quite complex, all of its elements can be mapped into one of the blocks of the generic diagram of Figure 1.1.\n\n\n\n\n\n\nFigure 1.2: Block diagram of a single-chip radio (Staszewski et al. 2008).\n\n\n\nFigure 1.3 shows the chip photo of the single-chip radio, with some of the system’s key building blocks annotated. As evident from this diagram, the digital logic dominates the area of this particular IC. This situation is not uncommon in modern mixed-signal ICs, not least because the utilized digital algorithms have reached an enormous complexity, requiring millions or tens of millions of logic gates.\n\n\n\n\n\n\nFigure 1.3: Chip photo of a single-chip radio (Staszewski et al. 2008).\n\n\nStaszewski, Robert Bogdan, Dirk Leipold, O Eliezer, Mitch Entezari, Khurram Muhammad, Imran Bashir, C-M Hung, et al. 2008. “A 24mm 2 Quad-Band Single-Chip GSM Radio with Transmitter Calibration in 90nm Digital CMOS.” In 2008 IEEE International Solid-State Circuits Conference-Digest of Technical Papers, 208–607. IEEE.\n\n\nDespite the dominance of digital logic within most systems, the analog interface components are equally important, as they determine how and how much information can be communicated between the physical world and the digital processing backbone. In many cases, the performance of the signal conditioning and data conversion circuitry ultimately determines the performance of the overall system.\n\n\n1.1.2 Example: Photodiode Interface Circuit\nFigure 1.4 shows an example of a signal conditioning circuit that plays a critical role in fiber-optic communication systems. In such a system, a photodiode is used to convert light intensity to electrical current (\\(i_{IN}\\)). In order to condition the signal for further processing, the diode current is converted into a voltage (\\(v_{OUT}\\)) by a so-called transimpedance amplifier. This amplifier must be fast enough to process the incoming light pulses, which often occur at frequencies of multiple gigahertz. In addition, the amplifier must obey certain limits on power dissipation, or the system may become impractical in terms of heat management or power supply requirements.\n\n\n\n\n\n\nFigure 1.4: Photodetector circuit for fiber-optic communication.\n\n\n\nLimitations in speed and power dissipation are, in general, among the main concerns in the interface circuitry of mixed-signal systems. Since new products tend to demand higher performance, the analog designer is constantly concerned with the design and optimization of system-critical building blocks, aiming for the best possible performance that can be achieved within the framework of the target application and process technology.\nA specific example for the circuit realization of a transimpedance amplifier is shown in Figure 1.5. It consists of three transistor stages, each of which serves a specific purpose and design intent. This is true for most amplifier circuits; even though the full schematic of a particular realization may be com- plex, it can usually be broken up into smaller sub-blocks that are more easily understood. Specifi- cally, for the amplifier of Figure 1.5, the experienced designer will recognize that the circuit consists of a cascade connection of a common-gate, common-source, and common-drain stage. These sub-blocks form the basis for a large number of analog circuits, and can be viewed as the “atoms” or fundamental building blocks of analog design. In this module, you will learn to analyze these blocks from first principles, and to reuse the gained knowledge for the design of more complex circuits. The circuit of Figure 1.5 will be analyzed in detail in Chapter 6 of this module, building upon the principles covered in Chapters 2–5.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#managing-complexity",
    "href": "contents/partI/partI.1.html#managing-complexity",
    "title": "1  Introduction",
    "section": "1.2 Managing Complexity",
    "text": "1.2 Managing Complexity\nAs evident from the example of Section 1-1-1, modern integrated circuits are highly complex and require a hierarchical approach in design and analysis. That is, a modern integrated circuit is far too complex to be fully understood and analyzed in a single sheet schematic at the transistor level. Typically, a mixed-signal IC is represented by a block diagram as the one shown in Figure 1.2. At the level of this description, suitable specifications are derived for each block, which may itself contain several sub-blocks. The blocks and sub-blocks are then designed and optimized until they meet the desired target specifications.\n\n\n\n\n\n\nFigure 1.5: Example realization of a transimpedance amplifier.\n\n\n\nFigure 1.6 illustrates examples of the various levels of abstraction that come into play in the design of a modern integrated circuit. At the highest level, the constituent elements can be partitioned into analog and digital blocks. An example of a high-level analog block is an analog-to-digital converter, whereas a microprocessor is an example of a large digital block. These blocks themselves contain smaller functional units, as, for example, operational amplifiers in the case of an analog-to-digital converter. The operational amplifiers themselves contain the aforementioned elementary transistor stages, which are the main subject of this module.\n\n\n\n\n\n\nFigure 1.6: Levels of abstraction in integrated circuit design.\n\n\n\nInterestingly, even at the level of elementary transistor stages, is often not possible to work with a perfect model or description of the circuit. This is particularly so because the physical effects in the constituent transistors are highly complex and often impossible to capture perfectly with a tractable set of equations for hand analysis. Therefore, making proper engineering approximations in transistor modeling is an important aspect in maintaining a systematic design methodology. For this particular reason, the presentation in this module follows a “just-in-time” approach for the modeling of transistor behavior. Rather than deriving a complete transistor model in an isolated chapter (as done in most texts), we begin with only the basic device properties and increase complexity throughout the module upon demand, and where needed to gain further insight and accuracy. With this approach, the reader learns to appreciate the complexity of a refined model, and will be able to assess and track potential limitations of working with simplified models.\n\n\n\n\n\n\nFigure 1.7: Two-port model of the transimpedance amplifier circuit in Figure 1.5.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#two-port-abstraction-for-amplifiers",
    "href": "contents/partI/partI.1.html#two-port-abstraction-for-amplifiers",
    "title": "1  Introduction",
    "section": "1.3 Two-Port Abstraction for Amplifiers",
    "text": "1.3 Two-Port Abstraction for Amplifiers\nHigh-level system block diagrams, such as Figure 1.2 , are typically drawn as unidirectional flowcharts and do not capture details about the electrical behavior of each connection port and how certain blocks may interact once they are connected. Unfortunately, electrical signals are not unidirectional, and connecting two blocks always means that there is some level of interaction through the voltages and currents at the connection points.\n\n\n\n\n\n\nFigure 1.8: General amplifier two-port.\n\n\n\nThe commonly used linear two-port modeling abstraction for amplifiers and amplifier stages allows the designer to take these effects into account while maintaining a high level of abstraction. For instance, the circuit of Figure 1.5 can be approximately modeled as shown in Figure 1.7 (the details on obtaining this model are discussed later in this module). Each stage of the overall amplifier is represented via a simplified circuit model that captures its essential features. Once this model is created, the interaction among stages can be analyzed at this high level of abstraction, without requiring detailed insight on how each stage is implemented. The two-port modeling approach is particularly useful in the design of amplifiers, as it can help shape the thought process on how the various stages should be configured to optimize performance. In the following subsections, we will review some of the basic concepts of amplifier two-port modeling used in this module.\n\n1.3.1 Amplifier Types\nIn this module, we model amplifier circuits as blocks that have an input and output port, where the term “port” refers to a pair of terminals. For each port, we can define input and output currents and voltages as shown in Figure 1.8. Depending on the intended function, we distinguish between the four possible amplifier types listed in Table 1-1. For example, an amplifier that takes an input current and amplifies this current to produce a proportional output voltage is called a transresistance amplifier. In this context, it is important to emphasize that in a general practical amplifier circuit, the input and output ports will always carry both nonzero voltages and currents, and there exist transfer functions between all possible combinations of input/output variables. What truly defines the type of an amplifier is what the circuit designer deems as the main quantities of interest in the amplifier’s application.\n\nAmplifier types.\n\n\n\n\n\n\n\nAmplfier Type\nInput Quantity\nOutput Quantity\n\n\n\n\nVoltage Amplifier\nVoltage\nVoltage\n\n\nCurrent Amplifier\nCurrent\nCurrent\n\n\nTransconductance Amplifier\nVoltage\nCurrent\n\n\nTransresistance Amplifier\nCurrent\nVoltage\n\n\n\nNow, in order to model the inner workings of each amplifier type, we can invoke the four corresponding two-port amplifier models shown in Figure 1.9. Each amplifier model has an input and output resistance (or more generally, a frequency dependent impedance) and a controlled source to model the amplification.\n\nIn the voltage amplifier model, the controlled source is a voltage-controlled voltage source. Ideally, the input resistance is infinite (open circuit, no current flow). The ideal output resistance is zero (ideal voltage source).\nThe current amplifier model has a current-controlled current source. Ideally, the input resistance is zero (short circuit, no voltage across the input port) and the output resistance is infinite (ideal current source).\nThe transconductance amplifier model has a voltage-controlled current source. Ideally, the input resistance is infinite (open circuit, no current flow). The ideal output resistance is also infinite (ideal current source).\nThe transresistance or transimpedance1 amplifier model has a current-controlled voltage source. Ideally, the input resistance is zero (short circuit, no voltage across the input port). The ideal output resistance is also zero (ideal voltage source).\n\n1 The term transimpedance is sometimes used to refer to an amplifier that is primarily meant to realize a transresistance. Referring to “impedance” highlights the fact that the transfer function will usually be frequency-dependent.From these four models and their ideal behavior, we note that the two-ports containing a voltage-controlled source should ideally have large input resistance (\\(R_{in}\\)). This minimizes the signal loss due to resistive voltage division between the source voltage (\\(v_s\\)) and the control voltage (\\(v_{in}\\)). In contrast, the two-ports that use a current-controlled source should have small input resistance to minimize the signal loss due to current division between the source current (\\(i_s\\)) and the control current (\\(i_{in}\\)). In this context, “large” and “small” refer to the value of \\(R_{in}\\) relative to the source resistance (\\(R_s\\)).\n\n\n\n\n\n\n\n\nFigure 1.9: Two-port amplifier models with input source and load: (a) voltage amplifier, (b) current amplifier, (c) transconductance amplifier, and (d) transresistance amplifier\n\n\n\n\n\nOn the output side, if the variable of interest is a voltage, the output resistance (\\(R_{out}\\)) should be small so that only a small amount of the amplified voltage is lost through the division with the load (\\(R_L\\)). Conversely, for a current output, the output resistance should be large to minimize current division losses. Again, “large” and “small” are taken as relative measures comparing Rout to \\(R_L\\).\nConsider for example the voltage amplifier of Figure 1.9(a). To calculate the transfer function of the overall circuit (\\(v_{out}\\)/\\(v_s\\)), the input voltage, including its source resistance, is connected to the input of the two-port model and the load resistance is connected to the output. The full circuit is shown in Figure 1.10.\n\n\n\n\n\n\nFigure 1.10: Voltage amplifier with connected source and load resistances.\n\n\n\nApplying the voltage divider rule at the input and output of the circuit gives\n\\[\n\\frac{v_{out}}{v_s} = \\Bigl(\\frac{v_{in}}{v_s}\\Bigr) \\cdot A_v \\cdot \\Bigl(\\frac{v_{out}}{v_x}\\Bigr) = \\Bigl(\\frac{R_{in}}{R_{in} + R_s}\\Bigr) \\cdot A_v \\cdot \\Bigl(\\frac{R_{L}}{R_{L} + R_{out}}\\Bigr)\n\\tag{1.1}\\]\nAs we can see from this expression, the overall voltage gain is maximized when the amplifier has a large input resistance (relative to \\(R_s\\)) and a small output resistance (relative to \\(R_L\\)). For the ideal case of infinite input resistance and zero output resistance, \\(v_{out}\\)/\\(v_s\\) becomes equal to \\(A_v\\).\nFor the sake of compact notation, we will often want to use a symbol for the overall circuit gain. The notation used in this module uses primed variables to distinguish between the gain of the controlled source and the gain of the overall amplifier circuit. For example, for the above-discussed voltage amplifier we define \\(A'_v\\) = \\(v_{out}\\) ⁄ \\(v_s\\). This notation is meant to emphasize the connection between the two symbols. \\(A'_v\\) is usually smaller than \\(A_v\\), but can approach \\(A_v\\) for ideal source and load configurations.\nExample 1-1: Transfer Function Transconductance Amplifier.\nFor the transconductance amplifier circuit in Figure 1.11, calculate the overall transconductance \\(G'_m = i_{out} ⁄ v_s\\).\n\n\n\n\n\n\nFigure 1.11: Figure Ex 1-1\n\n\n\nSOLUTION\nApplying the voltage divider rule at the input and the current divider rule at the output yields the following result:\n\\[\nG'_m = \\frac{i_{out}}{v_s} = \\Bigl(\\frac{v_{in}}{v_s}\\Bigr) \\cdot G_m \\cdot \\Bigl(\\frac{i_{out}}{i_x}\\Bigr) =  \\Bigl(\\frac{R_{in}}{R_{in} + R_s}\\Bigr) \\cdot G_m \\cdot \\Bigl(\\frac{R_{out}}{R_{L} + R_{out}}\\Bigr)\n\\]\nThus, the overall transconductance gain is maximized when the amplifier has a large input resistance (relative to \\(R_s\\)) and a large output resistance (relative to \\(R_L\\)). For the ideal case of infinite input and output resistances, \\(G'_m\\) becomes equal to \\(G_m\\).\nAs a final remark for this sub-section, it is important to recognize that all of the models in Figure 1.9 can be used interchangeability to describe the exact same electrical behavior (see Problem P1-1). For instance, a voltage amplifier model can be converted into a transconductance amplifier model by applying a Thevénin to Norton transformation for the controlled source.\nA corollary to this equivalence is that we can for example use a transconductance amplifier model to describe a voltage amplifier circuit. This is illustrated through the circuit of Figure 1.12, which is electrically equivalent to that of Figure 1.10 (see Problem P1-2). Note that the output is taken as the voltage across the output port instead of the output current; this indicates that the circuit is viewed as a voltage amplifier. Just as in the original circuit of Figure 1.10, we require a large input resistance and small output resistance for this circuit to maximize the overall voltage gain.\nThe choice of amplifier model depends on several factors. At first glance, it seems natural to model each amplifier type using its “native” model that directly corresponds to the intended function. For example, we could always describe a voltage amplifier using the corresponding voltage amplifier model that contains a voltage controlled voltage source. However, as we shall see throughout this module, it is sometimes more convenient to align the amplifier model with the physical amplification mechanism or a structural feature of the underlying transistor circuit. For instance, the common-source voltage amplifier discussed in Chapter 2 naturally invokes a transconductance-based model due to the physical model of the employed transistor.\n\n\n1.3.2 Unilateral versus Bilateral Two-Ports\nAll of the two-port models shown in Figure 1.9 are called unilateral, because they can only propagate a signal from the input port to the output port and not the other way around. For instance, injecting a current into the output port of the current amplifier of Figure 1.9(b) will not induce a current at the input port. Unfortunately, many practical transistor circuits are not unilateral, and exhibit bilateral behavior when analyzed in detail, and especially at high frequencies.\n\n\n\n\n\n\nFigure 1.12: Voltage amplifier with an underlying transconductance amplifier model\n\n\n\n\n\n\n\n\n\nFigure 1.13: (a) Example of a bilateral current amplifier. (b) Corresponding bilateral current amplifier two-port model.\n\n\n\nAn example of a bilateral current amplifier is shown Figure 1.13(a). Note that in this circuit, resistor \\(R_2\\) couples the input and output networks and it can therefore transfer currents in both directions. Consequently, the unilateral model of Figure 1.9(b) cannot perfectly represent this circuit. When it is desired to capture the bilateral behavior, the two-port model in Figure 1.13(b) could be employed in principle. Here, the controlled source Air models the reverse current transfer from the output back to the input. Alternatively, one could employ other bilateral and more general two-port models based on admittance parameters (\\(Y\\)), impedance parameters (\\(Z\\)), and hybrid or inverse-hybrid parameters (\\(H\\) or \\(G\\)); see advanced circuit design texts such as (Gray et al. 2009). These models are particularly useful when reverse transmission (i.e., feedback from the output to the input) is incorporated in the circuit as part of the intended design.\n\nGray, Paul R, Paul J Hurst, Stephen H Lewis, and Robert G Meyer. 2009. Analysis and Design of Analog Integrated Circuits. John Wiley & Sons.\nThere are two reasons why we will work exclusively with unilateral two-port approximations in this module. First, the circuits considered are designed primarily to implement forward gain rather than reverse gain; feedback circuits are not treated in this module. For example, referring to the model of Figure 1.13(b), the reverse gain Air will be negligibly small in any current amplifier circuit that we will consider. Second, a clear drawback of working with bilateral two-port models would be a significant increase in analysis complexity. As we have seen in Example 1-1, the overall transfer function of a unilateral two-port circuit can be written by applying simple voltage and current divider rules. This also extends to cascade connections of multiple two-ports. For example, the overall transfer function of the circuit in Figure 1.7 is easily written by inspection, without requiring extensive algebra. With reverse transmission included, the transfer function analysis will generally require solving a linear system of equations. In light of the fact that we do not intend to design circuits in this module that have significant reverse transmission, this increase in complexity is not welcome, and would also hinder us from developing intuition from inspection-driven analysis.\n\n\n1.3.3 Construction of Unilateral Two-Port Models\nWe will now describe the general procedures to calculate the controlled sources, as well as the input and output resistances, for the unilateral two-port models of Figure 1.9. The approach is based on applying test voltages and currents to find the desired model parameters.\nThe most important parameter of any amplifier circuit is its gain. To identify the gain parameters for the models of Figure 1.9(a)-(d), we apply the tests shown in Figure 1.14(a)-(d), respectively.\n\nTo calculate the gain term \\(A_v\\) of a voltage amplifier model, we apply a test voltage at the input with zero source resistance and measure the open-circuit output voltage. \\(A_v = v_{oc} / v_t\\) is therefore also called the open-circuit voltage gain.\nTo calculate the gain term \\(A_i\\) of a current amplifier model, we apply a test current at the input with infinite source resistance and measure the short-circuit output current. \\(A_i = i_{sc} / i_t\\) is therefore also called the short-circuit current gain.\nTo calculate the gain term \\(G_m\\) of a transconductance amplifier model, we apply a test voltage at the input with zero source resistance and measure the short-circuit output current to find \\(G_m = i_{sc}/v_t\\).\nTo calculate the gain term \\(R_m\\) of a transresistance amplifier model, we apply a test current at the input with infinite source resistance and measure the open-circuit output voltage to find \\(R_m = v_{oc} / v_{it}\\).\n\n\n\n\n\n\n\nFigure 1.14: Method to calculate two-port amplifier model parameters: (a) voltage gain \\(A_v\\), (b) current gain \\(A_i\\), (c) transconductance \\(G_m\\), (d) transresistance \\(R_m\\), (e) input resistance \\(R_in\\), and (f) output resistance \\(R_out\\).\n\n\n\nThe rationale behind these tests can be understood by considering, for example, the case of the voltage amplifier model of Figure 1.9(a). When driven with an ideal voltage source, the effect of any resistance at the input port is eliminated, and the controlled source is directly stimulated by the applied test source (without any voltage division). Likewise, by measuring the resulting output voltage open-circuited, any resistance in series with the controlled source has no effect and the measurement therefore accurately extracts the parameter \\(A_v\\). Similar explanations apply to the test cases for the remaining amplifier models.\nThe test setup for extracting the input and output resistances for all amplifier models is shown in Figure 1.14(e), and (f), respectively.\n\nTo calculate the input resistance \\(R_{in}\\) we apply a test voltage and measure the current coming from the test source, or apply a test current and mea- sure the voltage across the test source. In this test, the load resistance (\\(R_L\\)) must be connected to the output port as shown in Figure 1.14(e).\nTo calculate the output resistance \\(R_out\\), we apply either a test voltage or a test current source at the output port and measure the respective current or voltage from the source. Here, the input source must be set equal to zero. This means that input voltage sources are shorted and input current sources are open-circuited. Only the source resistance (\\(R_S\\)) is left across the input terminals as shown in Figure 1.14(f).\n\nThe above procedures extract the input and output resistances perfectly and without any approximations, even if the circuit is bilateral. As we shall see through the examples below, \\(R_{in}\\) and \\(R_{out}\\) do not depend on \\(R_L\\) and \\(R_S\\), respectively, in a perfectly unilateral amplifier. However, this is not the case in a bilateral amplifier, and therefore the general procedure includes \\(R_L\\) and \\(R_S\\) in the test setup.\nIn summary, the above procedures for measuring unilateral two-port model parameters aim at finding the best possible unilateral representation of an arbitrary amplifier circuit, which itself may or may not be unilateral. The obtained models are approximate when the amplifier is bilateral, since they do not include a controlled source that captures reverse transmission from the output back to the input. In most cases considered in this module, the reverse transmission term is negligible. Exceptions will be highlighted and treated as appropriate.\nExample 1-2: Two-Port Model Calculations for a Unilateral Amplifier\nFor the transconductance amplifier in Figure 1.15, calculate the following two-port model parameters: the transconductance \\(G_m\\), the input resistance \\(R_{in}\\), and the output resistance \\(R_{out}\\). Also, compute the overall transfer function \\(G'_m = i_{out} ⁄ v_s\\).\n\n\n\n\n\n\nFigure 1.15: Figure Ex1-2A\n\n\n\nSOLUTION\nTo find the transconductance, we short the output port and apply an ideal test voltage source (\\(v_t\\)) at the input (see Figure 1.15). From this circuit, we see that\n\\[\nG_m = \\frac{i_{sc}}{v_t} = \\frac{g_m v_x \\cdot \\frac{R_3}{R_3 + R_4}}{v_t} = \\frac{g_m v_x \\cdot \\frac{R_2}{R_1 + R_2} \\cdot \\frac{R_3}{R_3 + R_4}}{v_t} = g_m \\cdot \\frac{R_2}{R_1 + R_2} \\cdot \\frac{R_3}{R_3 + R_4}\n\\]\nNext, to find \\(R_in\\), we apply a test voltage at the input and connect the load resistance \\(R_L\\) at the output (Figure 1.16). From this circuit, we find that the input resistance is simply the series connection of \\(R_1\\) and \\(R_2\\), i.e., \\(R_{in} = R_1 + R_2\\). Note that the output network does not influence this result.\n\n\n\n\n\n\nFigure 1.16: Figure Ex1-2B\n\n\n\nFinally, to find \\(R_{out}\\), we apply a test voltage at the output and connect the source resistance \\(R_S\\) across the input port (the source \\(v_s\\) is replaced by a short), (see Figure 1.16(c)). In the resulting circuit, \\(v_x\\) must be zero, because no current is flowing in the input network. Thus, the controlled source carries no current and we conclude that \\(R_{out} = R_3 + R_4\\).\nIn order to compute the transfer function of the complete circuit, we can reuse the result obtained in Example 1-1.\n\\[\nG'_m = \\frac{i_{out}}{v_s} = \\Bigl(\\frac{R_{in}}{R_{in} + R_s}\\Bigr) \\cdot G_m \\cdot \\Bigl(\\frac{R_{L}}{R_{L} + R_{out}}\\Bigr)\n\\]\nSubstituting \\(G_m\\), \\(R_{in}\\), and \\(R_{out}\\) from the above calculation yields the final result.\n\\[\nG'_m = \\frac{i_{out}}{v_s} = \\frac{g_m R_2 R_3}{(R_1 + R_2 + R_S)(R_L + R_3 + R_4)}\n\\]\nIn the preceding example, we have seen that the source and load resistances have no effect on the extracted two-port parameters. In the following example, we will investigate a bilateral circuit to show that in general, the input and output resistances depend on \\(R_S\\) and \\(R_L\\), which must therefore always be included in the general two-port modeling calculations.\nExample 1-3: Two-Port Model Calculations for a Bilateral Amplifier\nFor the current amplifier in Figure 1.13(a), calculate the following unilateral two-port model parameters: the current gain \\(A_i\\), the input resistance \\(R_{in}\\), and the output resistance \\(R_{out}\\). Also, compute the overall transfer function \\(i_{out} / v_s\\) using the obtained unilateral two-port model. Compare the result to a direct KCL-based analysis of the transfer function. Assume that the circuit is driven by a current source with resistance \\(R_S\\) and loaded by a resistance \\(R_L\\). For algebraic simplicity, assume \\(R_1 = 1 / g_m\\) (this case corresponds to the common-gate amplifier circuit covered in Chapter 4).\nSOLUTION\nTo find the current gain Ai, we short the output port and apply an ideal test current source (\\(i_t\\)) at the input (see Figure 1.17(a)). From this circuit, we see that\n\\[\nv_{in} = \\Bigl( g_m + \\frac{1}{R_2} \\Bigr)^{-1} \\cdot i_t\n\\]\nand\n\\[\ni_{sc} = - \\Bigl( g_m + \\frac{1}{R_2} \\Bigr) \\cdot v_{in}\n\\]\nThus, Ai = isc/it = –1.\nNext, to find \\(R_{in}\\), we apply a test voltage at the input and connect the load resistance \\(R_L\\) at the output (Figure 1.17(b)). From this circuit, we note that the input resistance is not easily identified by inspection. Hence we write KCL for the two nodes of the circuit (\\(v_t\\) and \\(v_out\\)).\n\\[\n0 = -i_t + g_m v_t + \\frac{v_t - v_out}{R_2}\n\\]\n\\[\n0 = - g_m v_t + \\frac{v_{out}}{R_L} + \\frac{v_t - v_out}{R_2}\n\\]\nSolving this system of equations yields\n\\[\nR_{in} = \\frac{v_t}{i_t} = \\frac{R_2 + R_L}{1 + g_m R_2} = \\frac{1 + \\frac{R_L}{R_2}}{g_m + \\frac{1}{R_2}}\n\\]\nNote from this result that \\(R_in\\) depends on \\(R_L\\), as mentioned previously; this dependency stems from the bilateral structure of the circuit. Also note that Rin approaches \\(1 / g_m\\) when \\(R_2\\) is large compared to \\(R_L\\) and $ 1 / g_m$. We will revisit this important point in Chapter 4, in the context of a common-gate amplifier circuit.\n\n\n\n\n\n\nFigure 1.17: Figure Ex1-3\n\n\n\nNow, to find \\(R_{out}\\), we apply a test voltage at the output and connect the source resistance \\(R_S\\) across the input port Figure 1.17. Again, we must write KCL at the two circuit nodes and solve the resulting system of equations. This yields\n\\[\nR_{out} = \\frac{v_t}{i_t} = R_2 R_S + g_m R_2 R_S\n\\]\nAgain, note that \\(R_out\\) is a function of \\(R_S\\); this is the case for any bilateral circuit.\nFinally, to compute the transfer function based on the obtained unilateral model, we consider the circuit shown in Figure 1.17(d). By inspection, we see that\n\\[\nA_i' \\frac{i_{out}}{i_s} = \\Bigl( \\frac{R_S}{R_{in} + R_S} \\Bigr) A_i \\frac{R_{out}}{R_L + R_{out}}\n\\]\nSubstituting \\(A_i\\), \\(R_{in}\\), and \\(R_{out}\\) from the above calculation into this expression yields\n\\[\nA_{i, Two-Port}' = \\frac{i_{out}}{i_s} = -\\frac{R_S(1 + g_m R_2)(R_2 + R_S + g_m R_2 R_S)}{(R_L + R_2 + R_S + g_m R_2 R_S)^2}\n\\]\nWe now wish to compare this result to the accurate transfer function of the circuit, obtained by direct calculation and without approximating the circuit as a unilateral two-port. For this purpose, we consider the full circuit shown in Figure 1.17(e) and write KCL for its two nodes.\n\\[\n0 = - i_s + g_m v_in + \\frac{v_{in}}{R_S} + \\frac{v_{in} - v_{out}}{R_2}\n\\]\n\\[\n0 = -g_m v_{in} + \\frac{v_{out}}{R_L} + \\frac{v_{out} - v_{in}}{R_2}\n\\]\nSolving this system of equations for \\(v_{out}\\) and substituting \\(i_{out} = - v_{out} / R_L\\) yields\n\\[\nA_{i, Exact}' = \\frac{i_{out}}{i_s} =\n-\\frac{R_S (1 + g_m R_2)}{R_L + R_2 + R_S + g_m R_2 R_S}\n\\]\nThe discrepancy factor between the two results is given by\n\\[\n\\frac{A_{i, Two-Port}'}{A_{i, Exact}'} = \\frac{R_2 + R_S + g_m R_2 R_S}{R_L + R_2 + R_S + g_m R_2 R_S} = \\frac{1 + R_S \\Bigl(\\frac{1}{R_2} + g_m \\Bigr)}{1 + \\frac{R_L}{R_2} + R_S \\Bigl(\\frac{1}{R_2} + g_m \\Bigr)}\n\\]\nFrom this result, we see that the discrepancy factor approaches unity (no error) when \\(R_2\\) is much larger than \\(R_L\\), a condition that is often satisfied in practice (the ideal load for a current amplifier is a short circuit). In this case, the unilateral two-port model will accurately describe the behavior of the circuit.\nThe outcome of the above example captures the main spirit in which we justify relying on unilateral two-port models in this module. Even though the considered amplifier is strictly speaking bilateral, a unilateral model describes its behavior to within the desired engineering accuracy, provided that reason- able boundary conditions hold.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#integrated-circuit-design-versus-printed-circuit-board-design",
    "href": "contents/partI/partI.1.html#integrated-circuit-design-versus-printed-circuit-board-design",
    "title": "1  Introduction",
    "section": "1.4 Integrated Circuit Design versus Printed Circuit Board Design",
    "text": "1.4 Integrated Circuit Design versus Printed Circuit Board Design\nIn the design of analog circuits, the underlying technology has a significant impact on the choice of architecture, because it tends to restrict the availability and specification range of the underlying active and passive components. For instance, a designer working with discrete components on a printed circuit board may be subjected to the following constraints:\n\nLimit the component count below 100 elements to achieve a small board area.\nResistors can be chosen in the range of 1Ω–10MΩ.\nCapacitors can be chosen in the range of 1pF–10,000 μF.\nThe resistor and capacitor values match to within 1–10%.\nThe available (discrete) bipolar junction transistors match to within 20% in their critical parameters.\n\nIn contrast, the designer of a CMOS system-on-chip may face the constraints summarized below:\n\nAvoid using resistors; use as many MOSFET transistors as needed (within reasonable limits, on the order of hundreds to several thousands) to realize the best possible circuit implementation.\nCapacitors can be chosen in the range of 10 fF–100 pF.\nThe critical parameters in the MOSFET transistors be made to match to within 1%, but vary by more than 30% for different fabrication runs.\nCapacitors of similar size can match to within 0.1%, but vary by more than 10% for different fabrication runs.\n\nAs a consequence of the vastly different constraints that apply to the design of analog circuits in CMOS technology, the resulting practical and preferred circuit architectures differ substantially from the ones that would be used in a printed circuit board design. For example, a discrete voltage amplifier may utilize large AC coupling capacitors to simplify and decouple the biasing of the individual gain stages (see example in Figure 1.18). In contrast, it is typically not possible to use AC coupling techniques (except for very high-frequency designs) in integrated circuits, primarily due to the restriction on maximum capacitor size.\n\n\n\n\n\n\nFigure 1.18: Example of a discrete amplifier circuit using bipolar junction transistors (BJTs).\n\n\n\nThe material covered in this module is primarily concerned with analog integrated circuit design. While this choice does not affect many of the key principles used in the analysis and the discussed circuits, it does affect the architectural choices made in arriving at a practical design. For instance, large AC coupling capacitors are not used throughout the discussion. Also, where appropriate, we will invoke certain assumptions about the typical matching of component parameters in CMOS to eliminate impractical design choices.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#prerequisites-and-advanced-material",
    "href": "contents/partI/partI.1.html#prerequisites-and-advanced-material",
    "title": "1  Introduction",
    "section": "1.5 Prerequisites and Advanced Material",
    "text": "1.5 Prerequisites and Advanced Material\nThe reader of this module is expected to be familiar with the basis concepts of linear circuit analysis (see Ulaby and Maharbiz 2013), including\n\nUlaby, Fawwaz Tayssir, and Michel M Maharbiz. 2013. Circuit Analysis and Design. 2nd Edition. NTS Press.\n\nPassive components (resistors, capacitors)\nKirchhoff’s voltage and current laws (KVL and KCL)\nIndependent and dependent voltage and current sources; Thevénin and Norton representation of controlled sources\nTwo-port representation of circuits; calculation of port resistances and frequency dependent impedances\nManipulation of complex variables and numbers\nPhasor analysis and Laplace domain representation of passive circuit elements\nBode plots\n\nThe derivations of device models in this module assume familiarity with basic solid-state physics and electrostatics as treated in introductory texts on solid-state device physics (see Pierret 1996). A few sections of this module are marked with an asterisk (*) to indicate advanced material that may in some cases go beyond the learning goals of an introductory course. These sections can be skipped at the instructor’s discretion without affecting the overall flow and context.\n\nPierret, R. F. 1996. Semiconductor Device Fundamentals. Pearson Education. https://books.google.com/books?id=P-VNFYbs3r0C.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#notation",
    "href": "contents/partI/partI.1.html#notation",
    "title": "1  Introduction",
    "section": "1.6 Notation",
    "text": "1.6 Notation\nThis module follows the notation for signal variables as standardized by the IEEE. Total signals are composed of the sum of DC quantities and small signals. For example, a total input voltage \\(v_{IN}\\) is the sum of a DC input voltage \\(V_{IN}\\) and a small-signal voltage \\(v_{in}\\). The notation is summarized below.\n\nTotal quantity has a lowercase variable name and uppercase subscript\nDC quantity has an uppercase variable name and uppercase subscript\nSmall-signal quantity has a lowercase variable name and lowercase subscript",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#summary",
    "href": "contents/partI/partI.1.html#summary",
    "title": "1  Introduction",
    "section": "1.7 Summary",
    "text": "1.7 Summary\nThis chapter offered a brief motivation for the topics covered in this module, which focuses on the analysis and design of elementary amplifier stages in CMOS technology. These elementary stages can be viewed as the “atoms” of analog circuit design and a thorough understanding of the blocks is a necessary prerequisite for the design of advanced analog circuits design, as for instance in the context of large systems-on-chip. At all levels of circuit design, complexity is managed using hierarchical abstraction and model simplification using proper engineering approximations. The unilateral two-port models reviewed in Section 1-3 and used throughout this module, are an example of such abstractions.\n\n\n\n\n\n\nFigure 1.19: Figure P1-1",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.1.html#problems",
    "href": "contents/partI/partI.1.html#problems",
    "title": "1  Introduction",
    "section": "1.8 Problems",
    "text": "1.8 Problems\nP1.1 Given the amplifier circuit in Figure 1.19 (a) Find the input and output resistance. (b) Construct an equivalent circuit using a voltage amplifier two-port model and determine all model parameters symbolically. (c) Repeat part (b) for a current amplifier model. (d) Repeat part (b) for a transconductance amplifier model. (e) Repeat part (b) for a transresistance amplifier model.\nP1.2 Convince yourself that the circuits of Figure 1.10 and Figure 1.12 are equivalent by showing sym- bolically that both circuits have the same overall voltage gain \\(A'_v = v_{out} ⁄ v_s\\).\nP1.3 You are given an input voltage source with a source resistance, \\(R_S\\). (a) Use the unilateral voltage amplifier two-port model found in P1.1 to find the overall voltage gain when the amplifier is driving a load resistor \\(R_L\\). (b) Specify whether the resistances \\(r_1\\), \\(r_i\\), \\(r_o\\), \\(r_2\\) in the small signal model should be increased, be decreased, or remain the same to improve the overall voltage gain.\nP1.4 You are given an input current source with a source resistance, \\(R_S\\). (a) Use the unilateral current amplifier two-port model found in P1.1 to find the overall current gain when the amplifier is driving a load resistor \\(R_L\\). (b) Specify whether the resistances \\(r_1\\), \\(r_i\\), \\(r_o\\), \\(r_2\\) in the small-signal model should be increased, be decreased, or remain the same to improve the overall current gain.\nP1.5 Given the circuit model in Figure 1.20 for an amplifier circuit (with \\(r_i\\) and \\(r_o\\) removed and \\(r_1\\)=\\(r_2\\)=0)\n\nFind the input and output resistance. Note that since this circuit is bilateral, \\(R_S\\) must be considered when computing \\(R_{out}\\), and \\(R_L\\) must be considered when computing \\(R_{in}\\).\nConstruct a two-port model for a unilateral voltage amplifier.\nConstruct a two-port model for a unilateral current amplifier.\nConstruct a two-port model for a unilateral transconductance amplifier.\nConstruct a two-port model for a unilateral transresistance amplifier.\n\n\n\n\n\n\n\nFigure 1.20: Figure P1-5\n\n\n\nP1.6 Consider the two-port model of a voltage amplifier as shown in Figure 1.9(a) with the following parameters: \\(A_v\\) = 10, \\(R_{in}\\) = 5 kΩ, and \\(R_{out}\\) = 100 Ω.\n\nDraw the two-port model for a transresistance amplifier by conversion from the voltage amplifier model.\nDraw the two-port model for a transconductance amplifier by conversion from the voltage amplifier model.\nDraw the two-port model for a current amplifier by conversion from the voltage amplifier model.\n\nP1.7 Compute the transresistance \\(v_{out} / i_{in}\\) for the circuit of Figure 1.7 using the following parameters: \\(A_{i1}\\) = 1, \\(G_{m2}\\) = 10 mS, \\(A_{v3}\\) = 0.8, \\(R_{in1}\\) = 50 Ω, \\(R_{out1}\\) = 500 Ω, \\(R_{out2}\\) = 1 kΩ, and \\(R_{out3}\\) = 100 Ω. Using this result, lump the entire circuit into a single transresistance amplifier as shown in Figure 1.9(d). Draw the resulting model, including \\(R_{in}\\) and \\(R_{out}\\).\nP1.8 Consider the amplifier circuit of Figure 1.13\n\nwith \\(R_1 = 1/g_m\\) = 1 kΩ and \\(R_2\\) = 100 kΩ and \\(R_S\\) = \\(R_L\\) = 10 kΩ. Compute all component values for the bilateral two-port current amplifier model of Figure 1.13\nNote that \\(A_{if}\\), \\(R_{in}\\),and \\(R_{out}\\) can be described as explained in Section 1-3. Similar to \\(A_{if}\\), \\(A_{ir}\\) is found by short-circuiting the input port and by injecting a test current into the output port. Compare the relative magnitude of \\(A_{if}\\) and \\(A_{ir}\\).",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.2.html#first-order-mosfet-model",
    "href": "contents/partI/partI.2.html#first-order-mosfet-model",
    "title": "2  Transfer Characteristic of the Common-Source Voltage Amplifier",
    "section": "2.1 First-Order MOSFET Model",
    "text": "2.1 First-Order MOSFET Model\nThe device-level derivations of this section assume familiarity with basic solid-state physics and electrostatics. For a ground-up treatment from first principles, the reader is referred to introductory solid-state device material (see Reference 1).\n\n2.1.1 Derivation of I-V Characteristics\nThe basic structure of an enhancement mode n-channel MOSFET is shown in Figure 2.1(a). It consists of a lightly doped p-substrate (bulk), two heavily doped n-type regions (source and drain) and a conductive gate electrode that is isolated from the substrate using a thin silicon dioxide layer of thickness \\(t_{ox}\\). Other important geometry parameters of this device include the channel length \\(L\\) (distance between the source and drain) and the channel width \\(W\\).\n   As we shall see, the name “n-channel” stems from the fact that this device conducts current by forming an n-type layer underneath the gate. A p-channel device can be constructed similarly using an n-type bulk and p-type source/drain regions. The differentiating details between n- and p-channel devices are summarized in Section 2-1-2. For the time being, we will use the n-channel device to discuss the basic principles.\n\n\n\n\n\n\nFigure 2.1: (a) Cross-section of an n-channel MOSFET.\n\n\n\nIn order to study the electrical behavior of a MOSFET, it is useful to define a schematic symbol and conventions for electrical variables as shown in Figure 2.1(b) . The variables \\(V_{GS}\\), \\(V_{DS}\\), and \\(V_{BS}\\) describe the voltages between the respective terminals using the commonly used ordered subscript convention \\(V_{XY}\\) = \\(V_{X}\\) – \\(V_{Y}\\). The current flowing into the drain node is labeled \\(I_{D}\\).\n   It is important to note that the MOSFET device considered here is perfectly symmetric; i.e., the drain and source terminal labels can be interchanged. It is a common convention to assign the source to the lower potential of these two terminals, since this terminal is the source of electrons that enable the flow of current. We will see later that this convention, together with the arrow that marks the source (and the direction of current flow), provides useful intuition when reading a larger circuit schematic.\n   We now begin our analysis of the MOSFET device by considering the condition shown in Figure 2.2(a), where the bulk and source are connected to a reference potential (GND), \\(V_{GS}\\) = 0 \\(V\\) and \\(V_{DS}\\) = 0 \\(V\\). Under this condition, the drain and source terminals are isolated by two reverse-biased pn-junctions and their depletion regions, which prevent any significant flow of current. Applying a positive voltage at the drain (\\(V_{DS}\\) &gt; 0 \\(V\\)) increases the reverse-bias at the drain-bulk junction and will only increase the width of the depletion region at the drain, while \\(I_{D}\\) = 0 is still maintained (to first-order).\n   Consider now \\(V_{GS}\\) = 0 as shown in Figure 2.2(b). This positive voltage at the gate attracts electrons from the source. With increasing \\(V_{GS}\\), a larger amount of electrons is supplied by the source, and ultimately, a so-called inversion layer forms underneath the gate. The voltage \\(V_{GS}\\) at which a significant number of mobile electrons underneath the gate become available is called the threshold voltage of the transistor, or \\(V_{t}\\). In order to differentiate the threshold voltages and other device parameters of n-and p-channel devices, we will utilize the subscripts n and p throughout this module. E.g., we denote the threshold voltage for n-channels and p-channels as \\(V_{Tn}\\) and \\(V_{Tp}\\)., respectively.\n\n\n\n\n\n\nFigure 2.2: (a) n-channel MOSFET with \\(V_{GS}\\) = 0, (b) \\(V_{GS}\\) &gt; \\(V_{Tn}\\),\n\n\n\n   With the inversion layer under the gate, the drain and source regions are now “connected” through a conductive path and any voltage between these terminals (\\(V_{GS}\\) &gt; 0) will result in a flow of drain current. How can we calculate this current? In order to answer this question, the following approximations are useful:\n   1. The current primarily depends on the number of mobile electrons in the channel times their velocity.\n   2. The number of mobile electrons in the channel is set by the vertical electric field from the gate to the conductive channel (gradual channel approximation).\n   3. The threshold voltage is constant along the channel; this assumption neglects the so-called body effect.\n   4. The velocity of the electrons traveling from the source to the drain is proportional to the lateral electric field in the channel.\n   Figure 2.2(b) establishes relevant variables for further analysis. The auxiliary variable \\(y\\) ranges from 0 to \\(L\\) and is used to express electrical quantities as a function of the distance from the source. The inversion layer charge density (per unit area) and voltage at position \\(y\\) in the channel are denoted as \\(Q_{n}(y)\\) and \\(V_{y}\\),respectively. With these conventions in place, we can translate the above-listed assumptions into the following equations:\n\\[\nI_D = - {W} \\cdot Q_n \\cdot v(y)\n\\tag{2.1}\\]\n\\[\nQ_n(y) = -C_{ox} \\cdot (V_{GS}  -  V(y) - V_{Tn})\n\\tag{2.2}\\]\n\\[\nv(y) = -\\mu_n \\cdot E_y\n\\tag{2.3}\\]\nIn these expressions, \\(v\\) is the velocity of the carriers, \\(C_{ox}\\) is the gate capacitance per unit area (between the gate electrode and the conductive channel). The term \\(\\mu_n\\) is called mobility, and it relates the drift velocity of the carriers to the local electric field.\n   As indicated in Equation 2.2, the mobile charge density at coordinate \\(y\\) depends on the local potential, since the voltage across the oxide is given by \\(V_{GS}\\) – \\(V(y)\\). An inversion layer is present at any location under the gate where this voltage difference is larger than the threshold (\\(V_{Tn}\\)). Assuming that the inversion layer extends from source to drain as drawn in Figure 2.2(b), we have \\(V(L)\\) = \\(V_{DS}\\) and \\(Q_{n}\\)\\((L)\\) = –\\(C_{ox}\\) (\\(V_{GS}\\) – \\(V_{Tn}\\) – \\(V_{DS}\\)). This implies that \\(V_{DS}\\) cannotexceed \\(V_{GS}\\) – \\(V_{Tn}\\) for an inversion layer that extends across the entire channel. For the time being, we will solve for the drain current for this condition and later extend the obtained result for the case of \\(V_{DS}\\) = \\(V_{GS}\\) – \\(V_{Tn}\\).\n   Now, by combining Equation 2.1 through Equation 2.3 and noting that the electric field is given by \\(E(y)=-dV(y)/dy\\) , we can write\n\\[\nI_D =  \\mu_n C_{ox} W \\cdot (V_{GS} - V_y - V_{Tn}) \\frac{dV_y}{dy}\n\\tag{2.4}\\]\nThis result describes the current density profile along the channel. The terminal current, \\(I_{D}\\), can be found by separating the variables and integrating along the direction of \\(y\\)\n\\[\n\\int_0^L I_D \\, dy = \\mu_n C_{ox} W \\int_0^{V_{DS}} (V_{GS} - V(y) - V_{Tn}) \\, dV\n\\tag{2.5}\\]\nwhich yields a closed-form solution for the drain current\n\\[\n\\boxed{ I_D = \\mu_n C_{ox} \\frac{W}{L} \\left( V_{GS} - V_{Tn} - \\frac{V_{DS}}{2} \\right) V_{DS} }\n\\tag{2.6}\\]\nNote that this expression is valid for \\(V_{DS}\\) &lt; \\(V_{GS}\\) – \\(V_{Tn}\\), as assumed above. In order to extend the obtained result for \\(V_{DS}\\) = \\(V_{GS}\\) – \\(V_{Tn}\\), we continue by inspecting the shape of the inversion layer for various \\(V_{DS}\\) (see Figure 2.3). For \\(V_\n{DS}\\) = 0 V [case (a)], no current flows and \\(V(y)\\) = 0 for all \\(y\\). Provided that \\(V_{GS}\\) &gt; \\(V_{Tn}\\), a uniform inversion layer exists underneath the gate. For small \\(V_{DS}\\) &gt; 0, a current flows in the inversion layer, which causes increasing \\(V(y)\\) and decreasing inversion layer charge along the channel. As \\(V_{DS}\\) approaches \\(V_{GS}\\) - \\(V_{Tn}\\), \\(Q_{n}(L)\\) approaches zero with a point of diminishing charge at the drain. This effect is called pinch-off.\n\n\n\n\n\n\nFigure 2.3: Channel profile for varying \\(V_{DS}\\).\n\n\n\n   What happens when we increase \\(V_{DS}\\) beyond the point of pinch-off? Further analysis based on solving the two-dimensional Poisson Equation at the drain predicts that the pinch-off point will move from \\(L\\) to \\(L – ΔL\\), where \\(ΔL\\) is small relative to \\(L\\). Even though no inversion layer exists in the region from \\(L – ΔL\\) to \\(L\\), the device still conducts current. The charges arriving at \\(y = L – ΔL\\) are being swept to the drain by the electric field present in the depletion region of the surrounding pn junction.\n   To first-order, and neglecting the small change in channel length \\(ΔL\\), the current becomes independent of \\(V_{DS}\\) and is approximately given by the current at the onset of pinch-off, i.e., at \\(V_{DS}\\) = \\(V_{GS}\\) – \\(V_{Tn}\\). Substituting this condition into Equation 2.6, we obtain\n\\[\n\\boxed{I_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn})^2}\n\\tag{2.7}\\]\nfor \\(V_{DS}\\) ≥ \\(V_{GS}\\) – \\(V_{Tn}\\).\nEquation 2.6 and Equation 2.7 are plotted in Figure 2.4 as a function of \\(V_{DS}\\) and some fixed \\(V_{GS}\\) &gt; \\(V_{Tn}\\). The operating region for \\(V_{DS}\\) &lt; \\(V_{GS}\\) – \\(V_{Tn}\\) is commonly called the triode region. This name stems from the direct dependence of the drain current on the drain-source voltage, which is qualitatively similar to the behavior of vacuum tube “triodes.” The region \\(V_{DS}\\) ≥ \\(V_{GS}\\) – \\(V_{Tn}\\) is called the saturation region due to the saturation in current at large \\(V_{DS}\\). In this region, the device operates essentially like a current source; the current is (to first-order) independent of the applied \\(V_{DS}\\) and \\(I_{D}\\) = \\(I_{Dsat}\\) = constant. The quantity \\(V_{GS}\\) – \\(V_{Tn}\\) is often called gate overdrive.\n\n\n\n\n\n\nFigure 2.4: (a) n-channel I-V characteristic for a fixed value of \\(V_{GS}\\) – \\(V_{Tn}\\)= 2V. (b) I-V plots with varying \\(V_{GS}\\) – \\(V_{Tn}\\) (drain characteristic). Parameters: \\(μCox\\) = 50 \\(μA/V^2\\) and \\(W/L = 10\\).\n\n\n\n   The drain-source voltage at which the drain current saturates is called \\(V_{DSat}\\). From the above first-order analysis, it is clear that \\(V_{DSat}\\) = \\(V_{GS}\\) – \\(V_{Tn}\\). Nonetheless, it is useful to distinguish between these two quantities, because they may differ significantly when a more elaborate device model is used. \\(V_{DSat}\\) is generally not exactly equal to \\(V_{GS}\\) – \\(V_{Tn}\\) when second-order effects, for example related to small geometries and modern device structures, are considered.\n   From a circuit perspective, the device’s behavior in the triode region is similar to a resistor: the current increases monotonically with increasing terminal voltage. Even though the dependence of \\(I_{D}\\) on \\(V_{DS}\\) is nonlinear (as seen from Equation 2.6), it is sometimes useful to approximate the characteristic using a linear I-V law, shown as a dashed line in Figure 2.4(a). For \\(V_{DS}\\) \\(\\ll\\) \\(V_{GS}\\) – \\(V_{Tn}\\) , we can approximate Equation 2.6 as\n\\[\nI_D \\equiv \\mu_n C_{ox} \\frac{W}{L} (V_{GS} - V_{Tn}) V_{DS}\n\\tag{2.8}\\]\nUnder this approximation, \\(I_{D}\\) depends linearly on \\(V_{DS}\\), and we can define the so-called on-resistance of the device as\n\\[\nR_{on} = \\frac{V_{DS}}{I_D} \\equiv \\frac{1}{\\mu_n C_{ox} \\frac{W}{L} (V_{GS} - V_{Tn})}\n\\tag{2.9}\\]\nIt is interesting to interpret the dependencies in this expression using basic intuition. Increasing the aspect ratio \\(W /L\\) decreases \\(R_{on}\\) since the conductive path becomes shorter and/or wider; this is a basic property of any conductor. The on-resistance also decreases with increasing \\(C_{ox}\\) and \\(V_{GS}\\) – \\(V_{Tn}\\); this is because the inversion charge increases with these quantities (\\(Q = CV\\)). Larger mobility (\\(μ_{n}\\)) means that the carriers travel faster for the same applied voltages (electric field). This increases the current (charge per unit of time) and therefore also results in smaller \\(R_{on}\\).\n   As seen from Equation 2.7, the magnitude of the drain current in saturation depends on the square of the gate overdrive \\(V_{GS}\\) – \\(V_{Tn}\\). This is further illustrated in Figure 2.4(b), which shows I-V plots for increasing multiples of \\(V_{GS1}\\) – \\(V_{Tn}\\) = 1V. Doubling and tripling the gate overdrive increases the saturation current by factors of four and nine, respectively. Note that \\(R_{on}\\) is reduced only by factors of two and three in these cases, respectively.\nThe plot in Figure 2.4(b) is often called the drain characteristic, because the drain-source voltage (as opposed to the gate-source voltage, which is included as a parameter on the curves), is swept along the x-axis. Alternatively, the term output characteristic is sometimes used, primarily because \\(V_{DS}\\) can often be viewed as the output port voltage of the device; we will see this in the example discussed in Section 2-2.\nAnother commonly used characterization plot for MOSFETs is the so-called transfer characteristic, which shows the drain current as a function of \\(V_{GS}\\) for a fixed value of \\(V_{DS}\\). If \\(V_{DS}\\) is chosen large enough such that the device operates in the saturation region for all applied \\(V_{GS}\\), \\(I_{D}\\) follows from Equation 2.7 and the plot is shaped like a parabola as drawn in Figure 2.5.\n\n\n\n\n\n\nFigure 2.5: Plot of n-channel drain current as a function of \\(V_{GS}\\) (transfer characteristic). Parameters: \\(V_{DS}\\) = 5 V, \\(μC_{ox}\\) = 50μA/\\(V^2\\),\\(V_{Tn}\\) = 0.5 V, and \\(W/L\\) = 10.\n\n\n\n   Table 2.1 summarizes the first-order MOSFET I-V relationships that were discussed in this section. This set of equations (and extended versions thereof) is often called the square-law model since one of its primary features is the quadratic dependence of the saturation current on \\(V_{GS}\\) – \\(V_{Tn}\\). When working with this device model, it is important to remember that it predicts the behavior of real MOSFETs only with limited accuracy. This is primarily so because we have made several simplifications in the model’s derivation. The most significant shortcom ings that result from these assumptions can be summarized as follows:\n\nIn reality, the saturation current has a weak dependence on \\(V_{DS}\\). This is primarily due to a shortening of the channel length (\\(ΔL\\)) with increasing \\(V_{DS}\\) and also due to the drain voltage dependence of the mobile charge in the channel. We will address this issue in Section 2-2.\nFor transistors built in modern technologies, several second-order effects related to small geometries and large electric fields become significant. This typically results in a saturation current law exponent that is less than two, and \\(V_{DSat}\\) &lt; \\(V_{GS}\\) – \\(V_{Tn}\\). In addition, the drain current does not scale strictly proportional to \\(1/L\\) and the threshold voltage is not constant, but a function of the drain voltage.\nFor \\(V_{GS}\\) &lt; \\(V_{Tn}\\) the device is not completely off, but carries a small current that exponentially depends on \\(V_{GS}\\). This operating region is called the sub-threshold region.\nFor small values of \\(V_{GS}\\) &lt; \\(V_{Tn}\\), on the order of a few tens of millivolts, the region underneath the gate is only moderately inverted, and the square law model tends to predict the drain current with poor accuracy.\n\n\n\n\n\nTable 2.1: First-order MOSFET model summary\n\n\n\n\n\n\n\n\n\n\n\n“ON”\n\\(V_{GS} ≥  V_{Tn}\\)\n“OFF”\n\\(V_{GS} &lt; V_{Tn}\\)\n\n\n\n\n\\(V_{DS} &lt; V_{DSat}\\)\n\\(I_D = \\mu_n C_{ox} \\frac{W}{L} (V_{GS} - V_{Tn} - \\frac{V_{DS}}{2}) V_{DS}\\)\n\\(I_D = 0\\)\n\n\n\\(V_{DS} \\geq V_{DSat}\\)\n\\(I_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} (V_{GS} - V_{Tn})^2\\)\n\\(I_D = 0\\)\n\n\n\n\n\n\n\n\n   Despite these shortcomings, the first-order MOSFET model possesses many of the critical features needed to study the fundamentals of analog circuit design. Many of the second-order effects not featured in the basic model can be treated using advanced device physics and often result in a high-complexity model that is unsuitable for hand-calculations and intuition building.\n   Within the range of circuits treated in this mod ule, we typically begin by applying the first-order model. Then, only when the circuit appears to be sensitive to second-order dependencies not covered by this model, we will look for extensions. A treatment in this fashion has the advantage that the reader can develop a feel for where and when modeling extensions and parameter accuracy are critical.\n   In general, the tradeoff between modeling accuracy and complexity is a recurring theme at all levels of analog circuit design; the issue is not limited to the introductory material covered in this module. More accurate models can always be generated at the expense of complexity and time. An experienced analog designer will often use the simplest possible model that will predict the behavior of his or her circuit with sufficient (but not perfect) accuracy. This also implies that analog circuit designers must always be on the lookout for model inadequacies. We will encounter and discuss situations where either model expansions or critical insight on modeling accuracy are needed throughout this module.\n\n\n2.1.2 P-Channel MOSFET\nThe n-channel MOSFET discussed so far conducts current through an electron inversion layer in a p-type bulk. Similarly, we can construct a p-channel device that operates based on forming an inversion layer of holes in an n-type bulk. The structure of such a MOSFET, which consists of \\(p+\\) source and drain regions in an n-type bulk, is shown in Figure 2.6. In many process technologies, the n-type bulk region is formed by creating an n-type well (n-well) in the p-type substrate that is used to form n-channels. Such a technology is called an n-well technology. In general, a technology that offers both n- and p-channel devices is called CMOS technology, where CMOS stands for Complementary Metal-Oxide-Semiconductor.\n\n\n\n\n\n\nFigure 2.6: (a) Cross-section of a p-channel MOSFET. (b) Schematic symbol.)\n\n\n\n   The drain current equations for a p-channel MOSFET can be derived using exactly the same approach as used for the n-channel device since the basic physics are the same. For a p-channel device, the gate must be made negative with respect to the p-type source in order to form an inversion layer of holes; the threshold voltage \\(V_{Tp}\\) is therefore typically negative. Since holes drift across the channel from the source to the drain in the p-channel MOSFET, the drain voltage must be negative with respect to the source, and the drain current (defined as flowing into the drain terminal) is negative. Therefore, in the on-state of the transistor, \\(V_{GS}\\) and \\(V_{DS}\\) are negative quantities, and the source lies at the highest potential among the four terminals. The drain current for a p-channel in saturation, i.e., \\(V_{GS}\\) &lt; \\(V_{DS}\\) and \\(V_{DS}\\) ≤ \\(V_{GS}\\) – \\(V_{Tp}\\), is given by\n\\[\n{I_D = -\\frac{1}{2} \\mu_p C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tp})^2}\n\\tag{2.10}\\]\nA practical problem for the circuit designer is to keep track of the minus signs and negative quantities in the p-channel equations. A solution to this issue is to “think positive,” and work with the physically intuitive positive quantities \\(V_{SG}\\) (instead of \\(V_{GS}\\)), \\(V_{SD}\\) (instead of \\(V_{DS}\\)) in all hand calculations. Following this approach, we can rewrite Equation 2.10 as\n\\[\n-{I_D = \\frac{1}{2} \\mu_p C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tp})^2}\n\\tag{2.11}\\]\nNote that the right-hand side of this equation yields a positive number. The minus sign included on the left-hand side remains necessary because \\(I_D\\), as defined in Figure 2.6(b), is a negative quantity.\n\n\n2.1.3 Standard Technology Parameters\nFor use throughout this module, it is convenient to define standard MOSFET parameter values as given in Table 2.2. The chosen values are representative of a CMOS technology with a minimum channel length, or feature size of 1 \\(\\mu\\)m. As we learn more about the behavior of MOSFETs in later sections, this list of parameters will grow and we will augment it as needed.\n    In the context of defining these parameters, it is important to make a clear distinction between technology parameters and design parameters. Technology parameters are typically fixed in the sense that a circuit designer cannot alter their values. For instance, the mobility in a MOSFET depends on how the transistor is made, and the underlying recipe remains unchanged and will be reused for an extended time to manufacture a large variety and quantity of integrated circuits. In most modern CMOS technologies, the width and length of a MOSFET remain as the only parameters that the circuit designer can choose (within appropriate limits) to alter the device’s electrical behavior.\n   In determining the transistor geometries, the designer will usually work with electrical variables and parameters that describe the circuit and its functionality, for example in terms of currents and voltages. From these electrical descriptions and specifications, the widths and lengths of the transistors are then calculated, and sometimes adjusted via an iterative process. In this task, intermediate electrical parameters, as for instance the gate overdrive of a MOSFET, are also legitimately viewed as parameters that are under the control of the circuit designer.\nExample 2-1: P-Channel Drain Current Caculation\nA p-channel transistor is operated with the following terminal voltages relative to ground: \\(V_{G}\\) = 2.5 \\(V\\), \\(V_{S}\\) = \\(V_{B}\\) = 5 \\(V\\), \\(V_{D}\\) = 1 \\(V\\). Calculate the drain current \\(I_D\\) using the standard technology parameters given in Table 2.2 and assuming \\(W/L = 5\\).\nSOLUTION\nFrom the given terminal voltages, we find \\(V_{SG}\\) = 5 \\(V\\)– 2.5 \\(V\\) = 2.5 \\(V\\) and \\(V_{SD}\\) = 5 \\(V\\) – 1 \\(V\\) = 4 \\(V\\). Since \\(V_{SG}\\) &gt; \\(V_{Tp}\\), the transistor is on, and since \\(V_{SD}\\) &gt; \\(V_{SG}\\) + \\(V_{Tp}\\) = 2.5 \\(V\\) – 0.5 \\(V\\) = 2 \\(V\\), it operates in saturation. Therefore, using Equation 2.11 we find\n\n\\[\n-{I_D = \\frac{1}{2} \\mu_p C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tp})^2}\n\\] \\[\n-{I_D = \\frac{1}{2} \\cdot 25\\frac{μA}{V^2} \\cdot 5 \\cdot (2.5 V - 0.5V)^2 = 250μA}\n\\]\n\\[\n-I_D = -250μA\n\\]\n\n\n\n\nTable 2.2: Standard technology parameters for the first-order MOSFET model\n\n\n\n\n\n\n\n\n\n\nParameter\nn-channel MOSFET\np-channel MOSFET\n\n\n\n\nThreshold voltage\n\\(V_{Tn}\\) = 0.5V\n\\(V_{Tp}\\) = -0.5V\n\n\nTransconductance parameter\n\\(μ_nC_{ox}= 50μA/V^2\\)\n\\(μ_pC_{ox}= 25μA/V^2\\)",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transfer Characteristic of the Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.2.html#building-a-common-source-voltage-amplifier",
    "href": "contents/partI/partI.2.html#building-a-common-source-voltage-amplifier",
    "title": "2  Transfer Characteristic of the Common-Source Voltage Amplifier",
    "section": "2.2 Building a Common-Source Voltage Amplifier",
    "text": "2.2 Building a Common-Source Voltage Amplifier\nWe will now utilize our first-order understanding of MOSFETs to construct a basic voltage amplifier. We begin by noting that the drain current in all regions of operation can be controlled by varying the gate-source voltage. One way to utilize this effect to build a voltage amplifier is to apply the input such that it controls \\(V_{GS}\\). An output voltage can then be generated by letting the drain current flow through a resistor, as shown in Figure 2.7(a). The top terminal of the resistor is connected to a supply voltage, \\(V_{DD}\\). In this scheme, a larger \\(V_{IN}\\) causes the drain current to increase and \\(V_{OUT}\\) to decrease, since a larger \\(V_{IN}\\) makes the transistor a “better conductor” (more inversion charge), which forces the voltage at the output port closer to ground. This type of circuit is therefore categorized as an inverting amplifier. Furthermore, this transistor stage is called a common-source amplifier, since the source terminal of the MOSFET is common to the input and output ports of the circuit.\n\n\n\n\n\n\nFigure 2.7: (a) Basic common-source amplifier schematic. (b) Voltage transfer characteristic for \\(V_{DD}\\) = 5 \\(V\\), \\(R_D\\) = 5 \\(kΩ\\), and \\(W/L\\) = 20.\n\n\n\n\n2.2.1 Voltage Transfer Characteristic\nIn order to derive the voltage transfer characteristic of the circuit (\\(V_{OUT}\\) as a function of \\(V_{IN}\\)) we begin by applying Kirchhoff’s laws at the output node. This yields\n\\[\nV_{OUT} = V_{DD} - I_D R_D\n\\tag{2.12}\\]\nThe drain current ID in this expression depends on \\(V_{GS}\\) and \\(V_{DS}\\) of the transistor, as described in Table 2.1. Given the structure of the circuit in Figure 2.7(a), we note that \\(V_{GS}\\) = \\(V_{IN}\\) and \\(V_{DS}\\) = \\(V_{OUT}\\). Using this information, we can construct a piecewise function that relates the input and output voltages of the circuit. For this derivation, imagine that we sweep \\(V_{IN}\\) from 0 \\(V\\) to the supply voltage, \\(V_{DD}\\).\n   First, we note that for \\(V_{IN}\\) = \\(V_{GS}\\) &lt; \\(V_{Tn}\\), no current flows in the transistor; this implies \\(V_{OUT}\\) = \\(V_{DD}\\). This behavior is shown in Figure 2.7(b) as a horizontal line for the input voltage range 0 ≤ \\(V_{IN}\\) &lt; \\(V_{Tn}\\), between points A and the vertical line at \\(V_{Tn}\\). As \\(V_{IN}\\) increases to values greater than or equal to \\(V_{Tn}\\), the transistor conducts current, and \\(V_{OUT}\\) must be less than \\(V_{DD}\\). In order to calculate how \\(V_{OUT}\\) changes as a function of \\(V_{IN}\\), we must first determine the transistor’s region of operation. As we increase \\(V_{IN}\\) above \\(V_{Tn}\\), does the MOSFET operate in saturation or in the triode region?\n   To answer this question, we must determine if \\(V_{DS}\\) is smaller or larger than \\(V_{GS}\\) - \\(V_{Tn}\\). For \\(V_{IN}\\) just above \\(V_{Tn}\\), \\(V_{GS}\\) – \\(V_{Tn}\\) is smaller than \\(V_{DS}\\), which is still close to \\(V_{DD}\\) at the onset of current conduction. Therefore, the device must initially operate in saturation as we transition from the “OFF” state of the transistor into the region where \\(I_D\\) &gt; 0. Under this condition, the output voltage is given by\n\\[\nV_{OUT}=V_{DD} - R_D \\cdot \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L}(V_{IN}-V_{Tn})^2\n\\tag{2.13}\\]\nand the voltage transfer characteristic shows a drop that is quadratic in \\(V_{IN}\\) as seen in Figure 2.7(b).\n   As we continue to increase \\(V_{IN}\\), \\(V_{GS}\\) - \\(V_{Tn}\\) also increases while \\(V_{OUT}\\) continues to decrease. At a sufficiently large \\(V_{IN}\\), \\(V_{DS}\\) can approach \\(V_{GS}\\) - \\(V_{Tn}\\) and the condition for current saturation may no longer hold; the device then transitions into the triode region. The input voltage at which this transition occurs (point \\(C\\) in Figure 2.7(b)) can be computed by setting the right-hand side of Equation 2.13 equal to \\(V_{IN}\\) – \\(V_{Tn}\\), and solving for \\(V_{IN}\\). It is interesting to note that graphically, point \\(C\\) can be found through the intersection of the voltage transfer characteristic with the line \\(V_{IN}\\) – \\(V_{Tn}\\). The intersect corresponds to the point where \\(V_{OUT}\\) = \\(V_{DS}\\) = \\(V_{IN}\\) – \\(V_{Tn}\\) = \\(V_{GS}\\) - \\(V_{Tn}\\), i.e., the transition point between saturation and triode for the MOSFET.\n   For the region where the MOSFET operates in the triode region, we have\n\\[\nV_{OUT} = V_{DD}-R_D \\cdot \\mu_n C_{ox}\\frac{W}{L}(V_{IN}-V_{Tn}-\\frac{V_{OUT}}{2})V_{OUT}\n\\tag{2.14}\\]\nUnfortunately, solving this expression for \\(V_{OUT}\\) yields an unwieldy square-root expression that is best analyzed graphically. As we can see from the plot in Figure 2.7(b), the most important feature here is that the slope of the voltage transfer characteristic diminishes for large \\(V_{IN}\\); i.e., the slope of the curve at point \\(D\\) is smaller than the slope at point \\(C\\). Qualitatively, this can be explained by viewing the MOSFET as a resistor, whose value continues to decrease with \\(V_{IN}\\). For very large \\(V_{IN}\\), the output voltage must asymptotically approach 0 V. This can be shown by approximating the MOSFET by its on-resistance for small \\(V_{DS}\\) as given by Equation 2.9. The output voltage in the vicinity of point \\(D\\) can then be expressed by considering the resistive voltage divider formed by \\(R_{D}\\) and \\(R_{on}\\).\n\\[\nV_{OUT}≅\\frac{V_{DD} \\cdot R_{on}}{R_D + R_{on}} = \\frac{V_{DD}}{1+R_D\\cdot\\mu_n C_{ox}\\frac{W}{L}(V_{IN}-V_{Tn})}\n\\tag{2.15}\\]\nThis result confirms that for large input voltages, \\(V_{OUT}\\) will asymptotically approach zero.\nExample 2-2: Voltage Transfer Calculations for a Common-Source Amplifier\nConsider the circuit of Figure 2.7(a) with the following parameters: \\(V_{DD}\\) = 5 \\(V\\), \\(R_D\\) = 10 \\(kΩ\\).\n\nUsing the standard technology parameters of Table 2.2, calculate the required aspect ratio \\(W/L\\) such that \\(V_{OUT}\\) = 2.5 \\(V\\) for \\(V_{IN}\\) = 1 \\(V\\).\nAssuming \\(W/L\\) =10, calculate the input voltage \\(V_{IN}\\) that yields \\(V_{OUT}\\) = 2.5 \\(V\\).\n\nSOLUTION\n\nAs a first step, we can calculate the drain current that results in \\(V_{OUT}\\) = 2.5 \\(V\\) using Equation 2.12.\n\n\\[\nV_{OUT} = V_{DD}-I_D R_D\n\\] \\[\n2.5V = 5V - (I_D\\cdot 10kΩ )\n\\] \\[\nI_D= 250µA\n\\]\nSince \\(V_{GS}\\) – \\(V_{Tn}\\) = 0.5 V &lt; \\(V_{DS}\\) = 2.5 V, we know that the device must operate in the saturation region. Therefore,\n\\[\nI_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_\n{Tn})^2\n\\] \\[\n250µA= \\frac{1}{2}\\cdot 50\\frac{µA}{V^2}\\cdot\\frac{W}{L}\n\\cdot(1V-0.5V)^2\n\\]\nand solving for the aspect ratio yields \\(W/L = 40\\). Note that this answer can also be found by direct evaluation of Equation 2.13, without computing \\(I_D\\) initially.\n\nsince \\(V_{IN}\\) is unknown in this part of the problem, we cannot immediately determine the operating region of the MOSFET. In such a situation, it is necessary to guess the operating region, and later test whether the guess was correct. Let us begin by assuming that the device operates in saturation. We can then write\n\n\\[\nI_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn})^2\n\\] \\[\n250µA= \\frac{1}{2}\\cdot 50\\frac{µA}{V^2}\\cdot 10 \\cdot(V_{GS}-0.5V)^2\n\\]\nThe two solutions to this equation are \\(V_{GS1}\\) = 1.5 \\(V\\), and \\(V_{GS2}\\) = –0.5 \\(V\\). Since we know that the device is off for \\(V_{GS}\\) &lt; \\(V_{Tn}\\), it is clear that \\(V_{GS2}\\) is a non-physical solution that must be discarded. For the obtained \\(V_{GS1}\\), we must now verify that the device operates in saturation, as initially assumed. It is straightforward to see that this is indeed the case since \\(V_{GS1}\\) – \\(V_{Tn}\\) = 1 \\(V\\)&lt; \\(V_{DS}\\) = 2.5 \\(V\\). Therefore, the final answer to this problem is \\(V_{IN}\\) = 1.5 V.\n   If we had initially guessed that the device operates in the triode region, we would write\n\\[\nI_D=\\mu_n C_{ox}\\frac{W}{L}(V_{GS}-V_{Tn}-\\frac{V_{DS}}{2})V_{DS}\n\\] \\[\n250µA = 50\\frac{µA}{V^2}\\cdot 10 \\cdot (V_{GS} - 0.5V - \\frac{2.5V}{2})\\cdot 2.5V\n\\]\n\nThe two solution to this equation is \\(V_{GS}\\) = 1.95 \\(V\\). Since \\(V_{GS}\\) – \\(V_{Tn}\\) = 1.45 \\(V\\) &lt; \\(V_{DS}\\) = 2.5, we see that the obtained result contradicts the assumed operation in triode. Therefore, the next logical step would be to evaluate the saturation equation, as already done above.\n\n\n\n2.2.2 Load Line Analysis\nA generally useful tool for graphical analysis in electronic circuits is the so-called load line analysis. The basis for such an analysis in the context of our circuit is the fact that the current flowing through the transistor (\\(I_D\\)) is equal to the current flowing through the resistor (which is viewed in this context as the load of the circuit). Therefore, if we draw the I-V characteristics of the MOSFET and \\(R_D\\) in one diagram, valid output voltages lie at the intersection of the two curves (equal current). This is further illustrated in Figure 2.8. The load line equation in this plot follows from solving Equation 2.12 for \\(I_D\\) and is given by\n\\[\nI_D= \\frac{V_{DD} - V_{OUT}}{R_D}\n\\tag{2.16}\\]\n\n\n\n\n\n\nFigure 2.8: Load line plot for the CS amplifier in Figure 2.7(a). Parameters: \\(V_{DD}\\) = 5 V, \\(R_D\\) = 5 kΩ, and \\(W/L = 20\\).\n\n\n\nThe points A, B, C, and D marked in Figure 2.8 correspond to the points shown with the same annotation in Figure 2.7(b). Since the transistor drain characteristics are overlaid in Figure 2.8, it is easy to identify the operating regions that correspond to each point. For example, we can immediately see that point B lies in saturation, since the intersect occurs in a region of constant drain current.\nExample 2-3: Output Voltage Calculations for a Common-Source Voltage Amplifier\nConstruct a load line plot to verify the solution of Example 2-2(b) using \\(V_{DD}\\) = 5 \\(V\\), \\(R_D\\) = 10 kΩ , and W/L =10. Use \\(V_{IN}\\) = \\(V_{GS}\\) = 1 \\(V\\), 1.5 \\(V\\), and 2 \\(V\\) for the drain characteristic plot.\nSOLUTION\nThe solution is shown in Figure 2.9. The load line is most easily drawn by connecting the points (0, \\(V_{DD}\\)/\\(R_D\\) = 0.5 \\(mA\\)) and (\\(V_{DD}\\) = 5 \\(V\\), 0). The drain characteristics are drawn for the three given \\(V_{GS}\\) using the expressions of Table 2.1, by sweeping \\(V_{DS}\\) = \\(V_{OUT}\\) from 0 \\(V\\) to 5 \\(V\\). The intersect of the load line with the drain characteristic for \\(V_{IN}\\) = 1.5 \\(V\\) confirms the result already obtained in Example 2-2(b).\n\n\n\n\n\n\nFigure 2.9\n\n\n\n\n\n2.2.3 Biasing\nAfter deriving the voltage transfer characteristic of our amplifier, we are now in a position to evaluate this circuit from an application standpoint. As we have discussed in Chapter 1, a common objective for a voltage amplifier is to create large output voltage excursions from small changes in the applied input voltage. With this objective in mind, it becomes clear that only a limited range of the transfer characteristic in Figure 2.7(b) is useful for amplification. For example, a change in the input voltage applied around point D in Figure 2.7(b) yields almost no change in the output voltage. In order to amplify small changes in \\(V_{IN}\\) into large changes in \\(V_{OUT}\\), the transistor should be operated in the saturation region, i.e., in the vicinity of point B. The general concept of operating a circuit and its constituent transistor(s) around a useful operating point is called biasing.\n   Biasing generally necessitates the introduction of auxiliary voltages and/or currents that bring the circuit into the desired state. For the circuit considered in this section, proper biasing can be achieved by decomposing the input voltage into a constant component, and a component that represents the incremental voltage change to be amplified; this is illustrated in Figure 2.10(a). The incremental voltage component \\(v_{in}\\) could represent, for instance, the signal generated by a microphone or a similar transducer. The voltage \\(V_{IN}\\) is a constant voltage that defines the point on the overall transfer characteristic around which the incremental \\(v_{in}\\) is applied. We call \\(V_{IN}\\) the input bias voltage of the circuit.\n\n\n\n\n\n\nFigure 2.10: (a) CS amplifier with input bias.(b) Transfer characteristic showing the bias point.\n\n\n\n   Per IEEE convention, the total quantity in such a decomposition is denoted using a lowercase symbol and uppercase subscript, i.e., \\(v_{IN}\\) = \\(V_{IN}\\) + \\(v_{in}\\) in our example. Similarly, the drain current is decomposed as \\(i_{d}\\) = \\(I_{D}\\) + \\(i_{d}\\), where \\(I_{D}\\) is the current at the operating point, and id captures the current deviations due to the applied signal.\n   Figure 2.10(b) elucidates this setup further using the circuit’s transfer characteristic. With \\(v_{in}\\) = 0, the output is equal to \\(V_{OUT}\\), which is called the bias point or operating point of the output node. The bias point is sometimes also called the quiescent point (Q), since the corresponding voltage level corresponds to that of a “quiet” input. Note that \\(V_{OUT}\\) can be calculated by evaluating Equation 2.13, as done previously.\nWith some nonzero \\(v_{in}\\) applied, the output will now see an excursion away from the bias point. For example, applying a positive \\(v_{in}\\) will result in a negative incremental change \\(v_{out}\\) at the output. How can we compute \\(v_{out}\\) for a given \\(v_{in}\\)? Since Equation 2.13 must hold for the total quantities \\(v_{IN}\\) = \\(V_{IN}\\) + \\(v_{in}\\) and \\(v_{OUT}\\) = \\(V_{OUT}\\) + \\(v_{out}\\) we can write\n\\[\nV_{OUT}= V_{DD}-R_D\\cdot \\frac{1}{2}\\mu_n C_{ox}\\frac{W}{L}(v_{IN}-V_{Tn})^2\n\\tag{2.17}\\]\nor\n\\[\nV_{OUT} + v_{out} = V_{DD}-R_D\\cdot \\frac{1}{2}\\mu_n C_{ox}\\frac{W}{L}(V_{IN} + v_{in} -V_{Tn})^2\n\\tag{2.18}\\]\nIn order to simplify this expression, and since we are only interested in the change of \\(v_{out}\\) as a function of \\(v_{in}\\), it is useful to eliminate the constant term from this expression, given by\n\\[\nV_{OUT}= V_{DD}-R_D\\cdot \\frac{1}{2}\\mu_n C_{ox}\\frac{W}{L}(V_{IN}-V_{Tn})^2\n\\tag{2.19}\\]\nAfter subtracting Equation 2.19 from Equation 2.18 and rearranging the terms, we obtain\n\\[\nv_{out} = -R_D \\mu_n C_{ox} \\frac{W}{L}(V_{IN} - V_{Tn}) \\cdot v_{in} [ 1+ \\frac{v_{in}}{2(V_{IN} - V_{TN})}]\n\\tag{2.20}\\]\nUsing the drain current expression of Equation 2.7, and by defining\n\\[\nV_{OV} = (V_{GS} - V_{Tn})|_{Q} = V_{IN} - V_{Tn}\n\\tag{2.21}\\]\nthe result can be further simplified and rewritten as\n\\[\nv_{out} = -\\frac{2I_D}{V_{OV}}\\cdot R_D \\cdot v_{in}(1+\\frac{v_{in}}{2V_{OV}})\n\\tag{2.22}\\]\nwhere \\(I_D\\) is the transistor’s drain current at the bias point, and \\(V_{OV}\\) is introduced as a symbol for the quiescent point gate overdrive voltage.\n   From the end result in Equation 2.22, we see that \\(v_{out}\\) is a nonlinear function of \\(v_{in}\\). This is not surprising, since we are employing a transistor that exhibits a nonlinear I-V characteristic. While this derivation was relatively simple, the analysis of nonlinear circuits in general tends to be complex. Picture a circuit that contains several transistors, as for instance a cascade connection of several stages of the amplifier circuit considered here. Even with only a few nonlinear elements, most cases involving practical circuits with just moderate complexity tends to yield unwieldy expressions. A widely used solution to this problem is to approximate the circuit behavior using a linear model around its operating point, which we will discuss next.\n\n\n2.2.4 The Small-Signal Approximation\nEquation 2.22 is written in a format that suggests an opportunity for simplification. Provided that \\(v_{in}\\) \\(\\ll\\) \\(v_{OV}\\), the bracketed term is close to unity and we can write\n\\[\nv_{out} = -\\frac{2I_D}{V_{OV}}\\cdot R_D \\cdot v_{in} = A_v \\cdot v_{in}\n\\tag{2.23}\\] where \\(A_v\\) is a constant voltage gain term that relates the incremental input and output voltages.\n   Interestingly, the term Av can also be found using basic calculus. Assuming that the incremental voltages represent infinitesimally small deviations in the total signal, we can rewrite Equation 2.23 as\n\\[\ndv_{OUT} = A_v \\cdot dv_{IN}\n\\tag{2.24}\\]\nand therefore\n\\[\nA_v= \\left. \\frac{dv_{OUT}}{dv_{IN}} \\right|_Q = \\left. \\frac{dv_{OUT}}{dv_{IN}} \\right|_{v_{IN}=v_{IN}}\n\\tag{2.25}\\]\nwhere the derivative is evaluated at the circuit’s operating point \\(Q\\) that is fully defined by choice of the input bias voltage \\(V_{IN}\\). By applying Equation 2.25 to Equation 2.17, we find\n\\[\nA_v = \\frac{d}{dv_{IN}} \\left[ V_{DD} - R_D - \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} (v_{IN} - V_{Tn})^2 \\right] \\bigg|_{v_{IN} = v_{IN}}\n\\]\n\\[\n= -R_D \\mu_n C_{ox} \\frac{W}{L} (v_{IN} - V_{Tn}) \\bigg|_{v_{IN} = v_{IN}}\n\\tag{2.26}\\]\n\\[\n= -R_D \\mu_n C_{ox} \\frac{W}{L} (V_{IN} - V_{Tn}) = -R_D \\mu_n C_{ox} \\frac{W}{L} V_{OV}\n\\]\nFinally, using Equation 2.7, we find\n\\[\nA_v = -\\frac{2I_D}{V_{OV}}\\cdot R_D\n\\tag{2.27}\\]\nwhich is the same result obtained previously. The voltage gain \\(A_v\\) can be interpreted graphically as shown in Figure 2.11. From Equation 2.25 and basic calculus we know that \\(A_v\\) is the slope of the tangent to the transfer characteristic at the point (\\(V_{IN}\\), \\(V_{OUT}\\)), which is the operating point of the circuit.\n\n\n\n\n\n\nFigure 2.11: Concept of small-signal voltage gain. In the small signal model, the input and output voltages are linearly related through \\(A_v\\), the slope of the tangent at the operating point of the large-signal transfer characteristic.\n\n\n\n   In analog circuit nomenclature, \\(A_v\\) is called the small-signal voltage gain of the circuit; this emphasizes that this quantity is only suitable for calculations with “small” signals such that nonlinear effects are negligible. In the particular circuit considered here, “small” means \\(v_in\\) \\(\\ll\\) \\(V_{OV}\\), as seen from our analysis. The general concept of approximating circuit behavior by assuming small-signal excursions around an operating point is called small-signal approximation. In order to clearly distinguish a circuit transfer characteristic obtained through such an approximation from one that incorporates the nonlinear transistor behavior (e.g., Equation 2.17), the term large-signal transfer characteristic is typically used for the latter.\n   As we shall see in the remainder of this module, working with small-signal approximations greatly simplifies analog circuit analysis and design. The price paid for the approximation, however, is that the resulting equations by themselves cannot be used to reason about the circuit’s behavior for large signals, as for instance signals where \\(v_{in}\\) is comparable to, or even greater than, \\(V_{OV}\\). As illustrated in Figure 2.11, the small-signal approximation essentially creates a new coordinate system that linearly relates the input and output voltages. In this model, the output voltage follows the input linearly, no matter how large the applied voltage is. In reality, considering the circuit’s large signal transfer characteristic, signal clipping and strong waveform distortion can occur for large excursions and poorly chosen bias points. Examples of such cases are illustrated in Figure 2.12.\n\n\n\n\n\n\nFigure 2.12: Examples of signal clipping and distortion. (a) Output waveform is clipped due to supply voltage limit. (b) Output waveform drives the MOSFET into the triode region.\n\n\n\nExample 2-4 : Signal clipping\nConsider the circuit of Figure 2.10, using the parameters from Example 2-2(b): \\(V_{DD}\\) = 5 \\(V\\), \\(R_D\\) = 10 \\(kΩ\\), W/L = 10, and \\(V_{IN}\\) is adjusted to 1.5 V, so that \\(V_{OUT}\\) = 2.5 \\(V\\) at the circuit’s operating point. Calculate the most negative excursion that the incremental input voltage \\(v_{in}\\) can assume before the output is “clipped” to \\(V_{DD}\\) (as in Figure 2.12(a)).\nSOILUTION\nThe circuit’s output voltage is given by\n\\[\nv_{OUT} = V_{DD}-R_D\\cdot \\frac{1}{2}\\mu_n C_{ox}\\frac{W}{L}(V_{IN} + v_{in} -V_{Tn})^2\n\\]\nClipping \\(v_{OUT}\\) to the supply voltage implies \\(v_{OUT}\\) = \\(V_{DD}\\). This requires\n\\[\n0= V_{IN} + v_{in} - V_{Tn}\n\\]\n\\[\nv_{in} = -(V_{IN}  - V_{Tn}) = - (V_{OV})\n\\]\n\\[\nv_{in} = -(1.5V-0.5V) = -1V\n\\]\nIn words, applying a negative signal (\\(v_{in}\\)) at the input of magnitude larger than 1 V will cause the output to reach the supply voltage. Making \\(v_i\\) more negative will create a “plateau” in the output waveform as shown in Figure 2.12(a).\n   In a majority of analog circuits, it is sufficient to use the large-signal characteristic for bias-point and signal-range calculations. For all other purposes, as for instance voltage gain calculations, it is usually appropriate and justifiable to work with small-signal approximations. Without this clever split in the analysis, most analog circuits of only moderate complexity would not be amenable to hand analysis, simply because the nonlinear nature of the transistors would create prohibitively complex systems of non- linear equations.\n   Circuits that are designed to amplify small signals from a transducer are classical examples where the small-signal approximation works. Consider, for instance, the above-discussed amplifier circuit fed with an input signal from a radio antenna, which is often on the order of several hundred microvolts. As long as \\(V_{OV}\\) is chosen larger than several hundred millivolts, the small signal approximation will hold with reasonable accuracy. Other examples (not covered in this module) include amplifiers that rely on electronic feedback, which tends to minimize the signal excursions around a circuit’s bias point (see Reference 2).\n   As a final remark, it should be noted that even if the input to a circuit is “small,” the output will always show at least some amount of nonlinear distortion. In our basic amplifier, this distortion is caused by the bracketed term in Equation 2.22. In cases where even weak distortion is an issue, the designer often employs computer simulation tools to study the relevant behavior. From a design perspective, deviations from linearity can be minimized if needed. For the discussed common-source amplifier, this is seen from Equation 2.22: decreasing the ratio \\(v_{in}\\) / \\(V_{OV}\\), either by reducing \\(v_{in}\\) or by increasing \\(V_{OV}\\) will result in improved linearity.\n   The exact analysis ofThe exact analysis of nonlinear distortion is beyond the scope of this module, and is typically treated only in advanced integrated circuit texts, as for instance Reference 3. We will focus here primarily on studying the relevant behavior of analog circuits using a linear small-signal abstraction, aided by basic bias-point and signal-range calculations.\n\n\n2.2.5 Transconductance\nThe method of differentiating a circuit’s large-signal transfer characteristic to obtain a small-signal approximation was straightforward for the simple one-transistor circuit discussed so far. Unfortunately, for a larger circuit it is usually much more difficult and often tedious to derive a complete transfer characteristic in the form of Equation 2.17.\n   A clever workaround that is predominantly used in analog circuit analysis is based on linearizing the circuit element-by-element around the operating point. This method is applied in three steps: (1) Compute all node voltages and branch currents at the operating point using the devices’ large-signal model. (2) Substitute linear models for all nonlinear components and compute their parameters using the operating point information. (3) Compute the desired transfer function using the linear model obtained in step 2.\n   The biggest advantage of this method, called small-signal analysis, is that it avoids computing the large-signal transfer characteristic of the circuit, and instead defers the transfer function analysis until all elements have been approximated by linear models. The linearized models of nonlinear elements, such as MOSFETs, are typically called small-signal models.\n\n\n\n\n\n\nFigure 2.13: (a) Large-signal transfer characteristic of an n-channel MOSFET in the saturation region. (b) Small-signal transconductance (\\(g_m\\)) at the operating point.\n\n\n\nWe will now illustrate the small-signal analysis approach by applying it to the basic common-source amplifier example covered so far in this chapter. Consider first the MOSFET device in Figure 2.7(a). In general, once the operating point of the transistor is known, the small-signal model is obtained by differentiating the large signal I-V relationships at this point. This is further illustrated in Figure 2.13, assuming that the MOSFET is biased in the saturation region. The proportionality factor that links the incremental drain current (\\(i_d\\)) and the gate-source voltage (\\(v_{gs}\\)) is given by the slope of the tangent to the large signal transfer characteristic at the bias point. This quantity is called transconductance, or \\(g_m\\). Mathematically, we can write\n\\[\ng_m = \\frac{i_d}{v_{gs}} = \\left. \\frac{di_D}{dv_{GS}} \\right|_{v_{GS}=V_{GS}}\n\\tag{2.28}\\]\nIn order to find the transconductance for the saturation region of the device, we evaluate Equation 2.28 using Equation 2.7. This yields\n\\[\ng_m = \\mu_n C_{ox}\\frac{W}{L}(V_{GS}- V_{Tn}) = \\mu_n C_{ox}\\frac{W}{L}V_{OV}\n\\tag{2.29}\\]\nAlternative forms of this expression are obtained by eliminating \\(V_{OV}\\) or \\(μ_n C_{ox}\\) W/L using Equation 2.7, which gives\n\\[\ng_m = \\sqrt{2\\mu_n C_{ox} \\frac{W}{L}I_D}\n\\tag{2.30}\\]\nor\n\\[\ng_m = \\frac{2I_D}{V_{OV}}\n\\tag{2.31}\\]\nAll of the above equations can be used to calculate \\(g_m\\); the choice of which equation is used depends on the given parameters. The physical unit for transconductance is \\(A/V\\) = \\(Ω^{-1}\\), or Siemens (\\(S\\)).\nOnce the transconductance is determined, we can insert the model of Figure 2.13(b) into the original circuit (Figure 2.7(a)) for further analysis. The resulting small-signal circuit equivalent is shown in Figure 2.14. No modeling modification is needed for the resistor \\(R_D\\), as it is already assumed in Figure 2.7(a) that it follows a linear \\(I/V\\) law (\\(V= I \\cdot R\\)). However, since the supply voltage is constant in the large-signal model, it must be replaced with 0 V or ground (\\(GND\\)) in the small-signal model. This is because the differentiation of a constant quantity yields zero.\n\n\n\n\n\n\nFigure 2.14: Small-signal model of the circuit in Figure 2.7(a).\n\n\n\nUsing the model of Figure 2.14, we now apply Kirchhoff’s laws at the output and find \\[\nv_{out} = -g_m \\cdot v_{in} \\cdot R_D\n\\tag{2.32}\\]\nFinally, by substituting Equation 2.31 we obtain\n\\[\nv_{out} = -\\frac{2I_D}{V_{OV}} \\cdot R_D \\cdot v_{in} = A_v \\cdot v_{in}\n\\tag{2.33}\\]\nAs expected, this result is equivalent to what was obtained by applying the small-signal approximation to Equation 2.22, and also by differentiating Equation 2.17 at the operating point. However, as indicated previously, the big advantage of working with a small-signal model for individual transistors is that this simplifies the analysis of larger circuits.\n\n\n2.2.6 P-Channel Common-Source Voltage Amplifier\nAs shown in Figure 2.15(a), we can also build a CS amplifier using a p-channel device. Similar to the n-channel case, we can derive a large-signal transfer characteristic using Equation 2.11 and by applying \\(KVL\\) at the output node. The resulting plot is shown in Figure 2.15(b). Compared to the n-channel case (Figure 2.7(b)), one can show that the characteristic is flipped sideways (since \\(V_{SG}\\) = \\(V_{DD}\\) - \\(V_{IN}\\)) and upside down (because \\(I_D\\) is negative for a p-channel transistor). Therefore, for small \\(V_{IN}\\) near 0 \\(V\\), the device operates in the triode region and the output voltage is close to \\(V_{DD}\\). For \\(V_{IN}\\) = \\(V_{DD}\\), the device is off and the output is at 0 \\(V\\), since \\(V_{SG}\\) = 0 and no current flows in the device.\n\n\n\n\n\n\nFigure 2.15: (a) P-channel common-source amplifier schematic. (b) Voltage transfer characteristic for \\(V_{DD}\\) = 5 V, \\(R_D\\) = 5 \\(kΩ\\), and \\(W/L\\) = 40.\n\n\n\nIn terms of its small-signal model, it follows that the p-channel CS amplifier is identical to the n-channel version. This can be seen intuitively by comparing Figure 2.7(b) and Figure 2.15(b): in the region around point \\(B\\), both transfer characteristics exhibit a negative slope and therefore will behave alike for small perturbations. We will show this formally in the following discussion.\n   We begin by inserting a small-signal model for the transistor as shown in Figure 2.16(a). Based on the positive variable convention of Equation 2.11, we define the transconductance for the p-channel transistor as\n\\[\ng_m = \\left. \\frac{d}{dv_{SG}}((-i_D))\\right |_Q\n\\]\n\\[\n= \\mu_p C_{ox}\\frac{W}{L}(V_{SG} + V_{Tp})\n\\tag{2.34}\\]\n\\[\n= \\frac{2(-I_D)}{V_{SG}+V_{Tp}} = \\frac{2(-I_D)}{V_{OV}}\n\\]\n\n\n\n\n\n\nFigure 2.16: Small-signal model of the p-channel common-source amplifier: (a) using the p-channel model directly, (b) a flipped version of (a), and (c) with sign changes applied to show equivalence with the n-channel model.\n\n\n\nNote that through this expression, we have defined \\(V_{OV}\\) for the p-channel case as \\(V_{SG}\\) + \\(V_{Tp}\\), which is a positive quantity for a p-channel device in the “ON” state.\n   Although we could solve for the small-signal voltage gain directly with the circuit shown in Figure 2.16(a) it is easier to flip the transistor 180° (Figure 2-15(b)) so that the circuit appears similar to the n-channel version. Since \\(v_{sg}\\)=–\\(v_{gs}\\) we can change signs at the input and the dependent current source and find that the p-channel common-source amplifier small-signal model is identical to the n-channel version as shown in Figure 2.16(c).\n   This result applies more generally to all the transistor configurations and model extensions that we will study in this module. Once the operating point parameters of a p-channel device have been determined (e.g., a calculation of \\(g_m\\) using Equation 2.34), it is perfectly valid to replace it with an n-channel equivalent. This is a very powerful and convenient result, since it allows us to focus on n-channel only configurations in small-signal analyses, without having to worry about the specific sign conventions of p-channels.\n\n\n2.2.7 Modeling Bounds for the Gate Overdrive Voltage\nAccording to Equation 2.31, \\(g_m/I_D\\) = \\(2/V_{OV}\\) tends to infinity as the gate overdrive voltage \\(V_{OV}\\) approaches zero. This implies that for a transistor that is “barely on,” we can extract very large transconductance values for only small bias currents. Unfortunately, this behavior is incorrect, and stems from limitations of the device model discussed in Section 2-1. As \\(V_{OV}\\) approaches zero, a more complex analysis is needed to predict the drain current and its derivative with respect to gate voltage see Reference 4.\nFigure 2.17 plots the \\(g_m/I_D\\) characteristic of a MOSFET, and the expected behavior based on Equation 2.31. As we can see, for \\(V_{OV} &lt; 150 mV\\), a large discrepancy exists between a physical device and the prediction based on the simple square-law model used in this treatment. In order to avoid unrealistic design outcomes due to this modeling limitation, we define a bound for the minimum allowed gate overdrive voltage for all circuits covered in this module\n\\[\nV_{OV}≥ V_{OVmin} = 150 mV\n\\tag{2.35}\\]\nDesigning with a smaller \\(V_{OV}\\) would require a more elaborate model for hand calculations, which is beyond the scope of this module. The interested reader is referred to advanced material on this topic, available for example in References 4 and 5.\n\n\n\n\n\n\nFigure 2.17: Transconductance to current ratio predicted by Equation 2.31 and the behavior of an actual MOSFET.\n\n\n\n\n\n2.2.8 Voltage Gain and Drain Biasing Considerations\nIn the basic common-source amplifier discussed so far, the drain resistor \\(R_D\\) serves a dual purpose: (1) it translates the device’s incremental drain current (\\(i_d\\)) into a voltage (\\(V_{out}\\)), and (2) it supplies the quiescent point drain current (\\(I_D\\)) for the MOSFET. As we shall show next, this creates an undesired link between the bias point constraints of the circuit and the achievable small-signal voltage gain of the amplifier. To see this, we rewrite Equation 2.36 as shown below\n\\[\nA_v = - \\frac{2I_D}{V_{OV}} \\cdot R_D = -2\\frac{V_R}{V_{OV}}\n\\tag{2.36}\\]\nwhere \\(V_R\\) = \\(V_{DD} – V_{OUT}\\) is the voltage drop across RD at the operating point. This result leads to several interesting conclusions. First, note that the voltage gain of the amplifier is fully determined once \\(V_{OV}\\) and voltage drop across \\(R_D\\) are known. For example, if the circuit is biased such that \\(V_{OV}\\) = 0.2 \\(V\\) and \\(V_R\\) = 2 \\(V\\), we have \\(A_v\\) = –20; regardless of the particular W, L or \\(\\mu_n\\) \\(C_{ox}\\) of the employed MOSFET. Second, since the possible values for \\(V_{OV}\\) are lower-bounded (Equation 2.35) and \\(V_R\\) is upper-bounded (finite \\(V_{DD}\\)), there exists a maximum possible \\(A_v\\) that can be obtained\n\\[\n|A_{vmax}| = 2\\frac{V_{Rmax}}{V_{OVmin}} = 2\\frac{V_{DD}-V_{OVmin}}{V_{OVmin}} ≅ 2\\frac{V_{DD}}{V_{OVmin}}\n\\tag{2.37}\\]\nIn this result, it was assumed the transistor is biased at the edge of the triode region, a somewhat impractical, but appropriate limit case to consider. Evaluating the above expression for \\(V_{DD}\\) = 5 V and \\(V_{OVmin}\\) = 150 \\(mV\\) yields \\(|A_{vmax}|\\) ≅ 67. Can we overcome this limit and change our amplifier such that it can achieve voltage gains beyond this value?\nIn order to investigate this, consider the load line illustrations shown in Figure 2.18. As explained in Section 2-2-2, the load line for our circuit is defined by the points (0, \\(V_{DD}\\)/\\(R_D\\)) and (\\(V_{DD}\\), 0). From the location of these points, we see that the x-axis intercept of the load line is fixed, while the y-intercept moves lower with larger values of \\(R_D\\). This reduces the slope of the load line, resulting in a larger small-signal voltage gain of the circuit. Furthermore, note that for a fixed quiescent point drain current \\(I_D\\), larger \\(R_D\\) shifts the output bias point \\(V_{OUT}\\) to smaller values, i.e., closer to the edge of the MOSFET’s triode region. This observation captures the result of Equation 2.37 in a graphical way: we cannot increase the small-signal voltage gain beyond a certain limit due the link between \\(V_{OUT}\\) and the chosen \\(R_D\\).\n\n\n\n\n\n\nFigure 2.18: Amplifier load lines for large and small values of \\(R_D\\).\n\n\n\n   A more ideal situation is depicted in Figure 2.19. If we could somehow create a load line that “rotates” about the desired operating point (as a function of \\(R_D\\)), the voltage gain could be set independently of \\(V_{OUT}\\). A modified drain network that lets us achieve this behavior is shown in Figure 2.20(a). In this circuit, \\(R_D\\) is now connected to a voltage \\(V_B\\) (instead of the supply voltage \\(V_{DD}\\)) and an ideal current source \\(I_B\\) is used to provide a fixed current. In a realistic implementation circuit, \\(I_B\\) can be built, for example, using a p-channel MOSFET that operates in saturation. For the time being, we will neglect such implementation details, and postpone the discussion of current sources to Chapter 5.\n\n\n\n\n\n\nFigure 2.19: Desired load line behavior.\n\n\n\n   With this new configuration, the relationship between \\(i_D\\) and \\(v_{OUT}\\) becomes\n\\[\ni_D = I_B = \\frac{V_B - v_{OUT}}{R_D}\n\\tag{2.38}\\]\nor \\[\nv_{OUT} = V_B + (I_B - i_D)R_D\n\\tag{2.39}\\]\nAs we can see from these equations (also graphically shown in Figure 2.20(b)), at the point \\(v_{OUT}\\) = \\(V_B\\), we have \\(i_D\\) = \\(I_B\\), regardless of the value of \\(R_D\\)$. Therefore, utilizing this point as the operating point of our amplifier precisely achieves the goal we have in mind. In particular, we wish to set \\(I_B\\) = \\(I_D\\), the desired quiescent point drain current of the MOSFET, and \\(V_B\\) = \\(V_{OUT}\\), the desired output operating point. With this choice, the role of the current source is to provide the MOSFET’s bias current, while the resistor RD is responsible only for converting the incremental drain current into an incremental output voltage; no DC bias current flows in this element.\n\n\n\n\n\n\nFigure 2.20: (a) CS amplifier with modified drain biasing scheme. (b) Load line characteristic.\n\n\n\n   Since the voltage source \\(V_B\\) and the current source \\(I_B\\) aid in maintaining the circuit’s bias point, we generally classify these elements as biasing sources. However, it is important to distinguish their function from the input bias voltage \\(V_{IN}\\). \\(V_{IN}\\) directly sets the quiescent point gate-source voltage of the transistor and therefore fully defines the operating point on the MOSFET’s I-V characteristic and the corresponding drain current. In the above-described scenario, \\(I_B\\) is adjusted to supply this same drain current, but does not define it. We therefore categorize \\(I_B\\) an auxiliary bias current that helps sustain, but does not set the quiescent point of the transistor. Since \\(V_B\\) defines the quiescent point output voltage of the circuit, we refer to this element as the output bias voltage.\n   Lastly, it is important to note that for the modified circuit in Figure 2.20(a), the previously derived small-signal model shown in Figure 2.14 still applies. This can be understood by differentiating Equation 2.39 at the operating point to find the small-signal equivalent of the network placed at the drain of the amplifier\n\\[\n\\left. \\frac{dv_{out}}{di_D} \\right|_Q = \\frac{d}{di_D}(V_B +(I_B - i_D)R_D) = -R_D\n\\tag{2.40}\\]\nAs this result indicates, and as we have seen previously, any constant sources, such as \\(V_B\\), \\(I_B\\), etc., drop out of the small signal model, which captures only components that affect the incremental changes in currents and voltages around the circuit’s operating point.\n   For the circuit in Figure 2.20(a), one might now be tempted to think that we can obtain an arbitrarily large voltage gain, as long as \\(R_D\\) is made very large. Unfortunately this is not the case for several reasons, the first of which stems from physical effects that we have not yet included in the MOSFET model. This aspect is further discussed in Section 2-3. In addition, there are practical limitations to the attainable voltage gain, discussed next.\n\n\n2.2.9 Sensitivity of the Bias Point to Component Mismatch\\(^*\\)\n\nConsider a CS amplifier biased at the gate as done previously with a bias voltage \\(V_{IN}\\), directly setting up the quiescent point drain current \\(I_D\\) (depending on \\(W/L\\) and other relevant device parameters). Our goal in using the drain bias network of Figure 2.20(a) is then to set \\(I_B\\) = \\(I_D\\) and chose \\(VB\\) such the output is biased at a reasonable, desired \\(V_{OUT}\\). Unfortunately, in practice, we can never achieve \\(I_B\\) = \\(I_D\\) exactly; there will always be a non- zero \\(ΔI\\) = \\(I_B\\) – \\(I_D\\). This case is shown in Figure 2.21. As illustrated, the finite \\(ΔI\\) leads to a shift \\(ΔV\\) away from the desired output operating point \\(V_B\\). This shift is proportional to \\(R_D\\), since the current difference \\(ΔI\\) flows into \\(R_D\\), creating the undesired \\(ΔV\\).\n\n\n\n\n\n\nFigure 2.21: Bias point shift due to mismatch in \\(I_B\\) and \\(I_D\\).\n\n\n\nExample 2-5: Output Bias Voltage Shift due to Current Mismatch\nConsider the CS amplifier of Figure 2.20(a), biased at the gate such that \\(V_{OV}\\) = 500 mV. Assume \\(I_D\\) = 200 \\(μA\\), and that \\(R_D\\) is chosen such that the amplifier achieves \\(A_v\\) = –400. Considering Figure 2.21, how much mismatch between \\(I_B\\) and \\(I_D\\) (in \\(%\\)) can be tolerated such that \\(V_{OUT}\\) deviates from the intended bias point (\\(V_B\\)) by no more than \\(ΔV\\) = 500 \\(mV\\)? Repeat this calculation for \\(A_v\\) = –40 and –4.\nSOLUTION\nWe begin by computing the transconductance of the MOSFET\n\\[\ng_m = \\frac{2I_D}{V_{OV}} = \\frac{2 \\cdot 200\\mu_A}{0.5V} = 800 µS\n\\]\nIn order to achieve \\(A_v\\) = –400, we require \\(R_D\\) = 400/800 \\(μS = 500 kΩ\\). Therefore,\n\\[\n\\frac{∆ I}{I_D} = \\frac{∆V}{I_D R_D} &lt; \\frac{500 mV}{200\\mu A \\cdot 500kΩ} = 0.5 \\%\n\\]\nFor \\(A_v\\) = –40 and \\(A_v\\) = –4, the result modifies to 5%, and 50%, respectively.\nAs expected, this result confirms that for larger \\(|A_v|\\), the auxiliary bias current \\(I_B\\) must match the MOSFETs drain current more accurately. How precisely can we match these two currents? Unfortunately, answering this question in detail is beyond the scope of this module, and is the subject of advanced research papers such as Reference 6. Nonetheless, it can be said in general that matching currents, voltages, or any other electrical quantities in today’s integrated circuits to better than 1% requires special care and understanding. In some cases, even 10% matching can be hard to guarantee. With this guideline in mind, it becomes clear that the circuit of Figure 2.20(a) may become impractical if we aim for too much voltage gain.\n   The general issue of properly dealing with variability in integrated circuit components is a complex topic that is still being actively researched. At the introductory level of this module, the main point that the reader should retain is that any circuit whose bias point relies on precisely matched components or high absolute accuracy in any electrical parameter may not be robust in the presence of component variability. In general, experienced circuit designers avoid situations that resemble the “balancing of a marble on the tip of a cone,” i.e., circuits that will be overly sensitive to variations in component parameters. We will take up this point once more when discussing practical biasing circuits in Chapter 5.\n   As a final note concerning the issue of variability, it is worth mentioning that electronic feedback can help alleviate problems as the one analyzed in Example 2-5. Picture for example adding an auxiliary circuit to Figure 2.20(a) that somehow measures VOUT, and adjusts \\(V_{IN}\\) (and therefore \\(I_D\\)) until the desired output operating voltage is set. In such schemes, relatively large variations in \\(I_B\\) can be absorbed. Feedback circuits are not covered in this module, but are the subject of advanced texts such as Reference 2.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transfer Characteristic of the Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.2.html#channel-length-modulation",
    "href": "contents/partI/partI.2.html#channel-length-modulation",
    "title": "2  Transfer Characteristic of the Common-Source Voltage Amplifier",
    "section": "2.3 Channel Length Modulation",
    "text": "2.3 Channel Length Modulation\nThe MOSFET model used so far assumes that the drain current in the saturation region is independent of the drain-source voltage. This behavior corresponds to that of an ideal current source, which is generally non-physical. A more realistic output characteristic observed in real MOSFETs is shown in Figure 2.22. For a physical MOSFET, \\(I_D\\) tends to increase with \\(V_{DS}\\); an effect that can be explained (to first-order) as a voltage dependent modulation of the channel length (see Section 2-3-1).\n\n\n\n\n\n\nFigure 2.22: Realistic n-channel I-V plots, incorporating the dependence of saturation drain current on \\(V_{DS}\\). (solid lines), along with the first-order model assumed previously (dotted lines). Parameters: W = 20 \\(μm\\), L = 2 \\(μm\\).\n\n\n\n   When inserted into the circuit of Figure 2.20(a), the dependence of drain current on \\(v_{DS}\\) (\\(v_{OUT}\\)), will have an impact on the overall transfer characteristic of the amplifier, which we will thus consider in this section. For simplicity, let us first investigate the case of \\(R_D\\) –&gt; ∞, i.e., no explicit drain resistance, and using only an ideal current source in the drain biasing network (see Figure 2.23(a)). In this case, the load line is horizontal at \\(I_B\\) = \\(I_D\\), as shown in Figure 2.23(b). As before, the operating point \\(Q\\) is established at the point where the load line and the device’s drain characteristic for the applied quiescent point input voltage (\\(V_{IN}\\)) meet.\n\n\n\n\n\n\nFigure 2.23: (a) Intrinsic voltage gain stage. (b) Load line plot.\n\n\n\n   Note that similar to the case considered in the previous section, the output operating point voltage in this circuit will shift by large amounts for relatively small changes in \\(I_B\\) (or MOSFET parameters). This issue must be addressed when this circuit is used in practice, for example by providing a feedback mechanism that adjusts \\(I_B\\) such that the desired \\(V_{OUT}\\) is maintained in the presence of component variations.\n   Assuming that a well-defined operating point has been established by some means, incremental changes in \\(v_{IN}\\) applied around the bias point \\(Q\\) will force the intersection of the horizontal load line with the MOSFET’s drain characteristics to move sideways (since the drain current cannot change), creating a finite output voltage excursion vout. The magnitude of this voltage excursion, and thus the voltage gain of the circuit, depends on the slope of the MOSFET’s drain characteristic in saturation. The voltage gain achieved in this configuration is commonly called the intrinsic voltage gain of the MOSFET, as it represents the voltage gain of the transistor by itself, without any added resistances in the drain bias network. By the same reasoning, the circuit of Figure 2.23(a) is often called the intrinsic voltage gain stage. The voltage gain and other parameters of more complex amplifier circuits are often directly related to the intrinsic voltage gain of their constituent transistors, giving this parameter a fundamental significance in circuit design.\n\n2.3.1 The λ-Model\nUnfortunately, the intrinsic voltage gain of a MOSFET cannot be predicted using the MOSFET model established so far. We will therefore extend the first-order MOSFET model to incorporate the dependence of the saturation current on the drain-source voltage. As a first step, we will describe the effect in terms of large-signal equations. Next, we will apply a small-signal approximation that makes it possible to capture the \\(I_{Dsat} – V_{DS}\\) dependence through a single resistor added to the MOSFET’s small-signal model.\n   We begin by revisiting an approximation that was made in Section 2-1. In order to arrive at the constant drain current expression in saturation (Equation 2.7), it was assumed that \\(ΔL\\), the distance from the pinch-off point to the drain, is negligible relative to the channel length L. In reality, this approximation is fine only as long we do not care about the \\(I_D-V_{DS}\\) dependence seen in Figure 2.22. Therefore, in order to get a quantitative handle on the MOSFET’s intrinsic voltage gain, we must further investigate the impact of the physics at the drain side.\nThe simplest possible way to proceed is to factor \\(ΔL\\) into the existing derivation of Section 2-1. Instead of integrating Equation 2.5 over the length L, we use \\(L– ΔL\\) as the upper limit of the integral. Recall that \\(L– ΔL\\) is the actual location where the mobile charge vanishes, i.e., \\(Qn(y)= 0\\). With this change we obtain the following expression for the saturation region.\n\\[\nI_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L-∆L} ({V_{GS}} - V_{Tn})^2\n\\tag{2.41}\\]\nNow, provided that \\(ΔL\\) is still small (but not negligible) relative to \\(L\\), we can apply the following first-order approximation:\n\\[\n\\frac{1}{L-∆L} ≈ \\frac{1}{L}(1+\\frac{∆L}{L})\n\\tag{2.42}\\]\nNext, note that \\(ΔL\\) must be a function of the drain voltage, since the depletion region widens with increasing reverse bias. This effect is commonly called channel length modulation. Unfortunately, an exact calculation of \\(ΔL\\) as a function of the terminal voltages involves solving the two-dimensional Poisson equation and leads to complex expressions. For simplicity, we assume that the fractional change in channel length is proportional to the drain voltage\n\\[\n\\frac{∆L}{L} = \\lambda_n V_{DS}\n\\tag{2.43}\\]\nwhere \\(\\lambda_n\\) is the channel length modulation parameter. Device measurements and simulations indicate that \\(\\lambda_n\\) approximately varies with the inverse of the channel length. For the MOSFETs in this module, we will use\n\\[\n\\lambda_n = \\frac{0.1\\mu mV^(-1)}{L}\n\\tag{2.44}\\]\nwhere \\(L\\) is in \\(\\mu_nm\\). Finally, we substitute Equation 2.44 and Equation 2.43 into Equation 2.41 and find a very useful approximation to the drain current in saturation, often called the \\(\\lambda\\)-model:\n\\[\nI_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn})^2 (1+\\lambda_n V_{DS})\n\\tag{2.45}\\]\nwhere \\(V_{DS}\\) ≥\\(V_{DSsat} = V_{GS}-V_{Tn}\\). This model has proven useful and sufficiently accurate for basic hand calculations, even though the physics related to the \\(I_{DSsat}\\)-\\(V_{DS}\\) dependence are in reality much more complex than discussed above. As long as \\(\\lambda_n\\) is determined from measurements or accurate physical analysis, the model properly approximates a typical MOSFET’s I-V characteristic to first-order. Higher-order models are typically not used in hand analysis, but find their use in advanced computer simulation models.\n   We now wish to incorporate the channel length modulation effect into the small-signal model of the MOSFET. An important new feature that must be considered in this task is that the drain current of Equation 2.45 now depends on two voltages, namely \\(V_{DS}\\) and \\(V_{GS}\\). A common and appropriate way of handling this situation for small-signal modeling is to approximate the incremental drain current around the operating point as the total differential (as frequently used in error analysis) due to both variables, i.e.\n\\[\ni_d = \\left. \\frac{∂ i_D}{∂ V_{GS}}\\right |_Q \\cdot v_{gs} + \\left. \\frac{∂ i_D}{∂ V_{GS}}\\right |_Q \\cdot v_{ds}\n\\tag{2.46}\\]\nThe above expression essentially treats \\(v_{DS}\\) as a constant when evaluating the derivative of \\(i_D\\) with respect to \\(v_{GS}\\). Similarly, \\(v_{GS}\\) is assumed constant in the differentiation with respect to \\(v_{DS}\\). This use of partial differentiation is justified and reasonably accurate as long as at least one of the following two conditions is met:\n\nThe excursion in the variable that is treated as a constant can be approximated as infinitesimally small and therefore negligible.\nThe excursion in the variable that is approximated as a constant is considerable, but nonetheless does not affect the derivative with respect to the second variable.\n\nIn the context of a common-source amplifier, for instance, the first condition applies to \\(v_{GS}\\). Just as in the derivation of the simple small-signal model without \\(V_{DS}\\) dependence, we can argue that changes in \\(v_{GS}\\) are suitably modeled as “small” (relative to \\(V_{OV}\\)). The same condition cannot be applied to \\(v_{DS}\\) in general. Often times the output voltage, and therefore \\(v_{DS}\\), see large excursions in amplifier circuits. In order for Equation 2.46 to be reasonably accurate, we must require the second condition, i.e., the derivative of \\(i_D\\) w.r.t. \\(v_{GS}\\) must not strongly depend on drain-source voltage. By inspection of Equation 2.45, we see that this condition is met as long as \\(\\lambda_n\\) is small, which is typically the case for MOSFETs intended for use in amplifier stages.\n   To continue with our analysis, we rewrite Equation 2.46 as \\[\ni_d = g_m v_{gs} + g_o v_{ds}\n\\tag{2.47}\\]\nwhere \\[\ng_m = \\left. \\frac{∂ i_D}{∂ V_{GS}}\\right |_Q =  \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn}) (1+\\lambda_n V_{DS}) = \\frac{2I_D}{{V_{GS}} - V_{Tn}} = \\frac{2I_D}{V_{OV}}\n\\tag{2.48}\\]\nand \\[\ng_o = \\left. \\frac{∂ i_D}{∂ V_{GS}}\\right |_Q =  \\frac{1}{2}\\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn})^2 \\lambda_n = \\frac{2I_D}{{V_{GS}} - V_{Tn}} = \\frac{2I_D}{V_{OV}}\n\\tag{2.49}\\]\nwhere the approximate end result assumes \\(\\lambda_n V_{DS}\\) \\(\\ll\\) 1, a condition that is often satisfied for long channels and moderate \\(V_{DS}\\). For instance, assuming L = 2 \\(\\mu\\)m and \\(V_{DS}\\) = 2 \\(V\\) gives \\(\\lambda_nV_{DS}\\) = 0.1 which is much less than one.\n   In the above expressions, \\(g_m\\) is the transconductance of the MOSFET (as defined previously) and go is called the output conductance. The inverse of go is called the output resistance, \\(r_o\\) = \\(g_o^{-1}\\). Graphically,the output conductance corresponds to the slope of the transistor’s drain characteristic at the operating point, which is the derivative of \\(i_D\\) with respect to \\(v_{DS}\\), while keeping the gate-source voltage constant (see Figure 2.24(a)). In the small-signal model of the MOSFET, the output conductance can be included as shown in Figure 2.24(b). This representation follows directly from Equation 2.47, which represents Kirchhoff’s Current Law equation for the drain node of the transistor.\n\n\n\n\n\n\nFigure 2.24: (a) Graphical interpretation of \\(g_o\\). (b) MOSFET small-signal model for the saturation region with output conductance (\\(g_o\\)).\n\n\n\n   Just as with the simple \\(g_m\\)-only small-signal model of Figure 2.13, the main idea for the usage of the extended model with go is to use the small-signal equivalent circuit of Figure 2.24(b) in a larger circuit. We will illustrate this using two examples of interest: the intrinsic voltage gain stage of Figure 2.23(a) and the common-source amplifier of Figure 2.20(a).\n\n\n2.3.2 Common-Source Voltage Amplifier Analysis Using the \\(\\lambda\\)-Model\nFor the intrinsic voltage gain stage, the small-signal model of Figure 2.24(b) corresponds directly to the small-signal model for the entire circuit with \\(v_{in} = v_{gs}\\) and \\(v_{out} = v_{ds}\\). Therefore, the voltage gain of the intrinsic gain stage is given by\n\\[\nA_v = -\\frac{g_m}{g_o} = - g_m r_o ≅ - \\frac{2I_D}{V_{OV}} \\cdot\\frac{1}{\\lambda_n I_D} = - \\frac{2}{\\lambda_n V_{OV}}\n\\tag{2.50}\\]\nFrom this expression, we can see that the voltage gain can be increased by increasing \\(L\\), which will decrease \\(\\lambda\\). Alternatively, the voltage gain can be increased by reducing \\(V_{OV}\\), which corresponds to reducing the drain current \\(I_D\\) for a fixed aspect ration \\(W/L\\). In this context, note that for \\(V_{OV}\\) → 0, Equation 2.50 predicts infinite voltage gain. This non-physical outcome stems from the same issue already discussed in Section 2-2-7: for $V_{OV} → 0, \\(g_m\\) approaches infinity for a fixed current in our simplistic square-law I-V model. As argued before, the usable range for \\(V_{OV}\\) must therefore be lower-bounded as specified in Equation 2.35. Assuming \\(V_{OV} = V_{OVmin}\\) = 150 \\(mV\\) and L = 1 \\(μm\\), the intrinsic voltage gain of a MOSFET described by the parameters used in this module is approximately 2/(0.1·0.15) = 133.\nLet us now consider the common-source amplifier of Figure 2.20(a). Including the finite output conductance from the \\(\\lambda\\)-model, the small-signal model is modified as shown in Figure 2.25 and the voltage gain expression becomes\n\\[\nA_v = -g_m \\left( \\frac{1}{r_o} + \\frac{1}{R_D} \\right)^{-1}\n= -g_m R_{out}\n\\tag{2.51}\\]\n\n\n\n\n\n\nFigure 2.25: Small-signal model for the circuit of Figure 2.20(a), with finite output conductance.\n\n\n\n\nFor \\(R_D\\) → \\(∞\\) , the small signal voltage gain approaches the intrinsic voltage gain as given by Equation 2.50. For \\(R_D \\ll r_o\\), we can approximate \\(A_v ≅ –g_m R_D\\). More generally, without even knowing the exact values of \\(r_o\\) and \\(R_D\\), we can argue that as long as the desired gain is much less (in magnitude) than the intrinsic voltage gain, \\(r_o\\) can be neglected in the voltage gain calculation. To see this, we can rewrite Equation 2.51 as\n\\[\n\\frac{1}{|A_v|} = \\frac{1}{g_m r_o} + \\frac{1}{g_m\nR_D}\n\\]\n\\[\ng_m R_D = \\frac{|A_v|}{1 - \\frac{|A_v|}{g_m r_o}} ≅ |A_v| \\quad \\text{for} \\quad |A_v| \\ll g_m r_o\n\\tag{2.52}\\]\nExample 2-6: Analysis of a CS Amplifier Using the \\(\\lambda\\) -Model\nConsider the CS voltage amplifier of Figure 2.20(a) with \\(W\\) = 80 \\(μm\\), \\(L\\) = 2 \\(μm\\) and \\(R_D\\) = 50 \\(kΩ\\). The gate is biased such that \\(V_{OV} = 500 mV\\) and \\(V_B\\) is set to 2 \\(V\\), which is also the desired output operating point \\(V_{OUT}\\). Compute the required bias current \\(I_B\\) and the small-signal voltage gain of the circuit using the \\(\\lambda\\)-model. Repeat the small-signal voltage gain calculation for \\(R_D\\) = 5 \\(kΩ\\).\nSOLUTION\nThe bias current is found using\n\\[\nI_B = I_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn})^2 (1+\\lambda_n V_{DS})\n\\]\n\\[\n\\frac{1}{2} \\cdot 50 \\frac{\\mu A}{V^2} \\cdot \\frac{80}{2}(0.5V)^2(1+0.05 \\cdot 2)\n\\]\n\\[\n= 275 \\mu A\n\\]\nThe corresponding transconductance and output resistance at the operating point are\n\\[\ng_m = \\frac{2I_D}{V_{OV}} = \\frac{2 \\cdot 275 \\mu A}{0.5 V} = 1.1 mS\n\\]\n\\[\nr_o = \\frac{1+\\lambda_n V_{DS}}{\\lambda_n I_D} = \\frac{1+ 0.05 \\cdot 2}{0.5V^{-1} \\cdot 275\\mu A}\n= 80 kΩ\n\\]\nAccording to Equation 2.51, the small signal voltage gain for \\(R_D\\) = 50 \\(kΩ\\) is given by\n\\[\nA_v = -1.1mS (\\frac{1}{80kΩ} + \\frac{1}{50kΩ})^{-1} = -33.9\n\\]\nfor \\(R_D\\) = 5 \\(kΩ\\) we find\n\\[\nA_v = -1.1mS (\\frac{1}{80kΩ} + \\frac{1}{5kΩ})^{-1} = -5.18\n\\]\nSince the voltage gain for \\(R_D\\) = 5 \\(kΩ\\) is much less than the intrinsic voltage gain of the transistor (\\(g_m r_o\\) = 88), it is appropriate to neglect \\(r_o\\) in this calculation. We can simply compute\n\\[\nA_v = -1.1 mS \\cdot 5 kΩ = -5.5\n\\]\nThis result differs only by about 5.9% from the accurate calculation.\n   Another opportunity for useful engineering approximations in the application of the \\(\\lambda\\)-model lies in the operating point calculation. We will illustrate this point through the example below.\nExample 2-7: Approximate Operating Point Calculations\nRecalculate \\(I_D\\), \\(g_m\\) and \\(r_o\\) by approximating \\(\\lambda\\)\\(V_{DS} ≅ 0\\) in the large-signal bias point calculations. Also recalculate \\(A_v\\) for \\(R_D\\) = 50 \\(kΩ\\) using this approximation. Compare the results to the values obtained in Example 2-6.\nSOLUTION\nFor \\(\\lambda\\) \\(V_{DS}\\) ≅ 0, the bias current is estimated as\n\\[\nI_B = I_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn})^2\n\\]\n\\[\n= \\frac{1}{2} \\cdot 50 \\frac{\\mu A}{V^2} \\cdot \\frac{80}{2}(0.5V)^2\n\\]\n\\[\n= 250 \\mu A\n\\]\nThe corresponding transconductance and output resistance at the operating point are\n\\[\ng_m = \\frac{2I_D}{V_{OV}} = \\frac{2 \\cdot 250 \\mu A}{0.5 V} = 1 mS\n\\]\n\\[\nr_o = \\frac{1}{\\lambda_n I_D} = \\frac{1 }{0.5V^{-1} \\cdot 250\\mu A} = 80kΩ\n\\]\nand the voltage gain becomes\n\\[\nA_v = -1mS (\\frac{1}{80kΩ} + \\frac{1}{50kΩ})^{-1} = -30.8\n\\]\nRelative to the accurate calculation from Example 2-6 (\\(A_v\\) = –33.9), this result is in error by only about 9.1%.\n\nThere are several reasons why it is commonly acceptable to neglect the \\(\\lambda\\)\\(V_{DS}\\) term in bias point hand calculations. First, without this approximation, the calculations can become cumbersome and lead to transcendental equations that are tedious and undesirable to solve in light of only a moderate percent-improvement in the obtained accuracy. If a more accurate result is desired, it can often be obtained more easily from computer simulations, which often follow a hand calculation in practice anyway. Last, one can argue that any circuit in which the operating point parameters strongly depend on \\(\\lambda\\) may be impractical in the first place. The accuracy of the \\(\\lambda\\)-model as far as absolute I-V values are concerned can only be approximate due to its empirical nature. For high accuracy analysis, much more complex models (such as the one described in Reference 7) must be used, carefully calibrated with physical measurements and subsequently evaluated in computer simulations. For the purpose of developing an introductory feel for circuits, however, the \\(\\lambda\\)-model is still the most appropriate, mainly due its simplicity.\n   Table 2-3 summarizes the technology parameters introduced in this chapter.\n\n\n\n\nTable 2.3: Standard technology parameters for the \\(\\lambda\\)-model.\n\n\n\n\n\n\n\n\n\n\nParameter\nn-channel MOSFET\np-channel MOSFET\n\n\n\n\nThreshold voltage\n\\(V_{Tn}\\) = 0.5V\n\\(V_{Tp}\\) = -0.5V\n\n\nTransconductance parameter\n\\(μ_nC_{ox}= 50μA/V^2\\)\n\\(μ_pC_{ox}= 25μA/V^2\\)\n\n\nChanel length modulation parameter\n\\(\\lambda_n =0.1V^{-1}/L\\) (L in \\(\\mu\\) m)\n\\(\\lambda_p =0.1V^{-1}/L\\) (L in \\(\\mu\\) m)",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transfer Characteristic of the Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.2.html#two-port-model-for-the-common-source-voltage-amplifier",
    "href": "contents/partI/partI.2.html#two-port-model-for-the-common-source-voltage-amplifier",
    "title": "2  Transfer Characteristic of the Common-Source Voltage Amplifier",
    "section": "2.4 Two-Port Model for the Common-Source Voltage Amplifier",
    "text": "2.4 Two-Port Model for the Common-Source Voltage Amplifier\nThe circuit shown in Figure 2.25 corresponds to a transconductance amplifier model (with voltage output) since we modeled the MOSFET as a voltage controlled current source, which is in line with its physical behavior in the saturation region. Alternatively, and since the circuit is meant to function as a voltage amplifier, we can equivalently model it using a native voltage amplifier two-port as shown in Figure 2.26. The reader can prove that for this model the open-circuit voltage gain is given by \\(A_v\\) = \\(–g_m R_{out}\\), where \\(R_{out}\\) corresponds to the parallel connection of \\(R_D\\) and \\(r_o\\). The native voltage amplifier model is sometimes preferred since it more directly expresses the intended function we assumed in this chapter. However, as we shall see in Chapter 3, the voltage amplifier two-port is no longer a convenient representation for the CS voltage amplifier when device capacitances are included.\n\n\n\n\n\n\nFigure 2.26: Equivalent voltage amplifier-based model for the common-source amplifier circuit Figure 2.25.\n\n\n\nFigure 2.27 shows the small-signal commonsource voltage amplifier model together with an input transducer and load resistance. Since the input resistance of the CS amplifier is infinite, no resistive division takes place at the input port and \\(v_{in} = v_s\\). Thus, the overall voltage gain is computed as\n\\[\nA'_v = \\frac{v_{out}}{v_s} = A_v \\cdot \\left(\\frac{R_L}{R_L + R_{out}}\\right)\n\\tag{2.53}\\]\n\n\n\n\n\n\nFigure 2.27: Common-source amplifier model with transducer and load resistance.\n\n\n\n    The same expression can be found from the circuit of Figure 2.25 with \\(R_L\\) included across the output port. The reader is invited to prove this.\n   As a final note, we should emphasize that adding a load resistance may have implications on the bias point of the circuit. For example, if the load resistor carries a DC current, this current will affect the quiescent point output voltage of the amplifier. In this case, the load resistance must also be connected to the circuit in the operating point analysis where the small-signal parameters such as \\(r_o\\) are computed. Problem 2-17 looks at an example.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transfer Characteristic of the Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.2.html#summary",
    "href": "contents/partI/partI.2.html#summary",
    "title": "2  Transfer Characteristic of the Common-Source Voltage Amplifier",
    "section": "2.5 Summary",
    "text": "2.5 Summary\nIn this chapter we reviewed the basic I-V characteristics of a MOSFET and employed this device to construct examples of common-source voltage amplifiers. In deriving a model for the MOSFET, we concentrated on first-order effects that define the transistor’s operation. The nonlinear nature of even the simplest device model dictates the use of small-signal approximations to enable analyses with manageable complexity. The presented methodology begins by finding the operating point of the transistor. Next, the small-signal equivalent is used to construct a linear small-signal model for further analysis.\n   We studied the basic common-source voltage amplifier with drain resistance and found that the voltage gain in this circuit is directly proportional to the voltage drop across the resistor, which imposes practical limits on the achievable voltage gain. A modified circuit based on an auxiliary bias current source was then analyzed as an alternative and used as a motivation to incorporate the effect of channel length modulation using the \\(\\lambda\\)-model.\n   The most important concepts that you should have mastered are:\n\nDetermining MOSFET drain currents in all regions of operation; determining the regions of operation based on the transistor’s terminal voltages.\nConstructing transfer characteristics and load line plots for common-source stages for various drain bias configurations.\nCalculating the operating point of a CS stage and the MOSFET’s small-signal parameters \\(g_m\\) and \\(r_o\\).\nDrawing the small-signal model of a CS stage and calculating its voltage gain.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transfer Characteristic of the Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.2.html#references",
    "href": "contents/partI/partI.2.html#references",
    "title": "2  Transfer Characteristic of the Common-Source Voltage Amplifier",
    "section": "2.6 References",
    "text": "2.6 References\n\nR. F. Pierret, Semiconductor Device Fundamentals, Prentice Hall, 1995.\nP. R. Gray, P. J. Hurst, S. H. Lewis, and R. G. Meyer, Analysis and Design of Analog Integrated Circuits, 5th Edition, Wiley, 2008.\nD. O. Pederson and K. Mayaram, Analog Integrated Circuits for Communication: Principles, Simulation and Design, 2nd Edition, Springer,\n\nY. Tsividis, Operation and Modeling of the MOS Transistor, 2nd Edition, McGraw-Hill, New York, 1999.\nP. G. A. Jespers, The \\(g_m/I_D\\) Methodology, a Sizing Tool for Low-Voltage Analog CMOS Circuits, Springer, 2010.\nM. J. M. Pelgrom, et al., “Matching properties of MOS transistors,” IEEE J. of Solid-State Circuits, pp. 1433-1439, May 1989.\nG. Gildenblat, et al., “PSP: An Advanced Surface-Potential-Based MOSFET Model for Circuit Simulation,” IEEE Trans. Electron Devices, pp. 1979-1993, Sept. 2006.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transfer Characteristic of the Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.2.html#problems",
    "href": "contents/partI/partI.2.html#problems",
    "title": "2  Transfer Characteristic of the Common-Source Voltage Amplifier",
    "section": "2.7 Problems",
    "text": "2.7 Problems\nUnless otherwise stated, use the standard model parameters specified in Table 2.3 for the problems given below. Consider only first-order MOSFET behavior and include channel length modulation (as well as any other second-order effects) only where explicitly stated.\nP2.1 An n-channel transistor biased in saturation with \\(W/L = 10\\) carries a drain current of 200 \\(\\mu\\)A when \\(V_{GS}\\) = 1.5 \\(V\\) is applied. With \\(V_{GS}\\) = 1 \\(V\\), the current drops to 50 \\(\\mu\\)A. Determine \\(V_{Tn}\\) and \\(\\mu C_{ox}\\) of this transistor.\nP2.2 Show that two MOS transistors in series with channel lengths \\(L_1\\) and \\(L_2\\) and identical channel widths can be modeled as one equivalent MOS transistor with length \\(L_1 + L_2\\) (see Figure 2.28). Assume that \\(M_1\\) and \\(M_2\\) have identical parameters except for their channel lengths. Hint: there are (at least) two ways to solve this problem. One is through extensive algebra; the other is though physical insight and arguments based on the MOSFET cross-section.\n\n\n\n\n\n\nFigure 2.28\n\n\n\nP2.3 Derive an analytical expression for the input voltage that corresponds to the transition point (point \\(C\\)) between the saturation and triode regions in Figure 2.7(b).\nP2.4 In Example 2-4, we calculated the most negative input excursion that the circuit in Figure 2.10 can handle before the output is clipped to the supply voltage. In this problem, calculate the most positive input excursion that can be applied before the MOSFET enters the triode region. Assume the same parameters as in Example 2-4: \\(V_{DD}\\) = 5 \\(V\\), \\(R_D\\) = 10 \\(kΩ\\), W/L = \\(10\\), and \\(V_{IN}\\) is adjusted to 1.5 \\(V\\), so that \\(V_{OUT}\\) = 2.5 \\(V\\) at the circuit’s operating point.\nP2.5 For the circuit shown in Figure 2.29, sketch \\(v_{OUT}\\) as a function of \\(v_{IN}\\). Assume that \\(v_{IN}\\) varies from 0 to 5 \\(V\\). There is no need to carry out any detailed calculations; simply draw a qualitative graph and mark pertinent asymptotes and breakpoints (such as changes in the MOSFETs region of operation).\n\n\n\n\n\n\nFigure 2.29\n\n\n\nP2.6 Derive the small-signal voltage gain given by Equation 2.27 through direct differentiation of Equation 2.17, i.e., apply 2.25.\nP2.7 A field effect transistor built using a new (fictitious) material behaves “almost” exactly like a conventional MOSFET in silicon technology. The large signal I-V characteristic (in the saturation region) is given by\n\\[\nI_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} ({V_{GS}} - V_{Tn})^{2.5}\n\\]\nAssuming that \\(\\mu C_{ox} W/L\\) = 100 \\(\\mu A\\)/\\(V^{2.5}\\) and \\(I_D\\) = 1 \\(\\mu\\)A,\ncompute the transconductance of the device.\nP2.8 The ratio of the small-signal drain current excursion and quiescent point drain current (\\(i_d/I_D\\)) is sometimes called the drain modulation index. Show that for a MOSFET, \\(i_d/I_D\\) is twice as large as the relative excursion in the gate-source voltage, \\(v_{gs}/V_{OV}\\).\nP2.9 Consider the CS amplifier shown Figure 2.10(a). Calculate the small-signal voltage gain assuming \\(V_{IN}\\) = 1.5 \\(V\\), W/L = 20, \\(R_D\\) = 5 \\(kΩ\\), and \\(V_{DD}\\) = 5 \\(V\\). Be sure to check the device’s region of operation.\nP2.10 Consider the p-channel CS amplifier shown in Figure 2.15(a). Assuming \\(W/L\\) = 20, \\(R_D\\) = 5 \\(kΩ\\), and \\(V_{DD}\\) = 5 \\(V\\), calculate the required quiescent point input voltage so that \\(V_{OUT}\\) = 2.5 \\(V\\). What is the small-signal gain of the circuit?\nP2.11 Repeat Problem 2.9 with \\(R_D\\) = 10 \\(kΩ\\). With this value, the MOSFET operates in the triode region. Compute the small-signal voltage gain by writing the large-signal relationship between the input and output for the triode region and subsequent differentiation at the operating point.\nP2.12 Consider the cascade connection of two CS amplifiers as shown in Figure 2.30.\n\nDraw the small-signal equivalent model for this circuit.\nCalculate the small-signal voltage gains \\(v_{out1}/v_{in}\\) and \\(v_{out2}/v_{in}\\). Assume that \\(V_{IN} = V_{DD} / 2\\) and that the device sizes are chosen such that the bias points of nodes \\(v_{out1}\\) and \\(v_{out2}\\) are also exactly at \\(V_{DD} / 2\\) .\n\n\n\n\n\n\n\nFigure 2.30\n\n\n\nP2.13 Repeat Problem 2.9 and include the effect of channel length modulation in the small-signal voltage gain calculation. Neglect channel length modulation in the bias point calculation. Quantify the percent difference in the calculated small-signal voltage gain compared to Problem 2.9. Assume that the channel length of the MOSFET is 2 \\(\\mu\\)m.\nP2.14 For the p-channel common-source amplifier shown in Figure 2.15(a)\n\nGiven \\(W/L= 12\\) \\(\\mu m\\)/2 \\(\\mu m\\) and \\(R_D\\) = 10 \\(kΩ\\), calculate \\(V_{IN}\\) such that \\(V_{OUT}\\) is 2.5 \\(V\\). \\(V_{DD}\\) = \\(5V\\). Neglect channel length modulation in this calculation.\nWhat is the small-signal voltage gain, \\(A_v = v_{out} /v_{in}\\) ? Include the effect of channel-length modulation in your calculation.\nTo increase the voltage gain, you increase \\(R_D\\) to 100 \\(kΩ\\). Calculate the new small-signal voltage gain, \\(A_v\\). You must re-bias the circuit so that \\(V_{OUT}\\) = 2.5 \\(V\\).\nWe could also try to increase the voltage gain of the initial circuit by increasing \\(W/L\\) rather than \\(R_D\\). Calculate the new \\(A_v\\) if \\(W/L\\)= 120 \\(\\mu m\\) /2 \\(\\mu m\\) and \\(R_D\\) = 10 \\(kΩ\\). Be sure to re-bias the circuit so that \\(V_{OUT}\\) = 2.5 \\(V\\).\n\nP2.15 Calculate the small-signal gain of the intrinsic gain stage shown in Figure 2.23(a), assuming \\(W\\)= 10 \\(\\mu m\\) and using the parameters given below. In each case, explicitly calculate the gate overdrive voltage (\\(V_{OV}\\)), the transconductance (\\(g_m\\)) and the output resistance (\\(r_o\\)). Assume that the circuit is biased such that the MOSFET operates in the saturation region. Neglect \\(V_{DS}\\) dependence in the calculation of \\(r_o\\) .\n\n\\(I_D\\) = 100 \\(\\mu\\)A, \\(L\\) = 2 \\(\\mu\\)m\n\\(I_D\\) = 50 \\(\\mu\\)A, \\(L\\) = 2 \\(\\mu\\)m\n\\(I_D\\) = 100 \\(\\mu\\)A, \\(L\\) = 4 \\(\\mu\\)m\n\nP2.16 Consider the CS amplifier of Figure 2.20(a) with the following parameters: \\(V_B\\) = 2.5 \\(V\\), \\(I_B = 500\\,\\mu\\text{A}, \\; W = 20\\,\\mu\\text{m}, \\; L = 1\\,\\mu\\text{m},\\) and \\(R_D\\) = 5 \\(kΩ\\) .\n\nCalculate the exact value of \\(V_{IN}\\) required such that \\(I_D = I_B\\), and \\(V_{OUT} = V_B\\). Include the effect of channel length modulation in your calculation.\nUsing the value of \\(V_{IN}\\) found in part (a), re-compute \\(V_{OUT}\\) for the two cases when \\(\\lambda\\) changes by +50% and -50%, respectively. Such discrepancies may be due to variations in the semiconductor process or simply due to uncertainty in the simplistic \\(\\lambda\\)-model.\n\nP2.17 Consider the CS amplifier shown in Figure 2.31 with the following parameters: \\(V_{DD}\\) = 5 \\(V\\), \\(V_{IN}\\) = 1.8 \\(V\\), W = 15 \\(\\mu m\\), L = 1 \\(\\mu m\\), \\(R_D\\) = 5 \\(kΩ\\), and \\(R_L\\) = 10 \\(kΩ\\).\n\nCalculate the output quiescent point voltage and drain current of the circuit, taking the connected load resistance \\(R_L\\) into account. Ignore channel-length modulation in this calculation.\nCalculate \\(g_m\\) and \\(r_o\\) using the parameters from part (a). Take \\(V_{DS}\\) dependence into account.\nDraw a two-port voltage amplifier model for the circuit and calculate the open-circuit voltage gain (\\(A_v\\)) and overall voltage gain (\\(A'_v\\)) with the load resistor connected.\nRepeat parts (a) and (b) without considering the connected \\(RL\\) and recompute the two-port parameters of part (c). Summarize the observed differences.\n\n\n\n\n\n\n\nFigure 2.31",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Transfer Characteristic of the Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.3.html",
    "href": "contents/partI/partI.3.html",
    "title": "3  Frequency Response of Common-Source Voltage Amplifier",
    "section": "",
    "text": "TBD.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Frequency Response of Common-Source Voltage Amplifier</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.4.html",
    "href": "contents/partI/partI.4.html",
    "title": "4  The Common-Gate and Common-Drain Stages",
    "section": "",
    "text": "TBD.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>The Common-Gate and Common-Drain Stages</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.5.html#overview",
    "href": "contents/partI/partI.5.html#overview",
    "title": "5  Biasing Circuits",
    "section": "5.1 Overview",
    "text": "5.1 Overview\nFigure 5.1 provides and overview of the circuitry and topics that will be discussed in this chapter. The function of the shown circuits will be explained as we progress through this chapter. Following this introduction, we will investigate basic issues of process variation and device mismatch seen in a typical CMOS fabrication process. This review will help motivate some of the design choices made in later sections. Next, in Section 5.3, we investigate current mirror circuits, which are essential to distributing and generating bias currents in an integrated circuit.\n\n\n\n\n\n\nFigure 5.1: Overview of biasing circuits and topics covered in this chapter.\n\n\n\nThe current that flows into a current mirror circuit is defined by an absolute current reference, for which there exist many different realizations. In Section 5.4, we will study one relevant example of a suitable circuit. In Section 5.5, we will then shift to the problem of bias voltage generation, as relevant for example in setting up the proper gate bias of a common-source or common-gate stage.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Biasing Circuits</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.5.html#sec-5-2",
    "href": "contents/partI/partI.5.html#sec-5-2",
    "title": "5  Biasing Circuits",
    "section": "5.2 Introduction to Process Variation and Device Mismatch",
    "text": "5.2 Introduction to Process Variation and Device Mismatch\n\n5.2.1 Process and Temperature Variations\nIn our analysis of elementary circuit configurations, we have so far implicitly assumed that the underlying component parameters (e.g., the threshold voltage of a MOSFET) are constant and accurately known. Unfortunately, this is not the case in reality. Especially in mass-produced integrated circuits, there are various forms of variability that result in parameter uncertainty due to imperfect fabrication, lifetime drift and influence of environmental conditions such as temperature and humidity. In a typical large semiconductor company, entire departments tend to focus on this issue, and there exists a wealth of related information that could easily fill multiple textbooks. As a result, the focus in this introductory module is to take a cursory look at only the basic issues, to the extent that this can help shape our thinking on how to arrive at practical and relatively insensitive circuit realizations.\n   The first issue that we will review in this section is related to variations arising from imperfect fabrication and temperature changes. In the context of fabrication imperfections, we will clearly distinguish between global process variations and device mismatch. The former term relates to variations that affect all devices on a chip uniformly, while the latter term refers to differences between nominally identical devices that are fabricated on the same chip (see Section 5.2.2).\n   Analog circuit designers often use the term PVT variations to refer to global variations in process, supply voltage, and temperature (see Table 5.1). The most basic way to capture global fabrication process variations is to define parameter sets that group the worst case outcomes as “slow,” “nominal,” and “fast” conditions. This nomenclature was adopted in the context of digital circuits (relating to the speed of a logic gate), but is also used among analog designers. The various parameter sets are often called process corners.\n\n\n\nTable 5.1: Examples of typical process, voltage and temperature (PVT) variations.\n\n\n\n\n\n\n\n\n\n\\(\\textbf{Process}\\)\nThe chip foundry defines three parameter sets for “slow,” “nominal,” and “fast” conditions.\n\n\n\\(\\textbf{Voltage}\\)\nThe chip’s supply voltage is expected to vary by ±10%. For a nominal supply of 5 V, this means that all circuits must work for \\(V_{DD}\\) = 4.5…5.5 V.\n\n\n\\(\\textbf{Temperature}\\)\nConsumer products are typically expected to work in ambient temperatures ranging from 0…70° C. Circuits used in automotive applications must work reliably from –40…125° C.\n\n\n\n\n\n\n   Table 5.2 shows how some important integrated circuit parameters may vary across the three process parameter sets. Here, the nominal column contains the MOSFET parameters that we have assumed so far in this module (see Table 4-1). In the slow parameter set, the threshold voltage is increased and the transconductance parameters (μ\\(C_{ox}\\)) are reduced; this is the parameter combination that yields the slowest speed in a logic gate. The opposite is true for the fast parameter set.\n\n\n\nTable 5.2: Example of a slow, nominal and fast parameter set in a CMOS fabrication process. These parameters assume that the temperature is held constant at 25 ° C (room temperature).\n\n\n\n\n\n\n\n\n\n\n\nParameter\nSlow\nNominal\nFast\n\n\n\n\n\\(V_{T0n}\\) , \\(|{V_{T0p}|}\\)\n0.7 V\n0.5 V\n0.3 V\n\n\n\\(\\mu_n C_{ox}\\)\n40 \\(\\mu A/V^2\\)\n50 \\(\\mu A/V^2\\)\n60 \\(\\mu A/V^2\\)\n\n\n\\(\\mu_p C_{ox}\\)\n20 \\(\\mu A/V^2\\)\n25 \\(\\mu A/V^2\\)\n30 \\(\\mu A/V^2\\)\n\n\n\\(R_{poly}\\)\n60 \\(\\Omega /square\\)\n50 \\(\\Omega /square\\)\n40 \\(\\Omega /square\\)\n\n\n\\(R_{well}\\)\n1.4 \\(k\\Omega /square\\)\n1 \\(k\\Omega /square\\)\n0.6 \\(k\\Omega /square\\)\n\n\n\\(C_{poly}\\)\n1.15 \\(fF/\\mu m^2\\)\n1 \\(fF/\\mu m^2\\)\n0.85 \\(fF/\\mu m^2\\)\n\n\n\n\n\n\n   Table 5.2 also contains examples for parameter variations in passive IC components. \\(R_{poly}\\) and \\(R_{well}\\) are the sheet resistances of a resistor formed by a layer of polysilicon or n-well, respectively. \\(C_{poly}\\) is the capacitance parameter of a parallel plate capacitor formed by two layers of polysilicon. Advanced texts on integrated circuit design such as (Gray et al. 2009) provide further information about the make-up of these and similar components.\n   The tabulated parameter variations do not take temperature variations into account; these must be added on top of the spread from fabrication. Table 5.3 lists a few typical temperature coefficients for each parameter. For example, if the operating temperature of a chip changes from 0°C to 70°C, the threshold voltage a MOSFET will shift by an additional –84 mV.\n\n\n\nTable 5.3: Typical temperature coefficients for integrated circuit device parameters.\n\n\n\n\n\nParameter\nTemperature Coefficient\n\n\n\n\n\\(V_{T0n}\\) , \\(|{V_{T0p}|}\\)\n\\(-\\) 1.2 mV/°C\n\n\n\\(\\mu_n C_{ox}\\)\n\\(-\\) 0.33 %/°C\n\n\n\\(\\mu_p C_{ox}\\)\n\\(-\\) 0.33 %/°C\n\n\n\\(R_{poly}\\)\n\\(+\\) 0.2 %/°C\n\n\n\\(R_{well}\\)\n\\(+\\) 1 %/°C\n\n\n\\(C_{poly}\\)\n\\(-\\) 30 ppm/°C\n\n\n\n\n\n\n   The main take-home from the shown data is that in practice, the analog IC designer cannot view component parameters as constant numbers. His or her circuit must be immune to the level of variability described and function reliably across a large array of outcomes in process, voltage, and temperature. To show how significant these effects can be when neglected, the following example considers the impact of process variations on the bias point of a common-source amplifier.\nExample 5-1: Impact of Process variations in a Common Source Amplifier\nThe circuit in Figure 5.2 was previously analyzed in Example 2-2(b) using nominal parameters (at room temperature). Given \\(V_{DD}\\) = 5 V, \\(R_D\\) = 10 kΩ, W/L = 10 and a desired output bias point of \\(V_{OUT}\\) = 2.5 V, we found that the input bias voltage should be set to \\(V_{IN}\\) = 1.5 V. Assuming \\(V_{IN}\\) = 1.5 V, recompute the circuit’s operating assuming that the MOSFET parameters have shifted to the fast corner case given in Table 5.2. For simplicity, ignore variations in \\(R_D\\) and operating temperature.\n\n\n\n\n\n\nFigure 5.2: Ex5-1\n\n\n\nSOLUTION\nUsing the given parameters, we can directly compute:\n\\[\n\\begin{split}\nV_{out} &= V_{DD} - \\frac{1}{2}\\mu _n C_{ox}\\frac{W}{L}\\Bigl(V_{IN} - V_{Tn}\\Bigr)^2 R_D \\\\\n&= 5V-\\frac{1}{2}\\cdot 60 \\frac{\\mu A}{V^2} \\cdot 10 \\cdot (1.5 - 0.3)^2 \\cdot 10k\\Omega = 0.68 V\n\\end{split}\n\\]\nFrom this result, we see that the MOSFET no longer operates in saturation (since \\(V_{DS}\\) = 0.68 V &lt; \\(V_{GS}\\) – \\(V_{Tn}\\) = 1.2 V). Using the MOSFET’s equation for the triode region, we can compute \\(I_D\\) = 408 μA and \\(V_{OUT}\\) = 918 mV. This outcome differs substantially from the nominal operating point, and the circuit will essentially not function as intended for the fast corner conditions.\n    The main finding from the above example is that it will usually be impractical to bias the input of a common-source stage using a fixed bias voltage source. In practice, the integrated circuit designer generates bias voltages using circuits that will automatically adjust to corner-induced parameter spread and thereby make the circuit immune to process variations (see Section 5.5).\n    Generally speaking, a substantial amount of design time is usually spent on identifying biasing approaches that ensure a circuit’s proper bias point across all possible operating conditions. In addition, once, the circuit is properly biased, the designer must verify that it maintains its key specifications across corners. A typical scenario is to guarantee a certain worst-case gain or bandwidth across all PVT scenarios.\n   As already mentioned, it is impossible to cover all aspects of robust design across PVT variations at the introductory level of this module. Nonetheless, having some of the basic knowledge established above will help us argue qualitatively about the practicality of the circuits discussed in this chapter, and ensure that they will at least have a chance to work in practice.\n\n\n5.2.2 Mismatch\nThe process variations discussed in the previous section account for variability that affects all devices on a given chip equally. For example, all n-channel MOSFETs on a given chip may have slow parameters. Different from process variation, we use the term mismatch to capture variations between nominally identical devices, e.g., two MOSFETs of identical size on the same chip. Such variations are typically caused by line edge roughness, random doping fluctuations and similar effects.\n\n\n\nTable 5.4: Typical ranges of parameter mismatch for nominally identical, closely spaced components.\n\n\n\n\n\nParameter\nMismatch\n\n\n\n\n\\(V_{T0n}\\) , \\(|{V_{T0p}|}\\)\n5…30 mV\n\n\n\\(\\mu_n C_{ox}\\) , \\(\\mu_p C_{ox}\\)\n0.5…2%\n\n\n\\(R_{poly}\\)\n0.3…2%\n\n\n\\(C_{poly}\\)\n0.1…1%\n\n\n\n\n\n\nDevice mismatch typically follows Gaussian distributions and depends on device size and spacing (see Pelgrom, Duinmaijer, and Welbers 1989). For our purpose in this module, we will not expand upon the detailed theory behind this and instead consider only approximate numerical ranges that are typical for a technology as the one assumed in this module (see Table 5.4).\n\nPelgrom, M. J. M., A. C. J. Duinmaijer, and A. P. G. Welbers. 1989. “Matching Properties of MOS Transistors.” IEEE Journal of Solid-State Circuits 24 (5): 1433–39.\n1 This tends to hold true for technologies with feature sizes above 100 nm. For nano-scale devices, device mismatch can be comparable to process spread.At first glance, we see from Table 5.4 that device mismatches are typically much smaller than global process variations.1 For instance, the nominal threshold voltage for n-channel transistors can vary by ±200mV from fabrication run to fabrication run. However, within a specific fabrication outcome, the random threshold mismatch between two n-channels on the same chip is on the order of 10 mV.\nThis observation has a profound impact on the way integrated circuits are architected. That is, designers will usually try to exploit the fact that the components on the same chip show good matching. This contrasts with printed circuit board (PCB) design, where the designer often cannot rely on good matching between the available discrete components. Instead, PCB design can offer certain components with very high absolute accuracy across fabrication lots, such as 1%-precise resistors. As we know from Table 5.2, such levels of absolute accuracy are usually not available in an integrated circuit.\nA classical example that exploits transistor matching is the so-called current mirror. This circuit is ubiquitous in integrated circuits, but infrequently used in PCB circuits. We will now analyze the current mirror as a first example of a biasing circuit that is insensitive to process variations",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Biasing Circuits</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.5.html#sec-5-3",
    "href": "contents/partI/partI.5.html#sec-5-3",
    "title": "5  Biasing Circuits",
    "section": "5.3 Current Mirrors",
    "text": "5.3 Current Mirrors\nAs we have seen in previous chapters, we would like to use current sources to setup the bias points for CS, CG, and CD stages. While we could in principle design individual, stand-alone current-source circuits each time we need a bias current, it is instead customary to work with only one (or a few) reference current generators on a given chip and “mirror” its current to the various locations where a bias current is needed. This is sketched out in Figure 5.1: a single reference current generator is used to feed a distribution network of current mirrors (to be discussed in this section), which then supplies bias currents to various circuit stages in a given chip or large sub-block.\nIn this section, we will discuss and analyze current mirror circuits at various levels of detail. We will begin by considering the most basic structure and perform a first-order analysis for this circuit. Next, we consider second-order error sources and look at an improved realization that invokes the cascode structure introduced in Section 4-5-1.\n\n5.3.1 First-Pass Analysis of the Basic Current Mirror\nFigure 5.3 shows the most basic realization of a current mirror using two identically sized n-channel MOSFETs. The circuit takes an input current \\(I_{IN}\\) and produces an output current \\(I_{OUT}\\). Neglecting channel-length modulation for the time being, we can compute the gate-source voltage of \\(M_1\\) using:\n\\[\nV_{GS1} = V_{IN} = V_{Tn} + \\sqrt{\\dfrac{2 I_{IN}}{\\mu_n C_{ox} \\dfrac{W}{L}}}\n\\tag{5.1}\\]\n\n\n\n\n\n\nFigure 5.3: Basic current mirror.\n\n\n\nSince the gates and sources of the two MOSFETs are connected, we see that \\(V_{GS2}\\) = \\(V_{GS1}\\), and therefore:\n\\[\n\\frac{I_{OUT}}{I_{IN}} = \\frac{I_{D2}}{I_{D1}} = \\\\\n\\frac{\\frac{1}{2}\\mu _n C_{ox}\\frac{W}{L}\\Bigl(V_{GS2} - V_{Tn}\\Bigr)^2}{\\frac{1}{2}\\mu _n C_{ox}\\frac{W}{L}\\Bigl(V_{GS1} - V_{Tn}\\Bigr)^2} = 1\n\\tag{5.2}\\]\nThus, the output current equals the input current (to first-order). In essence, the function of \\(M_1\\) is to “compute” the gate-source voltage required for \\(M_2\\) to supply the same current that is injected into \\(M_1\\).\nOne important feature of this circuit is that it is immune to global process variations. From Equation 5.2, we see that absolute changes in \\(V_{Tn}\\) and \\(\\mu _n C_{ox}\\) that are common to \\(M_1\\) and \\(M_2\\) do not affect the current ratio. The circuit is affected only by mismatches in these parameters. However, as we have seen in Section 5.2.2, parameter mismatch tends to be small in integrated circuits.\n\n\n\n\n\n\nFigure 5.4: Application of the basic current mirror in a common-source amplifier.\n\n\n\nFigure 5.4 shows an application example of the basic current mirror in a p-channel common-source amplifier. This example is useful for identifying some general design objectives:\n\nWe want to minimize the error in \\(I_{OUT}\\) so that the bias current of the common-source device is accurately set (see also Section 2-2-8).\nWe want to minimize the voltage that is needed to keep \\(M_2\\) in saturation (to allow for a large signal swing). We call this minimum voltage level the compliance voltage, \\(V_{OUTmin}\\).\nWe want to minimize the capacitance \\(C_{out}\\) that the current mirror contributes to the output node of the amplifier. This will help maximize the circuit’s bandwidth.\nWe want to maximize \\(R_{out}\\), the resistance looking into \\(M_2\\). A small \\(R_{out}\\) can substantially reduce the voltage gain of the circuit in some use cases.\nLastly, it is desirable to scale the mirror’s branch currents, that is, we want \\(I_{OUT} = K \\cdot I_{IN}\\), where typically \\(K &gt; 1\\). This helps reduce the overall current consumption of the circuit and provides flexibility in adjusting the current values within a larger distribution network.\n\nThese objectives tend to hold in general for all types of current mirror implementations and we will keep them in mind as we progress through the remaining subsections. For the time being, let us look into the scaling of branch currents. Essentially, we would like to accomplish\n\\[\n\\frac{I_{OUT}}{I_{IN}} = \\frac{I_{D2}}{I_{D1}} = \\\\\n\\frac{\\frac{1}{2}\\mu _n C_{ox}\\frac{W_2}{L_2}\\Bigl(V_{GS2} - V_{Tn}\\Bigr)^2}{\\frac{1}{2}\\mu _n C_{ox}\\frac{W_1}{L_1}\\Bigl(V_{GS1} - V_{Tn}\\Bigr)^2} = K\n\\tag{5.3}\\]\nwhere \\(K\\) is the current scaling factor. From the above expression, assuming that \\(V_{Tn}\\) and \\(\\mu _n C_{ox}\\) are exactly equal for both transistors, it follows that \\(K = (W_2/L_2)/(W_1/L_1)\\). Thus, current scaling can be conveniently realized by scaling the MOSFETs’ aspect ratios.\nIn practice, several guidelines exist on how exactly this scaling should be implemented. The first and most important guideline is that we should always maintain \\(L_1\\) = \\(L_2\\); the current scaling should be realized by scaling the widths rather than the lengths of the channels. This is preferable since the current in a modern MOSFET does not accurately scale with \\(1/L\\). As already mentioned in Chapter 2, the \\(1/L\\) proportionality in our equations is essentially due to the simplified physical model that we used in the derivation of the square-law expressions. For the 1-μm technology assumed in this module, the deviation from the square law model is not as severe as for today’s sub-100-nm transistors but still significant enough to avoid length scaling in current mirrors. Now, with \\(L_1 = L_2\\), the current scaling factor is simply \\(K = W_2/W_1\\), to first-order. In the next section, we will look at various second-order effects that cause \\(K\\) to deviate from the width ratio of the MOSFETs.\n\n\n5.3.2 Second-Pass Analysis of the Basic Current Mirror\nThere exist several error sources in a current mirror that will affect its scaling factor. In general, we classify these error sources into two categories: systematic and random errors. Examples of systematic errors are\n\nErrors in transistor width ratios, for example due to mask misalignment or systematic etching imperfections.\nDifferences in the drain-source voltages between \\(M_1\\) and \\(M_2\\), leading to current deviations caused by channel length modulation.\nDifferences in the source potentials of \\(M_1\\) and \\(M_2\\) due to finite resistance in the interconnect (so-called “IR drop”).\n\nExamples of random errors are\n\nRandom mismatches in device geometries, for example due to line edge roughness.\nRandom mismatch in the transistors’ threshold voltage or transconductance parameter.\n\nIn order to attain the best possible accuracy in a current mirror, the IC designer will typically try to minimize the impact of all of these errors. We will therefore analyze some of the most important effects and countermeasures in the following paragraphs. For simplicity, our analysis will consider each effect separately. Ultimately, however, the sum of all errors must be considered in practice.\n    To analyze the impact of systematic masking or etching errors, consider the specific example of a current mirror with a desired current ratio of two and a layout as shown in Figure 5.5. Here \\(M_2\\) is drawn twice as wide as \\(M_1\\) In an ideal situation, this would yield \\(K = 2\\) based on the first order result of the previous subsection. In a typical IC process, however, masking or etching errors can lead to a systematic error in the width of a MOSFET, indicated as ∆W in the shown layout. With this error, and neglecting any other imperfections for simplicity, we have\n\\[\nK = \\frac{I_{OUT}}{I_{IN}} = \\frac{2 W_1 + \\Delta W}{W_1 + \\Delta W} = \\dfrac{2 + \\dfrac{\\Delta W}{W_1}}{1 + \\dfrac{\\Delta W}{W_1}} \\approx 2 - \\dfrac{\\Delta W}{W_1}\n\\tag{5.4}\\]\nwhere the final approximation follows from a first-order Taylor expansion and holds for \\(\\Delta W / W_1 &lt;&lt; 1\\).\n\n\n\n\n\n\nFigure 5.5: Layout of a current mirror with a desired current ratio of two.\n\n\n\n    Especially for small transistors, the error term in Equation 5.4 can be significant. Therefore, it has become customary to adopt layout styles that eliminate issues due to ∆W altogether. In the improved layout of Figure 5.6, \\(M_2\\) is formed using two unit devices whose layout is identical to that of \\(M_1\\). In this case,\n\\[\nK = \\frac{I_{OUT}}{I_{IN}} = \\frac{2 W_1 + \\Delta W}{W_1 + \\Delta W} = 2\n\\tag{5.5}\\]\nand thus the circuit is insensitive to systematic width errors. Note that the idea of working with unit devices can be extended such that \\(P\\) unit devices are used for \\(M_2\\) and \\(Q\\) unit devices are used to form \\(M_1\\) This means that the mirror ratio \\(K = P/Q\\) is restricted to rational numbers.\n\n\n\n\n\n\nFigure 5.6: Improved layout of a current mirror with a desired current ratio of two.\n\n\n\n\n\n\n\n\n\nFigure 5.7: Layout of a current mirror with shared drain regions.\n\n\n\nA variant of the improved unit-device layout is shown in Figure 5.7. Here, the two unit transistors share a single drain region at the output node and therefore have a smaller output capacitance (\\(C_{out}\\) in Figure 5.4). This general idea is often applied when small \\(C_{out}\\) is desired in the particular use case of the current mirror. One disadvantage of the layout in Figure 5.7 is that the source/drain orientation of the rightmost channel are flipped. This can lead to residual systematic errors in process technologies that suffer from source/drain asymmetries. However, it can be shown that this error vanishes when an even number of unit devices are used for both \\(M_1\\) and \\(M_2\\) These and many other considerations are part of the knowledge base of experienced analog designers. The reader is referred to advanced literature on this topic for further information.\n\n\n\n\n\n\nFigure 5.8: Mirror error due to differences in drain-source voltage.\n\n\n\nAnother significant source of error in the current mirror ratio can result from differences in the voltages at the input and output nodes of the mirror. To see this, consider the current mirror example in Figure 5.8, which is assumed to have perfectly matched transistors of the same size. Even though the two transistors have identical output curves, their drain currents will differ whenever the input and output voltages do not match. Mathematically, we can analyze this effect by including channel-length modulation in the analysis. Specifically, since\n\\[\nI_{IN} = \\frac{1}{2}\\mu _n C_{ox}\\frac{W}{L}\\Bigl(V_{GS1} - V_{Tn}\\Bigr)^2 (1 + \\lambda _n V_{IN})\n\\tag{5.6}\\]\nand\n\\[\nI_{OUT} = \\frac{1}{2}\\mu _n C_{ox}\\frac{W}{L}\\Bigl(V_{GS1} - V_{Tn}\\Bigr)^2 (1 + \\lambda _n V_{OUT})\n\\tag{5.7}\\]\nwe have\n\\[\n\\frac{I_{OUT}}{I_{IN}} = \\frac{1 + \\lambda _n V_{OUT}}{1 + \\lambda _n V_{IN}}\n\\tag{5.8}\\]\nFrom this result, we see that there are two ways to reduce errors in the current ratio. We can try to minimize the difference between \\(V_{OUT}\\) and \\(V_{IN}\\) as much as possible and/or reduce \\(\\lambda_n\\) by using long-channel MOSFETs. Note also that reducing λn is equivalent to reducing the small-signal output conductance \\(g_o\\), which is simply the slope of the I-V curves in Figure 5.8 The smaller this slope, the smaller the difference between \\(I_{OUT}\\) and \\(I_{IN}\\).\nExample 5-2: Current Mirror Error Due to Drain-Source Voltage Difference\nConsider the current mirror in Figure 5.8 . Assume \\(V_{OUT}\\) = 2.5 V and that the MOSFET width is chosen such that \\(V_{IN}\\) = 1.5 V. Calculate the percent error in the current ratio for L = 1 μm and L = 3 μm.\nSOLUTION\nFor L = 1 μm, we have $_n $ = 0.1 \\(V^{-1}\\) [seeEq.(2.44)]. Using Equation 5.8, we find in this case\n\\[\n\\frac{I_{OUT}}{I_{IN}} = \\frac{1+ 0.1 V^{-1} \\cdot 2.5 V}{1+ 0.1 V^{-1} \\cdot 1.5 V} = 1.087\n\\tag{5.9}\\]\nThe error in the current ration is 8.7%. Repeating the above calculation for \\(L = 3\\mu m ( \\lambda _n = 0.033 V^{-1} )\\), the error reduces to 3.2%.\n    Another example of a systematic error source that we will consider here is the voltage drop in the source connection of the mirror devices (see Figure 5.9). In the shown circuits, we assume for simplicity that the two MOSFETs are identical and that \\(V_{OUT} = V_{IN}\\), i.e., there is no error due to \\(V_{DS}\\) differences.\n    First consider the circuit of Figure 5.9(a), which takes the finite wiring resistance (\\(R_{WIRE}\\)) between the source terminals of \\(M_1\\) and \\(M_2\\) into account. The wire will carry some current, which is at the minimum equal to the drain current of \\(M_1\\) flowing toward the ground node of the circuit. In a poorly constructed layout, the wire may also carry the current from another block (\\(I_X\\)) as shown. The total current in the wire is therefore \\(I_{WIRE} = I_{IN} + I_X\\) and \\(V_{WIRE} = I_{WIRE}⋅ R_{WIRE}\\). By applying KVL in Figure 5.9(a) we see that \\(V_{GS2} = V_{GS1} + V_{WIRE}\\). Therefore, we can use the equivalent model of Figure 5.9(b) for further analysis.\n    Now, assuming that \\(V_{WIRE}\\) is relatively small, we can think about this voltage as a small-signal perturbation around the operating point of \\(M_2\\) (\\(I_{D2} = I_{OUT} = I_{IN}\\)). Therefore, we can write\n\\[\nI_{OUT} = I_{IN} + g_m V_{WIRE}\n\\tag{5.10}\\]\nand\n\\[\n\\frac{I_{OUT}}{I_{IN}} = 1 + \\frac{g_m}{I_{IN}}  V_{WIRE} =\n1 + 2 \\frac{V_{WIRE}}{V_{OV}}\n\\tag{5.11}\\]\nwhere \\(g_m\\) and \\(V_{OV}\\) are the transconductance and quiescent point gate overdrive (\\(V_{GS} – V_{Tn}\\)) of the MOSFETs, respectively. To see that this error source can be quite significant, consider the case of \\(V_{OV} = 200 mV\\) and \\(V_{WIRE} = 10 mV\\). The resulting error in the mirror ratio is 10%. In practice, the designer will mitigate voltage drop issues by (1) minimizing the distance between \\(M_1\\) and \\(M_2\\) (to minimize \\(R_{WIRE}\\)), (2) avoid any excess current (\\(I_X\\)) in the source connection between \\(M_1\\) and \\(M_2\\) , and (3) work with reasonably large gate overdrive voltages (\\(V_{OV}\\)) in current mirrors.\n\n\n\n\n\n\nFigure 5.9: Mirror error due to voltage drop in the source connection.\n\n\n\nAs a final step in this subsection, let us now consider a few examples of random mismatch effects in current mirrors, and specifically mismatch in the transistors’ threshold voltages and transconductance parameters. The case of threshold voltage mismatch can be modeled exactly as shown in Figure 5.9(b), but \\(V_{WIRE}\\) is now replaced with \\(\\Delta V_{Tn}\\), the threshold voltage mismatch between \\(M_1\\) and \\(M_2\\). Therefore, we can write in this case\n\\[\n\\frac{I_{OUT}}{I_{IN}} = 1 + 2 \\frac{\\Delta V_{Tn}}{V_{OV}}\n\\tag{5.12}\\]\nThe conclusion from this expression is similar to what we have already stated above. To minimize errors due to threshold voltage mismatch, the designer must work with reasonably large values of \\(V_{OV}\\). Since \\(\\Delta V_{Tn} \\approx 10 mV\\) is not unusual in CMOS technology (see Section 5.2.2), it follows that it is rather difficult to guarantee highly accurate mirror ratios. Even if we make \\(V_{OV} = 1 V\\), the corresponding error is still 2%. For the case of transconductance parameter mismatch, we can write\n\\[\n\\frac{I_{OUT}}{I_{IN}} =\n\\frac{\\frac{1}{2}(\\mu _n C_{ox})_2\\frac{W}{L}\\Bigl(V_{GS2} - V_{Tn}\\Bigr)^2}{\\frac{1}{2}(\\mu _n C_{ox})_1\\frac{W}{L}\\Bigl(V_{GS1} - V_{Tn}\\Bigr)^2} =\n\\frac{(\\mu _n C_{ox})_2} {(\\mu _n C_{ox})_1}{}\n\\tag{5.13}\\]\nwhere \\((\\mu _n C_{ox})_{1,2}\\) are the transconductance parameters of the two MOSFETs, and all other parameters are assumed to be equal. Thus, for typical mismatch in the transconductance parameter on the order of 1% (see Section 5.2.2), it is often the case that this particular error is overshadowed by mismatches in the MOSFETs’ threshold voltages.\n\n\n5.3.3 Multiple Current Sources and Sinks\nThe basic current mirror concept discussed so far can be utilized to provide multiple current outputs that either source a current from \\(V_{DD}\\) or sink a current into ground. A circuit that uses p-channel devices to create multiple currents sourced from \\(V_{DD}\\) is shown in Figure 5.10.\n\n\n\n\n\n\nFigure 5.10: PMOS current mirror with multiple outputs.\n\n\n\nIf we also require current sinks, the circuit approach shown in Figure 5.11 can be used. Here, the output current from device \\(M_1\\) is used as a reference current for the n-channel mirror composed of \\(M_1\\) and \\(M_2.\\) Note that a direct application for this circuit would be the CS-CD amplifier of Figure 4-28; it requires one current source from \\(V_{DD}\\) and one current sink.\n\n\n\n\n\n\nFigure 5.11: Circuit to produce a current source \\(M_2\\) and current sink \\(M_4\\).\n\n\n\nNeglecting all error terms, and assuming equal channel lengths, the value of the DC current \\(I_{OUT1}\\) is equal to\n\\[\nI_{OUT1} = \\frac{W_1}{W_R} I_{REF}\n\\tag{5.14}\\]\nFrom this current we have derived a current source and current sink with devices \\(M_2\\) and \\(M_4\\). Ideally, these currents are\n\\[\nI_{OUT2} = \\frac{W_2}{W_R} I_{REF}\n\\tag{5.15}\\]\n\\[\nI_{OUT4} = \\frac{W_4}{W_R} I_{OUT1} = \\Bigl( \\frac{W_4}{W_3} \\cdot \\frac{W_1}{W_R} \\Bigr) I_{REF}\n\\tag{5.16}\\]\nExample 5-3: Current Sources/Sinks\nDesign current sources with DC current values of 10 μA and 20 μA and current sinks with DC current values of 10 μA and 40 μA. The small-signal source resistance of all current sources and sinks should be at least 1 MΩ. The compliance voltage of both current sources and sinks must be less than 0.5 V. You are given one reference current source of 10 μA with which you can derive the others.\nSOLUTION\nA suitable topology for this design is shown in Figure 5.12. We begin this design by realizing that in order to meet the compliance voltage requirement, we need \\(V_{GS} = V_{SG} \\leq 1 V.\\) This defines the value of \\((W/L)_R\\).\n\n\n\n\n\n\nFigure 5.12: Ex5-3\n\n\n\n\\[\nV_{GS} = V_{Tn} + \\sqrt{\\frac{I_{REF}}{\\frac{1}{2} \\mu_ n C_{ox} \\frac{W}{L}}} \\Rightarrow \\Bigl(\\frac{W}{L} \\Bigr)_R = 1.6\n\\]\nIf we set \\((W/L)_1 = (W/L)_2 = 1.6,\\) then \\(I_{D1} = I_{D2} = 10 \\mu A.\\) To make \\(I_{D3} = 40 \\mu A,\\) let \\((W/L)_3 = 4(W/L)_2 = 6.4.\\) The p-channel devices are sized the same way.\n\\[\nV_{SG} = 1 V = -V_{Tp} + \\sqrt{\\frac{I_{REF}}{\\frac{1}{2} \\mu_ p C_{ox} \\frac{W}{L}}} \\Rightarrow \\Bigl(\\frac{W}{L} \\Bigr)_4 = 3.2\n\\]\nTo make \\(I_{D5} = 10 \\mu A\\) and \\(I_{D6} = 20 \\mu A\\) , we use \\((W/L)_5 = 3.2\\) and \\((W/L)_6 = 6.4.\\)\nNow we can check the small-signal source resistances. For \\(I_D = 10 \\mu A\\) and \\(λ_n = λ_p = 0.1 μmV^{-1}/L\\), minimum length \\(L = 1 μm\\) will already satisfy the requirement of \\(r_o = 1 MΩ\\). For \\(I_D = 20 μA\\), we need \\(L=2μm\\) and for \\(I_D=40μA\\), we need \\(L=4μm\\). Since we want all of the n-channels to have the same length, and all of the p-channels to have the same length, we arrive at the following design choice (all values in μm): \\((W/L)_R = (W/L)_1 = (W/L)_2 = 6.4/4\\) and \\((W/L)_3 = (4 \\times 6.4)/4\\). For the p-channels: \\((W/L)_4 = (W/L)_5 = 6.4/2\\), and \\((W/L)_6 = (2 \\times 6.4)/2\\). As indicated through the multipliers, the layout of \\(M_3\\) and \\(M_6\\) should consist of multiple unit devices.\n\n\n5.3.4 Cascode Current Mirror\nAs we have seen in the previous subsection, the accuracy of the current ratio in the basic current mirror is affected by a number of undesired effects. The cascode current mirror discussed in this section improves on a subset of these issues. Specifically, as we shall see, it is less sensitive to differences between \\(V_{IN}\\) and \\(V_{OUT}\\) and correspondingly also provides a much larger output resistance (\\(R_{out}\\)).     The most basic realization of a cascode current mirror is shown in Figure 5.13(a). The output branch of this circuit stacks two MOSFETs in a cascode configuration (see Section 4-5-1). To compute the output resistance of this circuit, we consider the small-signal model of the circuit in Figure 5.13(b).\n\n\n\n\n\n\nFigure 5.13: Basic cascode current mirror. (a) Complete circuit. (b) Small-signal circuit model for the output branch.\n\n\n\nNote that this circuit resembles the common-gate model of Figure 4-9, with \\(r_s\\) replaced by \\(r_{o1},\\) which is the output resistance of the bottom transistor \\(M_1\\). Consequently, \\(R_{out}\\) is given by Eq. (4.21), which is repeated here with the proper variable substitutions (\\(r_s → r_{o1}, r_o→r_{o2}\\) and \\(g'_m → g'_{m2}\\), where \\(g'_{m2}= g_{m2} + g_{mb2}\\))\n\\[\nR_{out} \\approx r_{o2}[1 + g'_{m2} r_{o1}] \\approx r_{o2}g'_{m2}r_{o1}\n\\tag{5.17}\\]\nThus, the output resistance of this structure is very large, which implies that any changes in the output voltage will not affect the output current significantly. Mathematically, we can view any disturbance in \\(V_{OUT}\\) as a small signal quantity, \\(v_{out}\\). The resulting disturbance in the output current, \\(i_{out}\\) is simply \\(v_{out}/R_{out}\\), which is small for large \\(R_{out}\\).\n    Even though we know that \\(R_{out}\\) is large from the above quantitative result, it is useful to develop a qualitative feel for why this must be the case. To investigate, Figure 5.14 shows the output branch of the cascode current mirror for further inspection.\n\n\n\n\n\n\nFigure 5.14: Qualitative inspection of the output branch in a cascode current mirror.\n\n\n\nIn this drawing, we apply an output perturbation and consider the voltage swing at the drain of \\(M_1\\). Since the resistance at the drain node of \\(M_1\\) is low (\\(\\approx 1/g'_{m2}\\)), the output voltage perturbation appears highly attenuated at this node (the attenuation is approximately given by the ratio of \\(1/g'_{m2}\\) and \\(r_{o2}\\)). Consequently, the drain current of \\(M_1\\), which is equal to the output current, sees only a very small voltage perturbation. In essence, \\(M_2\\) shields the current mirror transistor \\(M_1\\) from the output disturbance; the drain voltage of \\(M_1\\) is “pinned” by the low-resistance node created by \\(M_2\\).\n\n\n\n\n\n\nShielding effect of the cascode\n\n\n\n\n\n\n\n\n(a) cascode with voltage perturbation applied at its output (b) & (c) equivalent small signal model\n\n\n\n\nApplying KCL we can write \\[\n\\frac{\\Delta V_{out} - \\Delta V_{d1}}{r_{o2}} - g'_{m2} \\cdot \\Delta V_{d1} = \\frac{\\Delta V_{d1}}{r_{o1}}\n\\] \\[\n\\frac{\\Delta V_{out} - \\Delta V_{d1}}{r_{o2}} = \\Delta V_{d1} \\cdot \\Bigl( g'_{m2} + \\frac{1}{r_{o1}}\\Bigr)\n\\] for \\(g'_{m2} r_{o1} \\gg 1\\): \\[\n\\frac{\\Delta V_{out} - \\Delta V_{d1}}{r_{o2}} \\approx \\Delta V_{d1} \\cdot g'_{m2}\n\\] The equation above describes a voltage divider between \\(r_{o2}\\) and \\(1/g'_{m2}\\)\n\n\n\n\n\n(c) voltage divider between \\(r_{o2}\\) and \\(1/g'_{m2}\\)\n\n\n\n\n\n\n    While the circuit in Figure 5.13 is insensitive to changes in \\(V_{OUT}\\), it is important to realize that any difference in the drain voltages of \\(M_1\\) and \\(M_3\\) will still lead to a (potentially large) systematic error. Similar to Equation 5.8, we can write\n\\[\n\\frac{I_{OUT}}{I_{IN}} = \\frac{I_{D1}}{I_{D3}} = \\frac{1+\\lambda _n V_{DS1}}{1+\\lambda _n V_{DS3}}\n\\tag{5.18}\\]\nFor this reason, the circuit is purposely constructed such that nominally \\(V_{DS1} = V_{DS3}.\\) Assuming that \\(I_{OUT} = I_{IN}\\) and that \\(M_2\\) and \\(M_4\\) are identical, applying KVL to the circuit of Figure 5.13 reveals\n\\[\nV_{D1} = V_{D3} + V_{GS4} - V_{GS2} = V_{D3}\n\\tag{5.19}\\]\nThus, the circuit of Figure 5.13 effectively eliminates this important shortcoming of the basic current mirror.\n\n\n\n\n\n\nFigure 5.15: Analysis of the compliance voltage in the basic cascode current mirror.\n\n\n\nUnfortunately, the benefits of the cascode current mirror do not come for free. Specifically, notice that the circuit’s output compliance voltage (\\(V_{OUTmin}\\) is significantly larger than that of a basic current mirror. In a basic current mirror (Figure 5.3), we have \\(V_{OUTmin} = V_{DSsat2} = V_{OV2}\\), which is the gate overdrive voltage of the MOSFET in the output branch. For the cascode current mirror, we can investigate the situation by considering Figure 5.15, which graphically illustrates all voltage levels and voltage drops. Here, we assume for simplicity that all threshold (\\(V_{Tn}\\)) and gate overdrive voltages (\\(V_{OV}\\)) are identical. With this assumption, the voltage at the drain of \\(M_1\\) is \\(V_{Tn} + V_{OV}\\). This implies that \\(M_1\\) will always be in saturation, since the drain-source voltage exceeds \\(V_{OV}\\) by some margin (equal to \\(V_{Tn}\\)). In order for \\(M_2\\) to operate in saturation, we require\n\\[\nV_{DS2} = V_{OUT} - (V_{Tn} + V_{OV}) &gt; V_{DSsat2} = V_{OV}\n\\tag{5.20}\\]\nand thus\n\\[\nV_{OUT} &gt; V_{Tn} + 2 V_{OV}\n\\tag{5.21}\\]\nwhich means \\(V_{OUTmin} = V_{Tn} + 2V_{OV}\\). Note that for typical values of \\(V_{OV}\\) and \\(V_{Tn}\\), the compliance voltage of the cascode current mirror can become quite large, e.g., 0.5 V + 1 V = 1.5 V, taking away a significant amount of signal swing from the available voltage supply range (consider for example Figure 5.4).\n\n\n5.3.5 The High-Swing Cascode Current Mirror\nIn applications where the large compliance voltage of the circuit in Figure 5.13 is problematic, an alternative scheme, called high swing cascode current mirror can be used. We will develop this circuit from the previous solution using a few intermediate steps.\n    First, consider the output branch of a cascode current mirror as shown in Figure 5.16. In the annotation of this circuit, it is assumed that \\(V_{G2}\\) is set up such that \\(M_1\\) operates at the edge of saturation, i.e., \\(V_{DS} = V_{DSsat} = V_{OV}\\). In this case, we require\n\\[\nV_{OUT} - V_{OV} &gt; V_{DSsat2} = V_{OV}\n\\tag{5.22}\\]\nand thus\n\\[\nV_{OUT} &gt; 2 V_{OV}\n\\tag{5.23}\\]\nwhich means \\(V_{OUTmin} = 2V_{OV}\\), corresponding to a substantial improvement over Equation 5.21.\n\n\n\n\n\n\nFigure 5.16: Desired output branch biasing to achieve the minimum possible compliance voltage.\n\n\n\nThe question that remains is how exactly \\(V_{G2}\\) should be generated to achieve this improvement. To investigate, we first compute the required value of \\(V_{G2}\\) by applying KVL in Figure 5.16\n\\[\nV_{G2} - V_{DS1} + V_{GS2} = V_{Tn} + 2V_{OV}\n\\tag{5.24}\\]\nIt turns out that many options exist for setting \\(V_{G2}\\) to the above-calculated value. The most basic option is shown in Figure 5.17. Here, an extra current branch is introduced to bias the added transistor \\(M_6\\). In a practical implementation, this current typically originates from an extra branch added to a PMOS current mirror in the overall biasing network. The key idea in this setup is that \\(M_6\\) is sized to one-quarter the width used for \\(M_2.\\)\n\n\n\n\n\n\nFigure 5.17: Basic circuit for cascode voltage generation.\n\n\n\nWith this sizing, we have\n\\[\n\\begin{split}\nV_{G2} &= V_{GS6} = V_{Tn} + \\sqrt{\\frac{2 I_{D6}}{\\mu _n C_{ox} \\frac{W/4}{L}}} \\\\\n&= V_{Tn} + 2 \\sqrt{\\frac{2 I_{OUT}}{\\mu _n C_{ox} \\frac{W}{L}}} = V_{Tn} + 2 V_{OV}\n\\end{split}\n\\tag{5.25}\\]\nwhich achieves the desired objective.\n    In practice, the designer will usually not want to bias \\(M_1\\) exactly at the edge of saturation, but rather leave some margin. This can be achieved by sizing the width ratio smaller than 1/4. Table 5.5 shows the resulting margins for a few integer ratios. Choosing a sizing ratio of 1/6 often yields a reasonable compromise between compliance voltage and circuit robustness in a practical circuit.\n\n\n\nTable 5.5: \\(V_{DS1}\\) as a function of the ratio \\(k = W_6/W_2\\) in the circuit of Figure 5.18.\n\n\n\n\n\n\n\n\n\n\n\\(\\mathbf{k = W_6/W_2}\\)\n \n\\(\\mathbf{V_{DS1}}\\)\n \n\\(\\mathbf{ V_{DS1} - V_{OV}}\\)\n(Margin)\n\n\n\n\n1/4\n\\(V_{OV}\\)\n0\n\n\n1/5\n1.24 \\(V_{OV}\\)\n0.24 \\(V_{OV}\\)\n\n\n1/6\n1.45 \\(V_{OV}\\)\n0.45 \\(V_{OV}\\)\n\n\n1/7\n1.64 \\(V_{OV}\\)\n0.64 \\(V_{OV}\\)\n\n\n1/8\n1.83 \\(V_{OV}\\)\n0.83 \\(V_{OV}\\)\n\n\n1/9\n2 \\(V_{OV}\\)\n\\(V_{OV}\\)\n\n\n\n\n\n\nIn order to complete the high-swing cascode current mirror circuit, we still need to design the circuit’s input branch. The most obvious (but non-preferred) solution for the input branch is shown in Figure 5.18(a).\n\n\n\n\n\n\nFigure 5.18: High-swing cascode current mirror with input branch included. (a) Non-preferred solution that suffers from a systematic mirror ratio error. (b) Solution that avoids the systematic mirror ratio error.\n\n\n\nThis circuit suffers from the problem that \\(V_{DS1} ≠ V_{DS3}\\), and therefore a systematic error is introduced in the mirror ratio (see Equation 5.18). An elegant solution to this problem is shown in Figure 5.18(b), where \\(M_4\\) has been added to replicate the gate-source voltage drop of \\(M_2\\), such that \\(V_{DS1} = V_{DS3}\\). Just as in the circuit of Figure 5.18(a), the gate voltage of \\(M_3\\) self-adjusts to the point where \\(M_3\\) carries the injected current (\\(I_{IN}\\)). \\(M_4\\) merely acts as a current buffer, passing all of the input current to \\(M_3\\).\n    The final circuit of Figure 5.18(b) has been widely used in practice and is insensitive to process variations, such as global shifts in threshold voltage, Nonetheless, there are two remaining issues with this circuit that are worth mentioning. First, it is sometimes inconvenient to provide the extra current source used to bias \\(M_6\\). Problems P5.5 and P5.6 look into alternative solutions that do not require an extra input current source, but still achieve low compliance voltage in the output branch.     The second issue stems from the backgate effect. In our analysis above, we have neglected the fact that the threshold voltage of \\(M_2\\) will be larger than that of \\(M_6\\). This is because the source of \\(M_6\\) is connected to ground (and thus \\(V_{SB6} = 0\\)), while the source potential of \\(M_2\\) is positive (and thus \\(V_{SB2} &gt; 0\\)). As a result, assuming a sizing ratio of 1/4, \\(V_{DS1}\\) is more accurately given by\n\\[\n\\begin{split}\nV_{DS1} &= V_{GS6} - V_{GS2} \\\\\n&= V_{Tn0} + 2 V_{OV} - \\Bigl[ V_{Tn}(V_{SB2}) + V_{OV}\\Bigr] \\\\\n&= V_{OV} - \\Bigl[V_{Tn}(V_{SB2}) - V_{OV}\\Bigr] = V_{OV} - \\Delta V_{Tn}\n\\end{split}\n\\tag{5.26}\\]\nwhere \\(\\Delta V_{Tn}\\) is a positive quantity that causes \\(M_1\\) to enter the triode region, unless sufficient margin is provided. In practice, the designer can use computer simulations to ensure that sufficient saturation margin is guaranteed. Another option is to change the circuit to mitigate this problem at its root. The thought process that leads to the alternate solution is illustrated in Figure 5.19.\n\n\n\n\n\n\nFigure 5.19: Conceptual steps for replacing the W/4 cascode biasing device with a two-transistor compound circuit\n\n\n\nThe biasing transistor \\(M_6\\), as discussed previously, is redrawn in isolation in Figure 5.19(a). Figure 5.19(b) shows an equivalent circuit that breaks \\(M_6\\) into four transistors, each with an aspect ratio of W/L. Assuming that the ideal square law model holds, the series connection of these transistors behaves like a MOSFET with aspect ratio of W/(4L), or (W/4)/L (see Problem P2.2).\nConsequently, \\(V_{G2}\\) must be equal to \\(V_{Tn} + 2V_{OV}\\), as in the original circuit of Figure 5.19(a). Furthermore, notice that the transistor \\(M_{6a}\\) in Figure 5.19(b) must operate in the saturation region (since it is diode-connected). This means that this MOSFET’s gate-source voltage is equal to \\(V_{Tn} + V_{OV}\\), and the potential at its source node is equal to \\(V_OV\\).\n    Next, in Figure 5.19(c), the three bottom transistors are lumped into a single device, again based on the argument that a device with an aspect ratio of W/(3L) can be replaced with one that has (W/3)/L. Note that the combined transistor (\\(M_{6b}\\) in Figure 5.19(c)) operates in the triode region, since its drain-source voltage (\\(V_{OV}\\)) is smaller than \\(V_{GS6b} – V_{Tn} = 2V_{OV}\\). Of course, all of the above conceptual arguments can be validated quantitatively, by carrying out a first-principle analysis using MOSFET I-V equations.\n    The main advantage of the circuit in Figure 5.19(c) becomes apparent when it is inserted back into the cascode current mirror, as shown in fig-5.18. Since \\(M_{6a}\\) has the same W/L and carries the same current as \\(M_2\\), the source potential of these transistors is identical (neglecting channel length modulation). Hence, the error term due to backgate effect that we saw in Equation 5.26 is suppressed, since \\(V_{SB2} = V_{SB6a}\\).\n\\[\n\\begin{split}\nV_{DS1} &= V_{DS6b} + V_{DS6a} - V_{GS2} \\\\\n&= V_{OV} + V_{Tn}(V_{SB6a}) + V_{OV} -\\Bigl[ V_{Tn}(V_{SB2}) + V_{OV}\\Bigr] \\\\\n&= V_{OV}\n\\end{split}\n\\tag{5.27}\\]\nFinally, note that even though the circuit of Figure 5.20 provides a somewhat less error-prone setup for the generation of \\(V_{G2}\\), the designer will still want to leave margin and back off from the ideal W/3 sizing for \\(M_{6b}\\). Table 5.5 lists the margin for various integer choices larger than 3 (see also problem P5.4).\n\n\n\n\n\n\nFigure 5.20: Complete high-swing cascode current mirror using a triode device (\\(M_{6b}\\)) for cascode biasing.\n\n\n\nExample 5-4: Design of a Cascode Current Mirror\nThe cascode current mirror in Figure 5.20 is configured such that \\(I_{OUT} = I_{IN}\\). In this example, we wish to design a similar current mirror that sets \\(I_{OUT} = 4 I_{IN} = 400 μA\\). \\(M_1\\) and \\(M_2\\) are to be sized such that \\(V_{OV} = 200 mV\\) and using a channel length of 2 μm. \\(M_{6b}\\) should be sized such that m = 5. Given these specifications, determine all transistor widths and node voltages. Also compute the circuit’s output compliance voltage and output resistance (\\(R_{out}\\)). Neglect channel-length modulation in bias point calculations.\n\n\n\nTable 5.6: \\(V_{DS1}\\) as a function of width scaling factor m for \\(W_{6b}\\) in Figure 5.20.\n\n\n\n\n\n\n\n\n\n\n\\(\\mathbf m\\)  \n\\(\\mathbf{V_{DS1}}\\)\n \n\\(\\mathbf{ V_{DS1} - V_{OV}}\\)\n(Margin)\n\n\n\n\n3\n\\(V_{OV}\\)\n0\n\n\n4\n1.24 \\(V_{OV}\\)\n0.24 \\(V_{OV}\\)\n\n\n5\n1.45 \\(V_{OV}\\)\n0.45 \\(V_{OV}\\)\n\n\n6\n1.64 \\(V_{OV}\\)\n0.64 \\(V_{OV}\\)\n\n\n7\n1.83 \\(V_{OV}\\)\n0.83 \\(V_{OV}\\)\n\n\n8\n2 \\(V_{OV}\\)\n\\(V_{OV}\\)\n\n\n\n\n\n\nSOLUTION\nThe width of \\(M_1\\) and \\(M_2\\) is found by solving\n\\[\nI_{OUT} = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} V_{OV}^2\n\\]\nfor W, and inserting the given numbers and technology parameters. This yields \\(W_1 = W_2 = 800 μm\\). To implement the current ratio \\(I_{OUT}/I_{IN} = 4\\), we require \\(W_3 = W_4 = W_{6a} = W_1/4 = 200μm\\) and \\(W_{6b} = W_{6a}/5 = 40 μm\\).\n    The voltage \\(V_{G1}\\) is simply \\(V_{Tn} + V_{OV} = 0.7 V\\). With m=5, we know from Table 5.6 that \\(V_{D1} = V_{D3} = V_{D6b} = 1.45 V_{OV} = 290 mV\\). To compute \\(V_{G2}\\) accurately, we must first estimate the threshold voltage of \\(M_{6a}\\) using\n\\[\nV_{Tn}(V_{SB}) = V_{T0n} + \\gamma _n \\cdot \\Bigl( \\sqrt{2 \\phi _f + V_{SB}} - \\sqrt{2 \\phi _f} \\Bigr)\n\\]\nEvaluating the above equation with \\(V_{SB6a} = V_{D6b} = 290 mV\\) gives \\(V_{T6a} = 590 mV\\). Therefore, \\(V_{G2} = 1.45 V_{OV} + V_{T6a} + V_{OV} = 1.08 V\\). The circuit’s output compliance voltage is \\(V_{OUTmin} = V_{D1} + V_{OV} = 0.49 V\\). The circuit’s output resistance is given by \\(R_{out} ≅ ro1⋅ g'_{m2}r_{o2}\\) (see Section 4-5-1). Therefore, we compute\n\\[\ng_{m2} = \\frac{2 I_{D2}}{V_{OV}} = \\frac{2 \\cdot 400 \\mu A}{200 mV} = 4 mS\n\\]\n\\[\n\\begin{split}\ng'_{m2} &= g_{m2} \\Bigl( 1 + \\frac{\\gamma _n}{2 \\sqrt{2 \\phi _f + V_{SB}}} \\Bigr) \\\\\n&= 4mS \\Bigl( 1 + \\frac{0.6 V^{-1}}{2 \\sqrt{0.8 V + 0.29 V}} \\Bigr) = 5.15 mS\n\\end{split}\n\\]\nand\n\\[\nr_{o1} \\approx r_{o2} \\approx \\frac{1}{ \\lambda _n I_{D1}} = \\frac{1}{ 0.05 V^{-1} \\cdot 400 \\mu A} = 500 k\\Omega\n\\]\nThese numbers lead to \\(R_{out} ≅ 12.88 MΩ\\). The schematic in Figure 5.21 summarizes the results obtained in this example.\n\n\n\n\n\n\nFigure 5.21: Ex5-4",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Biasing Circuits</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.5.html#sec-5-4",
    "href": "contents/partI/partI.5.html#sec-5-4",
    "title": "5  Biasing Circuits",
    "section": "5.4 Current References",
    "text": "5.4 Current References\nThe current mirror circuits discussed in the previous section are useful for replicating and distributing bias currents within a sub-circuit or an entire chip. Ultimately, however, the currents that are being distributed must originate from some form of a reference current generator (see Figure 5.1).     Over the years, a wide variety of current references have been developed, each having specific pros and cons for the intended application. Within the scope of this introductory module, we will consider only two examples, primarily as a starting point for further reading and to complete the picture on how a complete biasing network within a larger chip might be constructed. For a more comprehensive discussion, the reader is referred to advanced texts such as (Gray et al. 2009).\nWe begin by considering the most basic of all possible reference generator circuits, shown in Figure 5.22. This circuit is essentially a current mirror, with its input branch tied to the supply via a resistor.\n\n\n\n\n\n\nFigure 5.22: Simple supply-referenced current generator.\n\n\n\nIn this circuit, we have\n\\[\nI_{OUT} \\approx I_{IN} = \\frac{V_{DD} - V_{Tn} - V_{OV}}{R}\n\\tag{5.28}\\]\nFrom this result, noting that typically \\(V_{DD} \\gg V_{Tn}\\), and \\(V_{DD} \\gg V_{OV}\\), we see that the current is roughly proportional to the supply voltage. Given the variations in supply voltage that a robust circuit must withstand (see Table 5.1), this solution is often not suitable for all but relatively primitive and low-performance circuits. What we desire is a current generator that is (to first-order) insensitive to supply variations. The so-called self-biased constant-gm current generator discussed next is an example of an improved circuit that is frequently used in practice. To understand the self-biased constant-gm current generator, consider first the circuit shown in Figure 5.23(a).\n\n\n\n\n\n\nFigure 5.23: (a) Core building block of a constant-gm current generator. (b) Current transfer characteristics for various scenarios.\n\n\n\nThis is a current mirror-like circuit with a resistor \\(R\\) added in the source of \\(M_2\\). Assuming that \\(M_2\\) is scaled \\(m\\) times wider than \\(M_1\\), and letting \\(R = 0\\) for the time being, we know that \\(I_{OUT}\\) is approximately equal to \\(m ⋅ I_{IN}\\). This is illustrated using the dashed line (i) in the graph of Figure 5.23(b). Line (ii) is included for reference, corresponding to \\(m = 1\\), i.e., \\(I_{OUT} = I_{IN}\\). Now, assuming \\(m &gt; 1\\) and \\(R&gt;0\\), we know that \\(I_{OUT}\\) must be smaller compared to case (i) with \\(R = 0\\). This is because the voltage drop across \\(R\\) reduces the gate-source voltage of \\(M_2\\) and consequently results in smaller \\(I_{OUT}\\). As \\(I_{IN}\\) increases, \\(I_{OUT}\\) [curve (iii)] bends away further and further from line (i) and ultimately intersects with line (ii). While it is possible to derive a closed-form equation of this curve (see problem P5.7), we focus our attention on point P. A particularly interesting property of point P is that it defines an absolute current level that (to first-order) depends only on the MOSFET sizes and \\(R\\), i.e., it is independent of the supply voltage. In order to build a current reference that utilizes this point, a few extra transistors must be employed, as shown in Figure 5.24. First focus on \\(M_3\\) and \\(M_4\\). These transistors form a current mirror that forces \\(I_{OUT} = I_{IN}\\), which is necessary for operation at point P (see Figure 5.23(b)).\n\n\n\n\n\n\nFigure 5.24: Complete self-biased constant-gm current reference circuit.\n\n\n\nUnfortunately, simply forcing \\(I_{OUT} = I_{IN}\\) does not guarantee that the circuit operates at P. There exists another (undesired) point where \\(I_{OUT} = I_{IN} = 0\\), labeled U in Figure 5.23(b). If only \\(M_1 – M_4\\) were present in this circuit, it would not be clear which operating point the circuit will chose when the supply voltage is turned on. The outcome may depend on second-order effects, such as parasitic capacitive coupling, and on how quickly the supply ramps up.\n    In order to guarantee that the circuit will eventually operate at point P, the designer will always include a so-called start-up circuit. This circuit is formed by \\(M_6 – M_8\\) in Figure 5.24.\n    To understand the operation of the start-up circuit, consider first the case where the circuit starts up in point U, i.e., \\(I_{OUT} = I_{IN} = 0\\). This condition necessitates that \\(V_{GS2} &lt; V_{Tn}\\), since no drain current is flowing in \\(M_2\\). With \\(V_{GS2} &lt; V_{Tn}\\), \\(M_7\\) will be off and \\(M_6\\) will be on, pulling the voltage at node \\(V_{START}\\) toward \\(V_{DD}\\). Thus, \\(M_8\\) will turn on and force a drain current into \\(M_3\\), which will subsequently be mirrored into \\(M_4\\) and \\(M_2\\). Therefore, the circuit has no choice but to leave point U and ultimately arrive at P, which is the only other possible DC operating point.\n    Once point P is reached we have \\(V_{GS2} &gt; V_{Tn}\\) by some overdrive voltage, typically a few hundred millivolts. For the given \\(V_{GS2}\\) in this point, \\(M_7\\) must be sized large enough so that \\(V_{START}\\) lies near ground, and no current flows in \\(M_8\\) (\\(I_{START} = 0\\)). In a typical design \\(M_7\\) is much larger than \\(M_6\\), resulting in a so-called low-threshold inverter.\nOur final task is to compute the current \\(I_{REF} = I_{IN} = I_{OUT}\\) in Figure 5.24. We begin by applying KVL around the gate-source voltages of \\(M_1\\) and \\(M_2\\).\n\\[\nI_{REF} R = V_{GS2} - V_{GS1}\n\\tag{5.29}\\]\nNeglecting backgate effect, i.e., assuming equal threshold voltages for \\(M_1\\) and \\(M_2\\) (for simplicity), Equation 5.29 becomes\n\\[\nI_{REF} R = V_{OV2} - V_{OV1}\n\\tag{5.30}\\]\nNow, since for a MOSFET\n\\[\nV_{OV} = \\sqrt{\\frac{2I_D}{\\mu _n C_{ox} \\frac{W}{L}}}\n\\tag{5.31}\\]\nand \\(M_1\\) is \\(m\\) times wider than \\(M_2\\), Equation 5.30 can be rewritten as\n\\[\nI_{REF} = \\dfrac{V_{OV2} \\Bigl(1 - \\dfrac{1}{\\sqrt{m}} \\Bigr)}{R}\n\\tag{5.32}\\]\nFinally, eliminating \\(V_{OV2}\\) using Equation 5.31 and solving for \\(I_{REF}\\) gives\n\\[\nI_{REF} = \\dfrac{2(\\sqrt{m}-1)^2}{m} \\cdot  \\dfrac{1}{\\mu _n C_{ox} \\dfrac{W_n}{L_n} R^2}\n\\tag{5.33}\\]\nThis equation is primarily useful for setting the absolute current level in the circuit, and at first glance does not seem to have any special structure. A much more important result from the above analysis follows from considering the transconductance of \\(M_2\\), given by\n\\[\ng_{m2} = \\dfrac{2I_{D2}}{V_{OV2}} = \\dfrac{2I_{REF}}{V_{OV2}} =  \\dfrac{2 \\Bigl(1 - \\dfrac{1}{\\sqrt{m}} \\Bigr)}{R}\n\\tag{5.34}\\]\nAs we see from this result, \\(g_{m2}\\) depends only on the resistance \\(R\\) and the scaling factor \\(m\\), i.e., the transconductance will not be affected by MOSFET process and temperature variations. In a way, the circuit “recomputes” \\(I_{REF}\\) such that the transconductance is held constant to the value given by Equation 5.34. This is the reason why this circuit is typically called a constant-gm reference generator, as mentioned earlier. It should be noted, of course, that not only the transconductance of \\(M_2\\) is held constant when this circuit is used. Any other MOSFET that utilizes \\(I_{REF}\\) or a copy of this current will behave similarly.\n    In practice, the device type used to implement resistor \\(R\\) should be chosen with care. When implemented on-chip, the designer will often opt for a highly doped polysilicon resistor that has relatively small process variations and a small temperature coefficient (see Table 5.2 and Table 5.3). Alternatively, the resistance is sometimes placed off-chip, where it can be realized, for example, with a 1%-accurate and low temperature coefficient metal film resistor.2\n2 When the resistor is placed off-chip, the designer must take great care to avoid stability issues. Using feedback circuit analysis techniques, it can be shown that even relatively small amounts of parasitic capacitance at the source node of \\(M_1\\) can make the circuit oscillate.As a final note, we should emphasize that the foregoing analysis neglected many second-order effects, such as channel-length modulation and back-gate effect. In practice, these effects can have some bearing on the circuit’s accuracy and therefore leave room for improvements (such as including cascode transistors). The interested reader will find many articles on this topic in analog circuit literature and advanced texts, such as (Gray et al. 2009).",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Biasing Circuits</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.5.html#sec-5-5",
    "href": "contents/partI/partI.5.html#sec-5-5",
    "title": "5  Biasing Circuits",
    "section": "5.5 Voltage Biasing Considerations",
    "text": "5.5 Voltage Biasing Considerations\nIn addition to bias currents, building a complete ana- log circuit will require the generation of various bias voltages needed to operate common-source, common-gate and common-drain stages (see for example \\(V_{B1}\\) and \\(V_{B2}\\) in Figure 5.1). In this section we will discuss an exemplary subset of solutions that have found their use in practice.\nAs we have already seen in Example 5-1, the com- mon-source stage is very sensitive to variations in its input bias voltage. As a result, a majority of practical CS circuits are embedded in feedback networks that regulate the input bias voltage to the proper value, thereby absorbing process variations and mismatch effects. Since feedback is beyond the scope of this module, the input biasing techniques suggested for the common-source stage are meant to be applied only to a subset of applications where the circuit’s voltage gain is low (typically &lt; 10), and the amplifier is utilized “open-loop,” without a feedback network. This complication typically does not exist for CG and and CD stages, and the proposed circuits are therefore more or less universally applicable.\n\n5.5.1 Voltage Biasing for a Common-Source Stage\nDue to the voltage gain of a CS amplifier, its input bias voltage usually cannot be set to a fixed voltage without causing prohibitive sensitivities to component variations and mismatch. Thus, it is important to design the bias circuitry with variability in mind and construct solutions that can track or absorb any significant deviations from nominal parameter conditions. Especially for common-source stages, soltions applied in practice often involve the use of feedback or differential circuit topologies (see Gray et al. 2009). Since these topics are beyond the scope of this module, we will concentrate here only on a few basic ideas that can be understood with the prerequisites established so far.\n\nGray, Paul R, Paul J Hurst, Stephen H Lewis, and Robert G Meyer. 2009. Analysis and Design of Analog Integrated Circuits. John Wiley & Sons.\n    Specifically, we will focus in this subsection on a few possible solutions to the problem encountered in Example 5-1. The main problem in this example was that the input bias voltage was held constant, while the threshold voltage and other parameters in the circuit changed due to process variations. Ideally, we would like to “automatically compute” the input bias voltage of the stage such that it tracks the required value across process corners.\n\n\n\n\n\n\nFigure 5.25: Replica biasing approach for setting up the quiescent point gate-source voltage of a common-source stage.\n\n\n\nA first option that accomplishes this is shown in Figure 5.25. Here, \\(M_1\\) is the MOSFET that implements the common-source amplifier and \\(v_s\\) and \\(R_s\\) model a transducer that generates the voltage we wish to amplify. The transistor \\(M_2\\) is a replica device that computes the proper gate-source voltage required to carry the current \\(I_B\\). Note that this overall arrangement resembles a current mirror, which we have already determined to be insensitive to process variations. If \\(V_{Tn}\\) or \\(μ_n C_{ox}\\) change, the gate-source voltage of \\(M_1\\) \\((V_B)\\) adjusts so that this transistor’s drain current remains equal to \\(I_B\\). This means (to first-order) that no current flows into the resistive divider formed by \\(R_1\\) and \\(R_2\\). These resistors can be sized to establish the desired output quiescent point and voltage gain. For example, for \\(R_1 = R_2\\) and \\(V_{DD} = 5V\\), we have \\(V_{OUT} = 2.5V\\), approximately independent of process and temperature.\n    While the above-discussed circuit will work robustly, it has one big limitation in that both transducer terminals must be accessible and compatible with the bias voltage desired for \\(M_1\\). One possibility for overcoming this constraint is to employ AC coupling (see Figure 5.26). AC coupling means that the transducer signal is coupled into the circuit via a capacitor. In the circuit of Figure 5.26 \\(R_{large}\\) and \\(C_{large}\\) form a first-order high pass filter with corner frequency \\(ω_c = 1/R_{large}C_{large}\\) (neglecting the resistance \\(1/g_{m2}\\), which is in series with \\(R_{large}\\)).\n\n\n\n\n\n\nFigure 5.26: Replica biasing approach using AC coupling.\n\n\n\nTo avoid filtering the signal, \\(ω_c\\) must be chosen smaller than the smallest frequency of interest. For instance, if we are interested in amplifying a 20 Hz signal (the lower end of the audio frequency spectrum), we need \\(R_{large}C_{large} &gt; 1/(2π \\cdot 20 Hz) ≅ 4 ms\\). Assuming we can comfortably integrate resistances up to \\(100 kΩ\\) on our chip, this means that \\(C_{large} &gt; 4 nF\\). Such a large capacitance is typically impractical for integration on chip and would have to be realized as an external component.\nA shortcoming of the circuit in Figure 5.26 is that the resistors \\(R_{large}\\) and \\(R_s\\) form a voltage divider, which can be detrimental when \\(R_s\\) is very large. Figure 5.27 shows an alternate approach in which the transducer can be directly connected to the MOSFET gate. In this circuit, the bias current \\(I_B\\) is injected into the drain of the common-source transistor (\\(M_1\\)) and extracted again using the current mirror formed by \\(M_2\\) and \\(M_3\\). The bias point voltage at node X is given by \\(V_B – V_{GS1}\\), which places constraints on the minimum required value for \\(V_B\\). Note however, that \\(V_B\\) does not have to be accurately set or track process variations; as long as \\(M_1\\) and \\(M_2\\) are in saturation, node X tracks (DC) changes in \\(V_B\\) and the circuit remains properly biased. As far as the signal is concerned, the capacitor \\(C_{large}\\) establishes an AC ground at the source of \\(M_1\\) beyond the high-pass corner frequency of the circuit. Just as in the previous circuit, it can be shown that the AC coupling capacitor must take on large values to enable the passing of low frequencies through the circuit.\n\n\n\n\n\n\nFigure 5.27: Biasing-approach using AC coupling at the source of a common-source stage.\n\n\n\n    As we have seen from the previous examples, achieving proper biasing together with the processing of low-frequency signals in a basic common-source stage comes with some undesired constraints and restrictions. Many of these issues can be mitigated when the signal is present in the form of a current, originating for example from a common-gate stage that is driving the common-source amplifier. We will see an example of such a circuit in Chapter 6.\n\n\n5.5.2 Voltage Biasing for a Common-Gate Stage\nCompared to a common-source stage, setting up the bias voltage for the gate of a common-gate stage is usually less intricate. To see this, we consider two classical usage examples shown in Figure 5.28.     In Figure 5.28(a) the common-gate device \\(M_2\\) is utilized in a cascode stage. Since a cascode stage is often designed for large voltage gain, a typical objective is to maximize the available output voltage swing. Consequently, the gate bias voltage of \\(M_2\\) is set up in the same way as in the high-swing cascode current mirror discussed in Section 5.3.4, which means the drain-source voltage of \\(M_1\\) is set to \\(V_{DSsat1}\\) plus some margin for robustness and tolerance to mismatches. A reasonable margin is achieved by using \\(m = 5\\) (see Table 5.6) in the sizing of \\(M_{3b}\\).\n\n\n\n\n\n\nFigure 5.28: Voltage biasing in two usage cases of a common-gate stage.\n\n\n\nFigure 5.28(b) shows an example where a common-gate stage is used to interface to a photo diode. The signal current generated in the photodiode passes through \\(M_2\\) and causes a proportional voltage swing at the output. In this circuit, the output swing is usually not very large, and thus the gate bias voltage for \\(M_2\\) is not tightly constrained by voltage swing requirements. Typically, the gate voltage is set such that the photo diode is biased at a suitable reverse bias. This is accomplished by sizing \\(R_1\\) and \\(R_2\\) appropriately.\n    In both of the circuits in Figure 5.28, variations in the transistor parameters (such as \\(V_{Tn}\\)) will cause the overall operating point of the circuits to shift. How- ever, unlike the common-source stage of Example 5-1, these circuits are not very sensitive to such shifts. For instance, if the threshold voltage of \\(M_2\\) in Figure 5.28(b) changes by 100 mV, all this means is that the reverse bias voltage of the diode will change by approximately the same amount. If properly designed (with margins), this won’t cause the circuit to fail or behave improperly. This strongly contrasts the situation with the circuit of Example 5-1, where such changes in the threshold voltage can have detrimental effects on the stage’s operation.\n\n\n5.5.3 Voltage Biasing for a Common-Drain Stage\nIn a common-drain stage, the input and output voltages at the quiescent point are directly coupled. As shown in Figure 5.29, \\(V_{OUT} = V_{IN} – (V_{Tn} + V_{OV})\\). Proper voltage biasing in a common-drain stage boils down to making sure that the input and output quiescent point voltages are compatible with the circuits that are connecting to the stage input and output. As in a common-gate stage, variability in transistor parameters often does not have detrimental effects as long as a proper margin is included in the design.\n\n\n\n\n\n\nFigure 5.29: Relationship between the input and output quiescent points in a common-drain stage.\n\n\n\nIn some applications, the shift between the input and output quiescent point is undesired. In this case, a p-channel common-drain stage can be used to provide a shift in the opposite direction (see Figure 5.30). In this circuit, \\(M_1\\) can be sized such that the quiescent points \\(V_{IN}\\) and \\(V_{OUT}\\) are approximately equal.\n    When a common-drain stage is employed primarily to shift quiescent points, the designer calls this circuit a level shifter. Level shifters are generally useful to interface two stages that are otherwise incompatible in terms of their ideal quiescent point out- put/input voltages.\n\n\n\n\n\n\nFigure 5.30: Back-to-back common-drain stages to realize equal input and output quiescent point voltages.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Biasing Circuits</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.5.html#summary",
    "href": "contents/partI/partI.5.html#summary",
    "title": "5  Biasing Circuits",
    "section": "5.6 Summary",
    "text": "5.6 Summary\nIn this chapter, we have surveyed general considerations and basic circuits related to the voltage and current biasing of elementary transistor stages. We have seen that the variability inherent to CMOS process technology influences the design and architecture of these support circuits and ultimately determines whether a certain biasing scheme can be deemed practical. We analyzed the basic current mirror and its cascoded variant with respect to their nonidealities and articulated some of the most important design guidelines. As an example of a reference current generator, we looked at the so-called constant-gm biasing circuit and analyzed its first-order behavior. Finally, this chapter looked into the problem of voltage biasing for the three elementary stage configurations. We determined that in lieu of feedback, biasing a common-source stage properly is most challenging and must be considered with care and knowledge of relevant process variation and mismatch effects. While most of the presented ideas and circuits were presented in the context of simple application examples, they generally also apply to more complex circuit designs studied in advanced literature.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Biasing Circuits</span>"
    ]
  },
  {
    "objectID": "contents/partI/partI.5.html#problems",
    "href": "contents/partI/partI.5.html#problems",
    "title": "5  Biasing Circuits",
    "section": "5.7 Problems",
    "text": "5.7 Problems\nUnless otherwise stated, use the standard model parameters specified in Table 4-1 for the problems given below. Consider only first-order MOSFET behavior and include channel-length modulation (as well as any other second-order effects) only where explicitly stated.\nP5.1 Consider the bias current generator circuit of Figure 5.22. Parameters: \\(R = 4 kΩ, W/L = 20\\)\n\nCompute the current \\(I_{IN}\\) assuming nominal MOSFET parameters and supply voltage (\\(V_{DD} = 5 V\\)).\nRecompute \\(I_{IN}\\) for slow MOSFET parameters (see Table 5.2) and \\(V_{DD} = 4.5 V\\). Repeat for fast parameters and \\(V_{DD} = 5.5 V\\).\nWhat are the percent errors of the currents found in part (b), relative to the nominal current computed in (a)?\n\nP5.2 In Example 5-1, we showed analytically that changing the MOSFET parameters from nominal to fast pushes the transistor into the triode region. Construct a load line plot that shows this graphically. That is, draw the output curves of the MOSFET (\\(I_D\\) versus \\(V_{DS}\\)) for the two corner cases and show how the intersect with the load line shifts when fast parameters are assumed. Be sure to neglect channel length modulation.\nP5.3 Set up a suitable analysis that allows you derive the values given in Table 5.5. Set up an equation that computes \\(V_{DS1}\\) as a function of \\(k\\) and \\(V_{OV}\\).\nP5.4 Set up a suitable analysis that allows you derive the values given in Table 5.6. Set up an equation that computes \\(V_{DS1}\\) as a function of \\(m\\) and \\(V_{OV}\\).\nP5.5 The circuit in Figure 5.31 can be used to achieve high-swing cascode biasing without an extra input current branch. Given the annotated bias point voltages, what is the proper \\(W/L\\) ratio for \\(M_4\\) that achieves the minimum output compliance voltage? Express the desired \\((W/L)_4\\) as a multiple \\(k\\) of \\(W/L\\).\n\n\n\n\n\n\nFigure 5.31: P5-5\n\n\n\nP5.6 The circuit in Figure 5.32 is called a “Sooch” cascode current mirror. It uses one single branch for setting up all bias voltages for a high-swing cascode current mirror. Given the annotated bias point voltages, what is the proper \\(W/L\\) ratio for \\(M_5\\) that achieves the minimum output compliance voltage? What is the minimum required voltage across the input branch (\\(V_{IN}\\))?\n\n\n\n\n\n\nFigure 5.32: P5-6\n\n\n\nP5.7 Derive a closed-form expression for curve (iii) in Figure 5.23(b) Verify graphically that the intersect with line (ii) corresponds to the current level given in Equation 5.33. Assume the following parameters: \\(m=4\\), \\(W/L=25\\), \\(R=2k \\Omega\\). Be sure to neglect channel-length modulation and back-gate effect.\nP5.8 For the circuit of Example 5-1, compute the proper \\(V_{IN}\\) that would need to be applied in the fast parameter case such that the output bias voltage remains the same as in the nominal case. Assume nominal conditions for supply temperature and \\(R_D\\). In this biasing condition, what is the voltage gain, and by which percentage has it changed relative to the nominal case?\nP5.9 Figure 5.33 shows a cascode current source consisting of \\(M_{1A}\\) and \\(M_{1B}\\), and a single transistor current source consisting of \\(M_2\\). Assume that the cascode current source is optimally biased, i.e., \\(V_{B1B}\\) is chosen such that \\(V_{DS1a} = V_{DS1a,sat} = V_{OV1a}\\). /backAssume also that both current sources supply the same current \\(I_O\\). Neglect backgate effect.\n\nFind relationships between \\(W_1, L_1\\) and \\(W_2, L_2\\) such that both current sources have the same parasitic output capacitance, and the same output compliance voltage \\(V_{Omin}\\) that keeps all the devices saturated. For simplicity, assume \\(λ = 0\\) in this part of the analysis. Note: The parasitic capacitance at the drain of \\(M_2\\) is given by \\(C_{db} + C_{gd}\\). Similarly, assume that the output capacitance of the cascode current source is approximately equal to \\(C_{db} + C_{gd}\\) of \\(M_{1b}\\). (In the cascode current source, the effect of other capacitances referred to the output node is negligible.)\nUsing the result from part (a), show that the expression given below must hold. \\(R_{O1}\\) and \\(R_{O2}\\) are the output resistances of each current source, as indicated in Figure 5.33.\n\n\\[\n\\frac{R_{O1}}{R_{O2}} = \\frac{g_{m1} r_{o1}}{4}\n\\]\n\nCalculate \\(V_{Omin}, R_{O1}\\) and \\(R_{O2}\\) for \\(I_O = 100 μA\\) and \\((W/L)_1 = 10 μm/2 μm\\). [Use the relationships between device sizes from part (a).]\n\n\n\n\n\n\n\nFigure 5.33: P5-9\n\n\n\n5.10 The circuit shown in Figure 5.34 is a so-called self-biased, \\(V_{Tn}\\)-referenced current generator. Assuming \\((W/L)_1 = 50\\) and \\((W/L)_3 = (W/L)_4 = (W/L)_5\\), find the value for \\(R\\) so that \\(I_{OUT} = 100 μA\\). Assume \\(λ = 0\\) and neglect backgate effect.\n\n\n\n\n\n\nFigure 5.34: P5-10\n\n\n\nP5.11 For the circuit shown in Figure 5.35, ignore the backgate effect and finite output resistance unless otherwise stated. All devices have identical widths and lengths and operate in saturation (W/L = 50) and \\(I_{ref} = 200 \\mu A\\).\n\nCalculate \\(R\\) such that the drain-source voltage of \\(M_1\\) is 1.5 times its gate overdrive, i.e., \\(V_{DS1} = 1.5 V_{OV1}\\).\nSuppose that due to random mismatch, the threshold voltage of \\(M_1\\) is 10 mV larger than that of all the other transistors. What is the percent error in \\(I_{OUT}\\) caused by this mismatch? Use appropriate small-signal approximations in your calculation.\nSuppose now that the threshold voltage of \\(M_2\\) is increased by 10 mV while all other thresholds are at their nominal value. What is the percent error in \\(I_{OUT}\\) caused by this mismatch? In this calculation, include the effect of the finite output resistance for \\(M_1\\), assuming \\(g_m r_o = 50\\).\n\n\n\n\n\n\n\nFigure 5.35: P5-11\n\n\n\nP5.12 In the circuit of Figure 5.36, \\(V_{G1}\\) is adjusted such that \\(I_{D1} = 50 μA\\). The \\(W/L\\) ratio of \\(M_1\\) and \\(M_2\\) is equal to 4, while \\(M_3\\) is sized such that \\(W/L = 1/2\\), and \\(V_{DD}=5V\\).\n\nIgnoring backgate effect, compute the minimum and maximum values of \\(V_{G2}\\) for which all transistors remain in saturation.\nRepeat part (a) with backgate effect included.\n\n\n\n\n\n\n\nFigure 5.36: P5-12\n\n\n\nP5.13 For the circuit of Figure 5.37, compute the width ratios \\(W_8/W_6\\) and \\(W_7/W_6\\) such that \\(V_{DS8} = V_{DS7} = V_{OV6}\\). Assume that all channel lengths are identical. Ignore the backgate effect and channel-length modulation.\n\n\n\n\n\n\nFigure 5.37: P5-13\n\n\n\nP5.14 For the circuit of Figure 5.24, size the transistors \\(M_1 - M_4\\) and \\(R\\) such that \\(I_{OUT} = 100μA\\), \\(V_{OV} = 300 mV\\). Assume that all channel lengths are equal to 3 μm. Neglect backgate effect and channel length modulation.\nP5.15 Design a cascode current mirror circuit using n-channel devices assuming the following specifications. The circuit should take an input current of 10 μA and generate three outputs at 20 μA, 50 μA, and 100 μA, respectively. The output compliance voltage should be no larger than 800 mV and the gate overdrive of the transistors should be designed as large as possible (for immunity to mismatch), while maintaining a reasonable saturation margin. Draw the complete circuit diagram, including all device sizes. This problem does not have a unique solution.\nP5.16 Draw a layout (using any tool you prefer) for the circuit designed in Example 5-3.",
    "crumbs": [
      "Learn to Crawl — Square-Law Transistors, Biasing and Small-Signal Analysis",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Biasing Circuits</span>"
    ]
  },
  {
    "objectID": "contents/partII/partII.1.html",
    "href": "contents/partII/partII.1.html",
    "title": "6  Introduction",
    "section": "",
    "text": "TBD.",
    "crumbs": [
      "Learn to Walk — Real Transistors, Noise, Mismatch, and Distortion",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "contents/partIII/partIII.1.html",
    "href": "contents/partIII/partIII.1.html",
    "title": "7  Introduction",
    "section": "",
    "text": "TBD.",
    "crumbs": [
      "Dare to Run — Knowledge Base for State-of-the-Art Circuits",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Gray, Paul R, Paul J Hurst, Stephen H Lewis, and Robert G Meyer. 2009.\nAnalysis and Design of Analog Integrated Circuits. John Wiley\n& Sons.\n\n\nPelgrom, M. J. M., A. C. J. Duinmaijer, and A. P. G. Welbers. 1989.\n“Matching Properties of MOS Transistors.” IEEE Journal\nof Solid-State Circuits 24 (5): 1433–39.\n\n\nPierret, R. F. 1996. Semiconductor Device Fundamentals. Pearson\nEducation.\n\n\nStaszewski, Robert Bogdan, Dirk Leipold, O Eliezer, Mitch Entezari,\nKhurram Muhammad, Imran Bashir, C-M Hung, et al. 2008. “A 24mm 2\nQuad-Band Single-Chip GSM Radio with Transmitter Calibration in 90nm\nDigital CMOS.” In 2008 IEEE International Solid-State\nCircuits Conference-Digest of Technical Papers, 208–607. IEEE.\n\n\nUlaby, Fawwaz Tayssir, and Michel M Maharbiz. 2013. Circuit Analysis\nand Design. 2nd Edition. NTS Press.",
    "crumbs": [
      "References",
      "References"
    ]
  }
]